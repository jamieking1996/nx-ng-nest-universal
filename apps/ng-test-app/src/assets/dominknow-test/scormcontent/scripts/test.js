/*! -- File: test.js ( Input 0 ) -- */
var DKI;DKI||(DKI={});
DKI.TestQuestion=function(){var e=$(document.body).data("singlepage")?!0:!1;480>=screen.availWidth||$(document.body).width();var c={submit:function(a,d){var b=!1;"undefined"!=typeof dataStorage&&dataStorage.currentModule.forceTestEnd&&(b=dataStorage.currentModule.forceTestEnd);if(this.submitted){if(!e&&!this.isPracticeQuestion&&settings.enableTimerQuestions&&b)return $(document).trigger(DKI.Events.TestQuestion.forceEnd),!1;$(document).trigger(DKI.Events.TestQuestion.nextClicked);return null}this.submitted=
!0;this.getOptions();a&&(a.preventDefault(),a.stopPropagation());if(c.overMaxOptions.call(this))return alert(this.strings.tstchoicesLabel1+" "+this.maxSelections+" "+this.strings.tstchoicesLabel2),this.submitted=!1;if(!this.hasSelection.call(this)&&(!settings.enableTimerQuestions||settings.enableTimerQuestions&&!b)&&!confirm(this.strings.confirmQuestionNoSelection))return this.submitted=!1;this.submitButton.unbind();d=d?d:0;this.numAttempts++;if(e||this.isPracticeQuestion)d=c.scorePreview.call(this,
d),this.setScore(d);else{d=c.scoreExport.call(this,d,b);if(settings.enableTimerQuestions&&b)return $(document).trigger(DKI.Events.TestQuestion.forceEnd),!1;$(document).trigger(DKI.Events.TestQuestion.exportSubmitted)}100==d&&($(this.pageContainer).trigger(DKI.Events.TestQuestion.correct),this.numAttempts<this.question.attempts&&$(this.pageContainer).trigger(DKI.Events.TestQuestion.attemptSubmitted),this.numAttempts=this.question.attempts);this.numAttempts==this.question.attempts?($(this.pageContainer).trigger(DKI.Events.TestQuestion.submitted),
0>=d?$(this.pageContainer).trigger(DKI.Events.TestQuestion.incorrect):100>d&&$(this.pageContainer).trigger(DKI.Events.TestQuestion.partiallyCorrect)):($(this.pageContainer).trigger(DKI.Events.TestQuestion.attemptSubmitted),0>=d?$(this.pageContainer).trigger(DKI.Events.TestQuestion.attemptIncorrect):100>d&&$(this.pageContainer).trigger(DKI.Events.TestQuestion.attemptPartiallyCorrect));return!1},overMaxOptions:function(){var a=!1,d=0;if(2==this.questionType||3==this.questionType){for(var c=this.getOptions(),
f=0;f<c.length;f++)1==c[f].value().checked&&d++;d>this.maxSelections&&(a=!0)}return a},atMaxOptions:function(){var a=!1,d=0;if(2==this.questionType||3==this.questionType){for(var c=this.getOptions(),f=0;f<c.length;f++){var b=$("input",c[f].wrapper);b.attr("attr-checked")&&"true"==b.attr("attr-checked").toString()&&d++}d==this.maxSelections&&(a=!0)}return a},showDefaultSubmit:function(){var a=this;contentApi.showPopup({html:'\x3cbutton role\x3d"button" tabindex\x3d"1" class\x3d"btn btn-primary btn-block dki-submit-button"\x3e'+
DKI.strings.runtime.buttonLabelSubmit+"\x3c/button\x3e",effect:"fade",style:"default",autoFocus:!1,popupType:{mod:"botRight dki-submit-button",modal:!1,type:"notification"},id:"dki-submit-"+this.question.id,tabContent:!1,role:"application",afterShow:function(){a.settings.responsive&&$(a.pageContainer).css("padding-bottom",$("#action_popup_dki-submit-"+a.question.id).height());a.submitButton=$("#action_popup_dki-submit-"+a.question.id+" .dki-submit-button");a.submitButton.on(settings.clickEvent,function(){contentApi.submitQuestion()});
a.positionSubmitButton()}})},scorePreview:function(a){var d=this.getOptions(),b=this.getCorrectCount(),f=0,m=0,g;a="undefined"===typeof a?0:a;var l=!1;if("pre"==this.prePost&&this.behaviour.reviewPreAnswers||"post"==this.prePost&&this.behaviour.reviewPostAnswers)l=!0;for(var k=0;k<d.length;k++)g=d[k].score(),1===g?f++:-1===g&&m++,d[k].value(),c.showCorrectAnswers.call(this)&&d[k].showCorrect(l);a=this.calculate(b,f,m,a);!this.isPracticeQuestion&&e&&$(this.pageContainer).trigger(DKI.Events.TestQuestion.questionInReview);
k=$(".questionBody",this.pageContainer);b={type:this.questionType,body:k.text(),latency:(new Date).getTime()-this.startTime,options:[]};for(k=0;k<d.length;k++)b.options[k]=d[k].value();"undefined"==typeof dataStorage||this.inReview||$(this.player.dataStorage).trigger(DKI.DataStorage.events.questionScored,{question:dataStorage.currentPage.question,questionObject:b,score:a});$(".dki-authoring-element",this.pageContainer).has(".correct, .incorrect, .multiChoiceCorrect").css("zIndex",1E5);return a},scoreExport:function(a,
d){for(var c=this.getOptions(),b=$(".questionBody",this.pageContainer),b={type:this.questionType,body:b.text(),latency:(new Date).getTime()-this.startTime,options:[]},e=0;e<c.length;e++)b.options[e]=c[e].value();return a=this.player.dataStorage.submitCurrentQuestion(b,a,d)},showCorrectFeedback:function(){return c.doShowFeedback.call(this,"correct")},showIncorrectFeedback:function(){return c.doShowFeedback.call(this,"incorrect")},showIncorrectAttemptFeedback:function(){return c.doShowFeedback.call(this,
"incorrectAttempt")},showPartialFeedback:function(){return c.doShowFeedback.call(this,"partial")},showPartialAttemptFeedback:function(){return c.doShowFeedback.call(this,"partialAttempt")},doShowFeedback:function(a){var d=this.question.parameters.feedback[3==this.question.type?"incorrect":a],b=this.question.parameters.feedback.popup;"true"==b.use_course_default.toString()&&(b=contentApi.getDefaultFeedbackPopup());var f=this,e="",e=d.useDefault?e+contentApi.getDefaultFeedbackText(a):e+d.text,d=this.getOptionFeedback();
""!=d&&(""!=e&&(e+="\x3chr/\x3e"),e+=d);var g=function(){contentApi.showPopup({ariaLabel:DKI.strings.doc["Question feedback header"],html:e,title:"",effect:"fade",style:function(){var d="success";if("incorrect"==a||"incorrectAttempt"==a)d="danger";else if("partial"==a||"partialAttempt"==a)d="warning";return d}(),autoFocus:!0,popupType:{mod:b.mod,modal:b.modal,type:b.type},id:"question_"+f.question.id+"_feedback",addClass:"DKI-questionFeedback",returnFocus:$("button.dki-try-again")[0]?$("button.dki-try-again")[0]:
document.activeElement})},d=function(){for(var d=this.page.actions,b=0;b<d.length;b++){if(d[b].trigger==DKI.Events.TestQuestion.submitted)return!0;if(d[b].trigger==DKI.Events.TestQuestion.correct){if("correct"==a)return!0}else if(d[b].trigger==DKI.Events.TestQuestion.incorrect){if("incorrect"==a)return!0}else if(d[b].trigger==DKI.Events.TestQuestion.partiallyCorrect){if("partial"==a)return!0}else{if(d[b].trigger==DKI.Events.TestQuestion.attemptSubmitted)return!0;if(d[b].trigger==DKI.Events.TestQuestion.attemptIncorrect){if("incorrectAttempt"==
a)return!0}else if(d[b].trigger==DKI.Events.TestQuestion.attemptPartiallyCorrect&&"partialAttempt"==a)return!0}}return!1},l=function(){!f.inReview&&f.isPracticeQuestion&&f.question.show_try_again&&f.numAttempts<f.question.attempts&&("incorrectAttempt"==a||"partialAttempt"==a)?contentApi.showPopup({html:'\x3cspan class\x3d"remainingAttempts" tabindex\x3d"1"\x3e'+DKI.strings.runtime.txtRemainingAttempts+" "+(f.question.attempts-f.numAttempts)+'\x3c/span\x3e\x3cbutton class\x3d"btn btn-primary dki-try-again" tabindex\x3d"1" style\x3d"float: right;" onclick\x3d"contentApi.tryAgain();" data-dismiss\x3d"alert"\x3e'+
DKI.strings.runtime.testTryAgain+"\x3c/button\x3e",effect:"fade",style:"default",autoFocus:!0,popupType:{mod:"botRight fill dki-try-again",modal:!1,type:"notification"},id:"dki-try-again-"+f.question.id,returnFocus:document.activeElement,tabContent:!1,role:"application",afterShow:function(){f.tryAgainButton=$("#content_dki-try-again-"+f.question.id+" .dki-try-again");f.positionSubmitButton();$("#content_dki-try-again-"+f.question.id+" .remainingAttempts").focus()}}):(f.submitButton.text(f.strings.buttonLabelNext),
f.submitButton.off(),f.submitButton.on(f.player.settings.clickEvent,$.proxy(function(a){f.submitButton.unbind(a);f.submitButton.hide();a.preventDefault();a.stopPropagation();$(document).trigger(DKI.Events.TestQuestion.nextClicked)},f)),7==f.questionType&&f.submitButton.trigger(f.player.settings.clickEvent))};if(c.showFeedback.call(this)){if(""!=e)setTimeout(l,100),this.inReview?setTimeout(function(){g()},500):g();else if(f.inReview||f.isPracticeQuestion||dataStorage.currentModule.forceTestEnd||d.call(this))setTimeout(l,
100);else return $(document).trigger(DKI.Events.TestQuestion.nextClicked),!1;return!0}f.inReview||f.isPracticeQuestion||dataStorage.currentModule.forceTestEnd||d.call(this)?setTimeout(l,100):$(document).trigger(DKI.Events.TestQuestion.nextClicked);return!1},showFeedback:function(){return!this.behaviour||this.preview?!0:this.inReview||!this.behaviour.displayQuestionFeedback&&!this.isPracticeQuestion?this.inReview?"pre"==this.prePost&&this.behaviour.reviewPreFeedback?!0:"post"==this.prePost&&this.behaviour.reviewPostFeedback?
!0:!1:!1:!0},showCorrectAnswers:function(){return this.isPracticeQuestion||this.behaviour&&!this.preview?this.inReview?!0:!1:!0}},b=function(a,d,b,f){var e=function(a){var b=$("label[for\x3d'"+a.attr("id")+"']",d.pageContainer);$(".content input[type\x3d'radio']",d.pageContainer).each(function(d,b){$("label[for\x3d'"+b.id+"']").removeClass("checked");b.id!=a.attr("id")&&$(b).prop("checked",!1)});$(".input-group",d.pageContainer).removeClass("checked");a.prop("checked")?(b.addClass("checked"),b.closest(".input-group").addClass("checked")):
b.removeClass("checked");$(".input-group input:checked",d.pageContainer).each(function(){$(this).closest(".input-group").addClass("checked")})};this.question=b;this.player=a;this.strings=a.strings;this.page=d;this.behaviour=this.player.behaviour;this.inReview=this.player.inReview;this.settings=this.player.settings;this.submitted=!1;this.prePost="";this.pageContainer=this.page.pageContainer;this.questionElement=$("div[data-pagetype\x3d'question']",this.pageContainer);this.questionType=parseInt(this.questionElement.attr("data-questiontype"),
10);this.startTime=null;this.submitButton=$(".dki-submit-button");this.scoreDisplay=$(".questionScoreDisplay");this.maxSelections=parseInt(this.questionElement.attr("data-max-selections"),10);this.freeFormMaxLength=4E3;this.numAttempts=0;this.isPracticeQuestion=f;"undefined"!==typeof scormAPI&&"SCORM"==scormAPI.strLMSStandard&&(this.freeFormMaxLength=255);switch(this.questionType){case 1:this.getCorrectCount=$.proxy(DKI.TestQuestion.TrueFalseQuestion.getCorrectCount,this);this.getOptions=$.proxy(DKI.TestQuestion.TrueFalseQuestion.getOptions,
this);this.hasSelection=$.proxy(DKI.TestQuestion.TrueFalseQuestion.hasSelection,this);this.scoreOption=$.proxy(DKI.TestQuestion.TrueFalseQuestion.scoreOption,this);this.calculate=$.proxy(DKI.TestQuestion.TrueFalseQuestion.calculate,this);this.getOptionFeedback=$.proxy(DKI.TestQuestion.TrueFalseQuestion.getOptionFeedback,this);$(".trueOption_label",this.pageContainer).text(this.strings.trueOptionLabel);$(".falseOption_label",this.pageContainer).text(this.strings.falseOptionLabel);break;case 2:this.getCorrectCount=
$.proxy(DKI.TestQuestion.MultipleChoiceQuestion.getCorrectCount,this);this.getOptions=$.proxy(DKI.TestQuestion.MultipleChoiceQuestion.getOptions,this);this.hasSelection=$.proxy(DKI.TestQuestion.MultipleChoiceQuestion.hasSelection,this);this.scoreOption=$.proxy(DKI.TestQuestion.MultipleChoiceQuestion.scoreOption,this);this.calculate=$.proxy(DKI.TestQuestion.MultipleChoiceQuestion.calculate,this);this.getOptionFeedback=$.proxy(DKI.TestQuestion.MultipleChoiceQuestion.getOptionFeedback,this);this.randomizeOptions=
$.proxy(DKI.TestQuestion.MultipleChoiceQuestion.randomizeOptions,this);this.inReview||this.randomizeOptions();break;case 3:this.getCorrectCount=$.proxy(DKI.TestQuestion.FreeFormQuestion.getCorrectCount,this);this.getOptions=$.proxy(DKI.TestQuestion.FreeFormQuestion.getOptions,this);this.hasSelection=$.proxy(DKI.TestQuestion.FreeFormQuestion.hasSelection,this);this.scoreOption=$.proxy(DKI.TestQuestion.FreeFormQuestion.scoreOption,this);this.calculate=$.proxy(DKI.TestQuestion.FreeFormQuestion.calculate,
this);this.getOptionFeedback=$.proxy(DKI.TestQuestion.FreeFormQuestion.getOptionFeedback,this);break;case 4:this.getCorrectCount=$.proxy(DKI.TestQuestion.FillBlanksQuestion.getCorrectCount,this);this.getOptions=$.proxy(DKI.TestQuestion.FillBlanksQuestion.getOptions,this);this.hasSelection=$.proxy(DKI.TestQuestion.FillBlanksQuestion.hasSelection,this);this.scoreOption=$.proxy(DKI.TestQuestion.FillBlanksQuestion.scoreOption,this);this.calculate=$.proxy(DKI.TestQuestion.FillBlanksQuestion.calculate,
this);this.getOptionFeedback=$.proxy(DKI.TestQuestion.FillBlanksQuestion.getOptionFeedback,this);break;case 5:this.getCorrectCount=$.proxy(DKI.TestQuestion.MultiplePulldownQuestion.getCorrectCount,this);this.getOptions=$.proxy(DKI.TestQuestion.MultiplePulldownQuestion.getOptions,this);this.hasSelection=$.proxy(DKI.TestQuestion.MultiplePulldownQuestion.hasSelection,this);this.scoreOption=$.proxy(DKI.TestQuestion.MultiplePulldownQuestion.scoreOption,this);this.calculate=$.proxy(DKI.TestQuestion.MultiplePulldownQuestion.calculate,
this);this.getOptionFeedback=$.proxy(DKI.TestQuestion.MultiplePulldownQuestion.getOptionFeedback,this);this.randomizeOptions=function(){$(".dki-multiPulldownOption-element select",this.pageContainer).each(function(){for(var a=[],d=this.options.length-1;0<=d;d--)""!=$(this.options[d]).html()&&a.push(this.options[d]),this.remove(d);for(d=a.length;d--;){var b=Math.floor(Math.random()*(d+1)),c=a[d];a[d]=a[b];a[b]=c}this.innerHTML="";if(dkiUA.ie&&8>=dkiUA.ieVersion)for(this.add(new Option("","")),d=0;d<
a.length;d++)this.add(a[d],d+1);else for(this.add(new Option("",""),null),d=0;d<a.length;d++)this.add(a[d],null);this.selectedIndex=0})};this.randomizeOptions();break;case 6:this.getCorrectCount=$.proxy(DKI.TestQuestion.DragDropQuestion.getCorrectCount,this);this.getOptions=$.proxy(DKI.TestQuestion.DragDropQuestion.getOptions,this);this.hasSelection=$.proxy(DKI.TestQuestion.DragDropQuestion.hasSelection,this);this.scoreOption=$.proxy(DKI.TestQuestion.DragDropQuestion.scoreOption,this);this.calculate=
$.proxy(DKI.TestQuestion.DragDropQuestion.calculate,this);this.getOptionFeedback=$.proxy(DKI.TestQuestion.DragDropQuestion.getOptionFeedback,this);break;case 7:this.getCorrectCount=$.proxy(DKI.TestQuestion.customQuestion.getCorrectCount,this),this.getOptions=$.proxy(DKI.TestQuestion.customQuestion.getOptions,this),this.hasSelection=$.proxy(DKI.TestQuestion.customQuestion.hasSelection,this),this.scoreOption=$.proxy(DKI.TestQuestion.customQuestion.scoreOption,this),this.calculate=$.proxy(DKI.TestQuestion.customQuestion.calculate,
this),this.getOptionFeedback=$.proxy(DKI.TestQuestion.customQuestion.getOptionFeedback,this)}this.player.questionPage=this;var g=this;$(this.pageContainer).on(this.settings.clickEvent,".dki-trueFalse-selector, .dki-multiChoice-selector, .dki-multiChoiceOption-element .dki-element-anchor, .dki-trueFalseOption-element .dki-element-anchor, .dki-multiChoiceOption-element input, .dki-multiChoiceOption-element label, .dki-trueFalseOption-element input",function(a){var d=$(this).parent().find("input");if(d.prop("disabled"))return a.stopPropagation(),
a.preventDefault(),!1;var b=$("label[for\x3d'"+d.attr("id")+"']",g.pageContainer);if(!b.hasClass("checked")&&c.atMaxOptions.call(g)&&"radio"!=d.attr("type"))return alert(g.strings.tstchoicesLabel1+" "+g.maxSelections+" "+g.strings.tstchoicesLabel2),a.stopPropagation(),a.preventDefault(),d.prop("checked",d.attr("attr-checked")&&"true"==d.attr("attr-checked").toString()),!1;d.attr("attr-checked")&&"true"==d.attr("attr-checked").toString()?"checkbox"==d.attr("type")&&d.attr("attr-checked",!1):d.attr("attr-checked",
!0);d.prop("checked",d.attr("attr-checked")&&"true"==d.attr("attr-checked").toString());e(d);var f=$(this).closest(".dki-authoring-element");$("*[tabindex]:not([tabindex\x3d'-1'])",f).focus();"checkbox"!=d.attr("type")||d[0]!=a.target&&b[0]!=a.target||a.stopPropagation()});$(".dki-freeFormOption-element textarea").attr("maxlength",this.freeFormMaxLength);$(this.pageContainer).on("keyup",".dki-freeFormOption-element textarea",function(a){a=$(this).val();a.length>g.freeFormMaxLength&&(a=a.substr(0,
g.freeFormMaxLength),$(this).val(a))});$("input",this.pageContainer).on("focus",function(a){$(this).closest(".input-group-addon").addClass("focus-within")});$("input",this.pageContainer).on("blur",function(a){$(".input-group-addon.focus-within").removeClass("focus-within")});for(var l in DKI.Events.TestQuestion)$(this.pageContainer).off(DKI.Events.TestQuestion[l]);$(this.pageContainer).on(DKI.Events.TestQuestion.submitted,function(){g.page.actionAPI.onPageEvent(DKI.Events.TestQuestion.submitted,g.page)});
$(this.pageContainer).on(DKI.Events.TestQuestion.correct,function(){g.page.actionAPI.onPageEvent(DKI.Events.TestQuestion.correct,g.page)});$(this.pageContainer).on(DKI.Events.TestQuestion.incorrect,function(){g.page.actionAPI.onPageEvent(DKI.Events.TestQuestion.incorrect,g.page)});$(this.pageContainer).on(DKI.Events.TestQuestion.partiallyCorrect,function(){g.page.actionAPI.onPageEvent(DKI.Events.TestQuestion.partiallyCorrect,g.page)});$(this.pageContainer).on(DKI.Events.TestQuestion.attemptSubmitted,
function(){g.page.actionAPI.onPageEvent(DKI.Events.TestQuestion.attemptSubmitted,g.page)});$(this.pageContainer).on(DKI.Events.TestQuestion.attemptIncorrect,function(){g.page.actionAPI.onPageEvent(DKI.Events.TestQuestion.attemptIncorrect,g.page)});$(this.pageContainer).on(DKI.Events.TestQuestion.attemptPartiallyCorrect,function(){g.page.actionAPI.onPageEvent(DKI.Events.TestQuestion.attemptPartiallyCorrect,g.page)});$(this.pageContainer).on(DKI.Events.TestQuestion.questionInReview,function(){g.page.actionAPI.onPageEvent(DKI.Events.TestQuestion.questionInReview,
g.page)});$.each(this.page,function(a){"undefined"==typeof g[a]&&DKI.isFunction(this)&&(g[a]=$.proxy(g.page[a],g.page))})};DKI.applyIf(b.prototype,{setPrePost:function(a){this.prePost=a?a:"post"},setScore:function(a,d,b){a=void 0!==a&&null!==a?parseFloat(a,10):0;var f=this.numAttempts==this.question.attempts;7!==this.questionType&&(a=0>=a?f?c.showIncorrectFeedback.call(this):c.showIncorrectAttemptFeedback.call(this):100===a?c.showCorrectFeedback.call(this):f?c.showPartialFeedback.call(this):c.showPartialAttemptFeedback.call(this))&&
$(document).trigger(DKI.Events.TestQuestion.feedbackShown);a=this.getOptions();for(f=0;f<a.length;f++)a[f].enabled(!1);this.inReview&&($(".questionScoreLabel").text(player.strings.txtScore+(" "!=player.strings.txtScore.slice(-1)?" ":"")),$(".questionScore").text(d+" / "+b+" "+this.strings.txtPoints),$(document.body).hasClass("phone")?this.scoreDisplay.show():this.scoreDisplay.fadeIn(200))},setOptions:function(a,d){for(var b=this.getOptions(),c=0;c<b.length;c++)b[c].value(a[c]),b[c].enabled(!1),b[c].correctResponse(d[c]);
2==this.questionType&&$(".dki-multiChoiceOption-element .multiChoiceContentWrapper").css("visibility","")},showReview:function(a,d,b,e){this.inReview=!0;this.numAttempts=this.question.attempts;this.setPrePost(a);this.setOptions(d,b);c.scorePreview.apply(this,7==this.questionType?[e.score]:[]);this.setScore(e.score,e.points,e.weight);$(this.pageContainer).trigger(DKI.Events.TestQuestion.questionInReview);this.question.disable_submit||this.settings.responsive||7!=this.questionType&&($(document.body).hasClass("phone")?
this.submitButton.show():this.submitButton.fadeIn(500))},showCorrectAnswers:function(){for(var a=this.getOptions(),d=0;d<a.length;d++)a[d].showCorrect(!0)},tryAgain:function(){this.reset({doNotResetAttempts:!0});this.tryAgainButton=null;this.start()},submitQuestion:function(a){c.submit.call(this,null,a)},start:function(){this.startTime=(new Date).getTime();var a=this;this.page.resize();this.page.start();this.startOptions();this.question.disable_submit||7==this.question.type||c.showDefaultSubmit.call(this);
6==this.questionType&&($(".dki-authoring-element[data-is-draggable\x3dtrue][data-isquestionelement\x3dtrue]",this.pageContainer).draggable({revert:function(a){$(this).data("draggable").originalPosition={top:settings.responsive?0:$(this).data("y"),left:settings.responsive?0:$(this).data("x")};if(a)$(this).trigger(DKI.ContentPage.events.elementDragDropped);else return $(this).css("z-index",$(this).data("elementno")),$(this).data("reverted",!0),$(this).trigger(DKI.ContentPage.events.elementDragReverted),
!0},drag:function(a,b){a=$(this).data("initialPageYOffset");b.position.top+=a;a=(b.originalPosition.top+(b.position.top-b.originalPosition.top))/settings.scale;b.position.left=(b.originalPosition.left+(b.position.left-b.originalPosition.left))/settings.scale;b.position.top=a},start:function(a,b){1!=$(this).data("reverted")&&"undefined"!=typeof $(this).data("reverted")||$(this).data("origPosition",$(this).position());$(this).parent().css("position","static");$(this).data("reverted",!1);a=$(this).data("title");
""==a&&(a=$(this).text());$(this).data("dropData",{id:$(this).data("dragdropid"),elementId:$(this).data("id"),title:a,target:{id:null,title:"No Target"},x:$(this).data("x"),y:$(this).data("y")});$(this).data("initialPageYOffset",document.documentElement.scrollTop);$(this).trigger(DKI.ContentPage.events.elementDragStarted);$(document).trigger(DKI.Events.TestQuestion.dragStarted)},stop:function(a,b){$(this).data("reverted")?($(this).css("z-index",$(this).data("elementno")),settings.responsive&&$(this).css({top:"",
left:""}),$(this).data("draggable").originalPosition={top:$(this).data("y"),left:$(this).data("x")}):$(this).css("z-index",1E5);$(this).trigger(DKI.ContentPage.events.elementDragStopped);$(document).trigger(DKI.Events.TestQuestion.dragStopped)},stack:".dkiContentFrame.current .dki-authoring-element[data-is-droppable\x3dtrue][data-isquestionelement\x3dtrue]",zIndex:1E5,disabled:!1}),$(".dki-authoring-element[data-is-droppable\x3dtrue][data-isquestionelement\x3dtrue]",this.pageContainer).droppable({accept:".dkiContentFrame.current .dki-authoring-element[data-is-draggable\x3dtrue][data-isquestionelement\x3dtrue]",
tolerance:"pointer",out:function(a,b){$(this).trigger(DKI.ContentPage.events.elementDropOut)},over:function(a,b){$(this).trigger(DKI.ContentPage.events.elementDropOver)},drop:function(d,b){d=b.draggable.data("title");""==d&&(d=b.draggable.text());var c=$(this).data("title");""==c&&(c=$(this).text());var e;if(a.question.parameters.snapToCenter&&"true"==a.question.parameters.snapToCenter.toString()){if(settings.responsive){var g=$(this).offset(),l=b.draggable.find("\x3e.dki-authoring-content-wrapper").first(),
k=$(this).find("\x3e.dki-authoring-content-wrapper").first();e=g.top+parseInt(k.css("padding-top"))+(k.height()-parseInt(k.css("padding-bottom")))/2-l.outerHeight()/2-(b.draggable.data("origPosition").top+b.draggable.parent().offset().top+parseInt(b.draggable.css("margin-top")));g=g.left+parseInt(k.css("padding-left"))+(k.width()-parseInt(k.css("padding-left")))/2-l.outerWidth()/2-(b.draggable.parent().offset().left+parseInt(b.draggable.css("margin-left")))}else g=$(this).position(),e=g.top+$(this).height()/
2-b.draggable.height()/2,g=g.left+$(this).width()/2-b.draggable.width()/2;b.draggable.animate({top:e+"px",left:g+"px"},125);e={top:e,left:g}}else e=b.draggable.position();b.draggable.data("dropData",{id:b.draggable.data("dragdropid"),elementId:b.draggable.data("id"),title:d,target:{id:$(this).data("dragdropid"),title:c},x:e.left,y:e.top});$(this).trigger(DKI.ContentPage.events.elementDropDropped)},disabled:!1}))},reset:function(a){a=DKI.applyIf(a,{doNotResetAttempts:!1,timeout:0});var d=this;contentApi.destroyPopup("question_"+
this.question.id+"_feedback");contentApi.destroyPopup("dki-submit-"+this.question.id);contentApi.destroyPopup("dki-try-again-"+this.question.id);d.submitButton.hide();d.submitButton.unbind();var b=function(){d.submitted=!1;a.doNotResetAttempts||(d.numAttempts=0);a.timeout=0;d.page.reset(a);d.resetOptions();6==d.questionType&&($(".dki-authoring-element[data-is-draggable\x3dtrue][data-isquestionelement\x3dtrue]",d.pageContainer).draggable("option","disabled",!0),$(".dki-authoring-element[data-is-droppable\x3dtrue][data-isquestionelement\x3dtrue]",
d.pageContainer).droppable("option","disabled",!0))};0<a.timeout?setTimeout(b,a.timeout):b()},startOptions:function(){for(var a=this.getOptions(),b=0;b<a.length;b++)a[b].start()},resetOptions:function(){for(var a=this.getOptions(),b=0;b<a.length;b++)a[b].reset();2==this.question.type&&this.randomizeOptions()},onWindowResize:function(){this.page.onWindowResize();this.positionSubmitButton()},positionSubmitButton:function(){if(settings.responsive){var a=this.submitButton.closest(".notification"),b=$("#contentFrame").offset(),
c=$(".bgRepeater").css("padding-bottom");0;a.css({bottom:c,right:"auto"});b.left+=$("#contentFrame").width()-a.outerWidth();a.css({left:b.left});$("#skipToNavigation").length&&$("#skipToNavigation").before(a.detach());this.tryAgainButton&&(a=this.tryAgainButton.closest(".notification"),b=$(".bgRepeater").offset(),a.css({bottom:c,right:"auto"}),b.left+=$(".bgRepeater").width()-a.outerWidth(),a.css({left:b.left}),$("#skipToNavigation").length&&$("#skipToNavigation").before(a.detach()))}else a=this.submitButton.closest(".notification"),
b=$(".bgRepeater").offset(),a.css({bottom:"auto",right:"auto"}),b.left+=$(".bgRepeater").width()-a.outerWidth(),b.top+=$(".bgRepeater").height()-a.outerHeight(),a.css({top:b.top,left:b.left}),$("#skipToNavigation").length&&$("#skipToNavigation").before(a.detach()),this.tryAgainButton&&(a=this.tryAgainButton.closest(".notification"),b=$(".bgRepeater").offset(),a.css({bottom:"auto",right:"auto"}),b.left+=$(".bgRepeater").width()-a.outerWidth(),b.top+=$(".bgRepeater").height()-a.outerHeight(),a.css({top:b.top,
left:b.left}),$("#skipToNavigation").length&&$("#skipToNavigation").before(a.detach()))}});return b}();
DKI.TestQuestion.TrueFalseQuestion={calculate:function(e,c,b){return 1>c?0:100},getCorrectCount:function(){return 1},getOptions:function(){for(var e=$(".dki-trueFalseOption-element",this.pageContainer),c=[],b,a=0;a<e.length;a++){var d=$("input",e[a])[0];b=parseInt(d.getAttribute("data-order"),"10")-1;for(var h=null,f=0;f<this.question.options.length;f++)if(this.question.options[f].element_id==$(e[a]).data("id")){h=this.question.options[f];break}c[b]=new DKI.TestQuestion.TrueFalseOption(d,e[a],h)}return c},
getOptionFeedback:function(){return""},hasSelection:function(){for(var e=this.getOptions(),c=0;c<e.length;c++)if(1==e[c].value())return!0;return!1}};
DKI.TestQuestion.TrueFalseOption=function(e,c,b){this.optionElement=e;this.optionValue=$(e).next();this.wrapper=c;this.choice=b;this.getFeedback=function(){return""};this.correctResponse=function(a){if(null!=a&&void 0!=a)$(this.optionElement).data("correctresponse",a.correct);else return $(this.optionElement).data("correctresponse")};this.isCorrect=function(){return this.choice.parameters.correct};this.enabled=function(a){if(void 0!==a&&null!==a)this.optionElement.disabled=!a;else return!this.optionElement.disabled};
this.value=function(a){if(void 0!==a&&null!==a)1==a||1==a?(this.optionElement.checked=!0,$("label",this.wrapper).addClass("checked")):(this.optionElement.checked=!1,$("label",this.wrapper).removeClass("checked"));else return this.optionElement.checked?1:0};this.score=function(){return 1==this.value()&&this.isCorrect()?this.value():0};this.showCorrect=function(a){1==this.value()&&this.isCorrect()?($(".dki-authoring-content-wrapper",this.wrapper).addClass("correct"),""!=settings.correctChoiceText&&
($(".dki-authoring-content-wrapper",this.wrapper).attr("title",settings.correctChoiceText),$("label",this.wrapper).prepend($("\x3cdiv class\x3d'sr-only sr-feedback' tabIndex\x3d'1'\x3e"+$("label",this.wrapper).text()+". "+settings.correctChoiceText+"\x3c/div\x3e")))):1==this.value()&&($(".dki-authoring-content-wrapper",this.wrapper).addClass("incorrect"),""!=settings.incorrectChoiceText&&($(".dki-authoring-content-wrapper",this.wrapper).attr("title",settings.incorrectChoiceText),$("label",this.wrapper).prepend($("\x3cdiv class\x3d'sr-only sr-feedback' tabIndex\x3d'1'\x3e"+
$("label",this.wrapper).text()+". "+settings.incorrectChoiceText+"\x3c/div\x3e"))));a&&this.isCorrect()&&$(".dki-authoring-content-wrapper",this.wrapper).addClass("multiChoiceCorrectResponse")};this.reset=function(){$(".dki-authoring-content-wrapper",this.wrapper).removeClass("correct").removeClass("incorrect").removeClass("multiChoiceCorrectResponse").removeAttr("tabIndex").removeAttr("title").find(".sr-only.sr-feedback").remove();$(this.optionElement).prop("checked",!1);$(this.optionElement).attr("attr-checked",
!1);"none"!=$(this.optionElement).css("display")&&($(".dki-element-anchor",this.wrapper).attr("tabIndex",this.optionElement.tabIndex),this.optionElement.tabIndex=-1);this.optionValue.removeClass("checked");this.enabled(!0)};this.start=function(){"none"!=$(this.optionElement).css("display")&&(this.optionElement.tabIndex=$(".dki-element-anchor",this.wrapper).data("tabIndex"),$(".dki-element-anchor",this.wrapper).attr("tabIndex",-1))}};
DKI.TestQuestion.MultipleChoiceQuestion={calculate:function(e,c,b){return b>c?0:(c-b)/e*100},getCorrectCount:function(){for(var e=0,c=this.getOptions(),b=0;b<c.length;b++)c[b].choice.parameters.correct&&e++;return e},getOptions:function(){for(var e=$(".dki-multiChoiceOption-element",this.pageContainer),c=[],b,a=0;a<e.length;a++){var d=$("input",e[a])[0];b=parseInt(d.getAttribute("data-order"),"10")-1;for(var h=null,f=0;f<this.question.options.length;f++)if(this.question.options[f].element_id==$(e[a]).data("id")){h=
this.question.options[f];break}c[b]=new DKI.TestQuestion.MultipleChoiceOption(d,e[a],h)}return c},randomizeOptions:function(){for(var e=$(".dki-multiChoiceOption-element[data-randomized\x3d'true']",this.pageContainer),c=[],b=[],a=[],d=[],h=this.getOptions(),f=0;f<h.length;f++)h[f].wrapper.data("randomized")&&d.push(f);$.each(e,function(a,d){var e=settings.responsive?0:$(d).data("y"),f=settings.responsive?0:$(d).data("x");c[a]={top:e,left:f,numbering:$(d).find(".optionNumber").text(),key:a};$(d).before("\x3cdiv class\x3d'RandomPlaceHolder' id\x3d'RandomPlaceHolder"+
a+"'\x3e\x3c/div\x3e");b[a]=$(d).detach()});e=b.length;for(f=0;f<e;f++)a.push(b.splice(Math.floor(Math.random()*b.length),1)[0]);for(f=0;f<e;f++)$(a[f]).data("y",c[f].top).data("x",c[f].left).data("numbering",c[f].numbering).data("feedbackOrder",d[f]+1).css({left:c[f].left,top:c[f].top}),$(".optionNumber",a[f]).text(c[f].numbering),$("#RandomPlaceHolder"+c[f].key,this.pageContainer).before(a[f]);$(".RandomPlaceHolder",this.pageContainer).remove();$(".dki-multiChoiceOption-element .multiChoiceContentWrapper").css("visibility",
"")},getOptionFeedback:function(){for(var e="",c=this.getOptions(),b=[],a=0;a<c.length;a++){var d;d=c[a].wrapper.data("randomized")?parseInt(c[a].wrapper.data("feedbackOrder"),"10"):parseInt(c[a].optionElement.getAttribute("data-order"),"10");b[d-1]=c[a]}for(a=0;a<b.length;a++)this.question.include_selection_feedback&&1==b[a].value().checked?e+=b[a].getFeedback():this.question.include_correct_feedback&&b[a].isCorrect()?e+=b[a].getFeedback():this.question.include_incorrect_feedback&&!b[a].isCorrect()&&
(e+=b[a].getFeedback());return e},hasSelection:function(){for(var e=this.getOptions(),c=0;c<e.length;c++)if(1==e[c].value().checked)return!0;return!1}};
DKI.TestQuestion.MultipleChoiceOption=function(e,c,b){this.optionElement=e;this.optionValue=$(e).next();this.wrapper=$(c);this.choice=b;this.getFeedback=function(){var a="",b=this.wrapper.data("feedback");b&&(b=b.replace(/&quot;/g,'"').replace(/&gt;/g,"\x3e").replace(/&lt;/g,"\x3c").replace(/&amp;/g,"\x26"),a=a+"\x3cdiv class\x3d'optionFeedbackWrapper'\x3e\x3cspan class\x3d'optionFeedbackNumbering'\x3e"+$(".optionNumber",this.wrapper).text(),a=a+"\x3c/span\x3e\x3cspan class\x3d'optionFeedbackContent'\x3e"+
b+"\x3c/span\x3e\x3c/div\x3e");return a};this.correctResponse=function(a){if(null!=a&&void 0!=a)this.optionElement.setAttribute("data-correctresponse",a.correct);else return this.optionElement.getAttribute("data-correctresponse")};this.isCorrect=function(){return this.choice.parameters.correct};this.enabled=function(a){if(null!==a&&void 0!==a)this.optionElement.disabled=!a;else return!this.optionElement.disabled};this.value=function(a){if(null!==a&&void 0!==a){if(1==a.checked?(this.optionElement.checked=
!0,$("label",this.wrapper).addClass("checked")):(this.optionElement.checked=!1,$("label",this.wrapper).removeClass("checked")),this.wrapper.data("randomized")){var b=$("#"+a.elementIdReplaced+"_wrapper");this.wrapper.css({left:b.data("x"),top:b.data("y")});$(".optionNumber",this.wrapper).text(b.data("numbering"));this.wrapper.data("feedbackOrder",a.feedbackOrder)}}else return a={text:this.choice.content,elementIdReplaced:null,feedbackOrder:null},this.wrapper.data("randomized")&&(a.elementIdReplaced=
this.wrapper.data("elementIdReplaced"),a.feedbackOrder=this.wrapper.data("feedbackOrder")),a.checked=this.optionElement.checked?1:0,a};this.score=function(){return 1==this.value().checked&&this.isCorrect()?1:1!=this.value().checked||this.isCorrect()?0:-1};this.showCorrect=function(a){1==this.value().checked&&(this.isCorrect()?($(".dki-authoring-content-wrapper",this.wrapper).addClass("correct"),""!=settings.correctChoiceText&&($(".dki-authoring-content-wrapper",this.wrapper).attr("title",settings.correctChoiceText),
$("label",this.wrapper).prepend($("\x3cdiv class\x3d'sr-only sr-feedback' tabIndex\x3d'1'\x3e"+$("label",this.wrapper).text()+". "+settings.correctChoiceText+"\x3c/div\x3e")))):($(".dki-authoring-content-wrapper",this.wrapper).addClass("incorrect"),""!=settings.incorrectChoiceText&&($(".dki-authoring-content-wrapper",this.wrapper).attr("title",settings.incorrectChoiceText),$("label",this.wrapper).prepend($("\x3cdiv class\x3d'sr-only sr-feedback' tabIndex\x3d'1'\x3e"+$("label",this.wrapper).text()+
". "+settings.inorrectChoiceText+"\x3c/div\x3e")))));a&&this.isCorrect()&&$(".dki-authoring-content-wrapper",this.wrapper).addClass("multiChoiceCorrectResponse")};this.reset=function(){$(".dki-authoring-content-wrapper",this.wrapper).removeClass("correct").removeClass("incorrect").removeClass("multiChoiceCorrectResponse").removeAttr("tabIndex").removeAttr("title").find(".sr-only.sr-feedback").remove();$(this.optionElement).prop("checked",!1);"none"!=$(this.optionElement).css("display")&&($(".dki-element-anchor",
this.wrapper).attr("tabIndex",this.optionElement.tabIndex),this.optionElement.tabIndex=-1);this.optionValue.removeClass("checked");$(this.optionElement).attr("attr-checked",!1);$(".optionNumber",this.wrapper).text(this.wrapper.data("numbering"));this.wrapper.data("feedbackOrder",null);this.wrapper.data("elementIdReplaced",null);this.enabled(!0)};this.start=function(){"none"!=$(this.optionElement).css("display")&&(this.optionElement.tabIndex=$(".dki-element-anchor",this.wrapper).data("tabIndex"),$(".dki-element-anchor",
this.wrapper).attr("tabIndex",-1))}};
DKI.TestQuestion.FillBlanksQuestion={calculate:function(e,c,b){return c/e*100},getCorrectCount:function(){return this.getOptions().length},getOptions:function(){for(var e=$(".dki-fillBlanksOption-element",this.pageContainer),c=[],b,a=0;a<e.length;a++){var d=$("input",e[a])[0];b=parseInt(d.getAttribute("data-order"),"10")-1;for(var h=null,f=0;f<this.question.options.length;f++)if(this.question.options[f].element_id==$(e[a]).data("id")){h=this.question.options[f];break}c[b]=new DKI.TestQuestion.FillBlanksOption(d,
$(e[a]),h)}return c},getOptionFeedback:function(){for(var e="",c=this.getOptions(),b=0;b<c.length;b++)this.question.include_correct_feedback&&1==c[b].score()?e+=c[b].getFeedback():this.question.include_incorrect_feedback&&0==c[b].score()&&(e+=c[b].getFeedback());return e},hasSelection:function(){for(var e=this.getOptions(),c=0;c<e.length;c++)if(""==e[c].value())return!1;return!0}};
DKI.TestQuestion.FillBlanksOption=function(e,c,b){this.optionElement=e;this.wrapper=c;this.choice=b;this.getFeedback=function(){var a="",b=this.wrapper.data("feedback");b&&(b=b.replace(/&quot;/g,'"').replace(/&gt;/g,"\x3e").replace(/&lt;/g,"\x3c").replace(/&amp;/g,"\x26"),a=a+"\x3cdiv class\x3d'optionFeedbackWrapper'\x3e\x3cspan class\x3d'optionFeedbackNumbering'\x3e"+$(".optionNumber",this.wrapper).text(),a=a+"\x3c/span\x3e\x3cspan class\x3d'optionFeedbackContent'\x3e"+b+"\x3c/span\x3e\x3c/div\x3e");
return a};this.correctResponse=function(a){if(null!=a&&void 0!=a)this.optionElement.setAttribute("data-correctresponse",a.correctValues);else return this.optionElement.getAttribute("data-correctresponse")};this.enabled=function(a){if(null!==a&&void 0!==a)this.optionElement.disabled=!a;else return!this.optionElement.disabled};this.value=function(a){if(null!==a&&void 0!==a)$(this.optionElement).val(a);else return $.trim($(this.optionElement).val()).toLowerCase()};this.isCorrect=function(){return 1==
this.score()?!0:!1};this.score=function(){for(var a=this.choice.parameters.correctValues,b=0;b<a.length;b++){var c=$.trim(a[b]).toLowerCase(),e=this.value();$.isNumeric(c)&&(c=parseFloat(c),e=parseFloat(e.replace(/\,|\s/g,"")));c=$("\x3cspan\x3e"+c+"\x3c/span\x3e").text().trim();if(e==c)return 1}return 0};this.showCorrect=function(a){1==this.score()?($(".dki-question-option",this.wrapper).addClass("correct"),""!=settings.correctChoiceText&&$(".dki-question-option",this.wrapper).attr("title",settings.correctChoiceText).append($("\x3cdiv class\x3d'sr-only sr-feedback' tabIndex\x3d'1'\x3e"+
$(this.optionElement).val()+". "+settings.correctChoiceText+"\x3c/div\x3e"))):($(".dki-question-option",this.wrapper).addClass("incorrect"),""!=settings.incorrectChoiceText&&$(".dki-question-option",this.wrapper).attr("title",settings.incorrectChoiceText).append($("\x3cdiv class\x3d'sr-only sr-feedback' tabIndex\x3d'1'\x3e"+$(this.optionElement).val()+". "+settings.incorrectChoiceText+"\x3c/div\x3e")))};this.reset=function(){$(this.optionElement).val("");$(".dki-element-anchor",this.wrapper).attr("tabIndex",
this.optionElement.tabIndex);this.optionElement.tabIndex=-1;$(".dki-question-option",this.wrapper).removeClass("correct");$(".dki-question-option",this.wrapper).removeClass("incorrect");$(".dki-question-option",this.wrapper).removeAttr("tabIndex").removeAttr("title").find(".sr-only.sr-feedback").remove();this.enabled(!0)};this.start=function(){this.optionElement.tabIndex=$(".dki-element-anchor",this.wrapper).data("tabIndex");$(".dki-element-anchor",this.wrapper).attr("tabIndex",-1)}};
DKI.TestQuestion.MultiplePulldownQuestion={calculate:function(e,c,b){return c/e*100},getCorrectCount:function(){return this.getOptions().length},getOptions:function(){for(var e=$(".dki-multiPulldownOption-element",this.pageContainer),c=[],b,a=0;a<e.length;a++){var d=$("select",e[a])[0];b=parseInt(d.getAttribute("data-order"),"10")-1;for(var h=null,f=0;f<this.question.options.length;f++)if(this.question.options[f].element_id==$(e[a]).data("id")){h=this.question.options[f];break}c[b]=new DKI.TestQuestion.MultiplePulldownOption(d,
$(e[a]),h)}return c},getOptionFeedback:function(){for(var e="",c=this.getOptions(),b=0;b<c.length;b++)this.question.include_correct_feedback&&1==c[b].score()?e+=c[b].getFeedback():this.question.include_incorrect_feedback&&0==c[b].score()&&(e+=c[b].getFeedback());return e},hasSelection:function(){for(var e=this.getOptions(),c=0;c<e.length;c++)if(""==e[c].value())return!1;return!0}};
DKI.TestQuestion.MultiplePulldownOption=function(e,c,b){this.optionElement=e;this.wrapper=c;this.choice=b;this.getFeedback=function(){var a="",b=this.wrapper.data("feedback");b&&(b=b.replace(/&quot;/g,'"').replace(/&gt;/g,"\x3e").replace(/&lt;/g,"\x3c").replace(/&amp;/g,"\x26"),a=a+"\x3cdiv class\x3d'optionFeedbackWrapper'\x3e\x3cspan class\x3d'optionFeedbackNumbering'\x3e"+$(".optionNumber",this.wrapper).text(),a=a+"\x3c/span\x3e\x3cspan class\x3d'optionFeedbackContent'\x3e"+b+"\x3c/span\x3e\x3c/div\x3e");
return a};this.correctResponse=function(a){if(null!=a&&void 0!=a)this.optionElement.setAttribute("data-correctresponse",a.correctValue);else return this.optionElement.getAttribute("data-correctresponse")};this.isCorrect=function(){var a=$('\x3cselect\x3e\x3coption value\x3d"'+escape(this.choice.parameters.correctValue.trim())+'"\x3e'+this.choice.parameters.correctValue+"\x3c/option\x3e\x3c/select\x3e");return escape(this.value().trim())==a.value()?!0:!1};this.enabled=function(a){if(null!==a&&void 0!==
a)this.optionElement.disabled=!a;else return!this.optionElement.disabled};this.value=function(a){if(null!==a&&void 0!=a)$(this.optionElement).val(a);else return $(this.optionElement).val()};this.score=function(){return this.isCorrect()?1:0};this.showCorrect=function(a){1==this.score()?($(".dki-question-option",this.wrapper).addClass("correct"),""!=settings.correctChoiceText&&$(".dki-question-option",this.wrapper).attr("title",settings.correctChoiceText).append($("\x3cdiv class\x3d'sr-only sr-feedback' tabIndex\x3d'1'\x3e"+
$(this.optionElement).val()+". "+settings.correctChoiceText+"\x3c/div\x3e"))):($(".dki-question-option",this.wrapper).addClass("incorrect"),""!=settings.incorrectChoiceText&&$(".dki-question-option",this.wrapper).attr("title",settings.incorrectChoiceText).append($("\x3cdiv class\x3d'sr-only sr-feedback' tabIndex\x3d'1'\x3e"+$(this.optionElement).val()+". "+settings.incorrectChoiceText+"\x3c/div\x3e")))};this.reset=function(){this.optionElement.selectedIndex=0;$(".dki-element-anchor",this.wrapper).attr("tabIndex",
this.optionElement.tabIndex);this.optionElement.tabIndex=-1;$(".dki-question-option",this.wrapper).removeClass("correct");$(".dki-question-option",this.wrapper).removeClass("incorrect");$(".dki-question-option",this.wrapper).removeAttr("tabIndex").removeAttr("title").find(".sr-only.sr-feedback").remove();this.enabled(!0)};this.start=function(){this.optionElement.tabIndex=$(".dki-element-anchor",this.wrapper).data("tabIndex");$(".dki-element-anchor",this.wrapper).attr("tabIndex",-1)}};
DKI.TestQuestion.FreeFormQuestion={calculate:function(){return""!==this.getOptions()[0].value().trim()?100:0},getCorrectCount:function(){return 0},getOptions:function(){for(var e=$(".dki-freeFormOption-element textarea",this.pageContainer),c=[],b,a=0;a<e.length;a++)b=parseInt(e[a].getAttribute("data-order"),"10")-1,c[b]=new DKI.TestQuestion.FreeFormOption(e[a],$(e[a]).closest(".dki-authoring-element"));return c},getOptionFeedback:function(){return""},hasSelection:function(){for(var e=this.getOptions(),
c=0;c<e.length;c++)if(""==e[c].value())return!1;return!0}};
DKI.TestQuestion.FreeFormOption=function(e,c){this.optionElement=e;this.wrapper=c;this.correctResponse=function(){return""};this.getFeedback=function(){return""};this.isCorrect=function(){return""!=this.value()?!0:!1};this.enabled=function(b){if(null!==b&&void 0!==b)this.optionElement.disabled=!b;else return!this.optionElement.disabled};this.value=function(b){if(null!==b&&void 0!==b)$(this.optionElement).val(b);else return $(this.optionElement).val()};this.score=function(){return 0};this.showCorrect=
function(b){this.isCorrect()?($(".dki-question-option",this.wrapper).addClass("correct"),""!=settings.correctChoiceText&&$(".dki-question-option",this.wrapper).attr("title",settings.correctChoiceText).append($("\x3cdiv class\x3d'sr-only sr-feedback' tabIndex\x3d'1'\x3e"+$(this.optionElement).val()+". "+settings.correctChoiceText+"\x3c/div\x3e"))):($(".dki-question-option",this.wrapper).addClass("incorrect"),""!=settings.incorrectChoiceText&&$(".dki-question-option",this.wrapper).attr("title",settings.incorrectChoiceText).append($("\x3cdiv class\x3d'sr-only sr-feedback' tabIndex\x3d'1'\x3e"+
$(this.optionElement).val()+". "+settings.incorrectChoiceText+"\x3c/div\x3e")))};this.reset=function(){$(this.optionElement).val("");$(".dki-element-anchor",this.wrapper).attr("tabIndex",this.optionElement.tabIndex);this.optionElement.tabIndex=-1;$(".dki-question-option",this.wrapper).removeClass("correct");$(".dki-question-option",this.wrapper).removeClass("incorrect");$(".dki-question-option",this.wrapper).removeAttr("tabIndex").removeAttr("title").find(".sr-only.sr-feedback").remove();this.enabled(!0)};
this.start=function(){this.optionElement.tabIndex=$(".dki-element-anchor",this.wrapper).data("tabIndex");$(".dki-element-anchor",this.wrapper).attr("tabIndex",-1)}};
DKI.TestQuestion.DragDropQuestion={calculate:function(e,c,b){return 0==e&&0==c&&0==b?0:c/e*100},getCorrectCount:function(){return $(".dki-authoring-element[data-is-draggable\x3dtrue][data-isquestionelement\x3dtrue]",this.pageContainer).length},getOptions:function(){for(var e=$(".dki-authoring-element[data-is-draggable\x3dtrue][data-isquestionelement\x3dtrue]",this.pageContainer),c=[],b=0;b<e.length;b++){for(var a=null,d=$(e[b]).data("id"),h=0;h<this.question.options.length;h++)this.question.options[h].element_id==
d&&(a=this.question.options[h]);c[b]=new DKI.TestQuestion.DragDropOption(e[b],a)}return c},getOptionFeedback:function(){return""},hasSelection:function(){for(var e=this.getOptions(),c=0;c<e.length;c++)if(null!=e[c].value().target.id)return!0;return!1}};
DKI.TestQuestion.customQuestion={calculate:function(e,c,b,a){try{if(isNaN(a))throw"Invalid data. Please provide a numeric score.";a=parseInt(a,10);a=0>a?0:a;return 100<a?100:a}catch(d){return 0}},getOptions:function(){return[]},getOptionFeedback:function(){return""},getCorrectCount:function(){return 0},hasSelection:function(){return!0}};
DKI.TestQuestion.DragDropOption=function(e,c){this.optionElement=e;this.questionOption=c;this.correctResponse=function(b){b=this.value();$(this.optionElement).css({top:b.y+"px",left:b.x+"px"});return null};this.getFeedback=function(){return""};this.enabled=function(b){if(null!==b&&void 0!==b){$(this.optionElement).draggable({disabled:!b});var a=0;$(".dki-authoring-element[data-is-droppable\x3dtrue][data-isquestionelement\x3dtrue]",this.pageContainer).each(function(){var b=parseInt($(this).css("z-index"),
10);b>a&&(a=b)});$(this.optionElement).css("z-index",a+1);$(this.optionElement).parent(".dki-authoring-group").css("position","static")}else return!1};this.value=function(b){if(null!==b&&void 0!==b)$(this.optionElement).data("dropData",b);else{b=$(this.optionElement).data("dropData");if(!b){b=$(this.optionElement).position();var a=$(this.optionElement).data("title");""==a&&(a=$(this.optionElement).text());b={id:$(this.optionElement).data("dragdropid"),elementId:$(this.optionElement).data("id"),title:a,
target:{id:null,title:"No Target"},x:b.left,y:b.top}}return b}};this.isCorrect=function(){return 1==this.score()?!0:!1};this.score=function(){var b=this.value().target.id;if(b){for(var a=0;a<this.questionOption.parameters.correctTargets.length;a++)if(b.toString().toLowerCase()==this.questionOption.parameters.correctTargets[a].toString().toLowerCase())return 1;return-1}return 0<this.questionOption.parameters.correctTargets.length?-1:1};this.showCorrect=function(b){1==this.score()?($(this.optionElement).addClass("correct"),
""!=settings.correctChoiceText&&$(this.optionElement).find(".dki-element-content").attr("title",settings.correctChoiceText).append($("\x3cdiv class\x3d'sr-only sr-feedback'\x3e"+settings.correctChoiceText+"\x3c/div\x3e"))):($(this.optionElement).addClass("incorrect"),""!=settings.incorrectChoiceText&&$(this.optionElement).find(".dki-element-content").attr("title",settings.incorrectChoiceText).append($("\x3cdiv class\x3d'sr-only sr-feedback'\x3e"+settings.incorrectChoiceText+"\x3c/div\x3e")))};this.reset=
function(){$(this.optionElement).data("dropData",null);$(this.optionElement).removeClass("correct");$(this.optionElement).removeClass("incorrect");$(this.optionElement).removeAttr("tabIndex").removeAttr("title").find(".sr-only.sr-feedback").remove();this.enabled(!0)};this.start=function(){}};