/*! -- File: pixastic.min.js ( Input 0 ) -- */
var Pixastic=function(){function a(a,b,c){a.addEventListener?a.addEventListener(b,c,!1):a.attachEvent&&a.attachEvent("on"+b,c)}function d(b){var c=!1,d=function(){c||(c=!0,b())};document.write('\x3cscript defer src\x3d"//:" id\x3d"__onload_ie_pixastic__"\x3e\x3c/script\x3e');var e=document.getElementById("__onload_ie_pixastic__");e.onreadystatechange=function(){"complete"==e.readyState&&(e.parentNode.removeChild(e),d())};document.addEventListener&&document.addEventListener("DOMContentLoaded",d,!1);
a(window,"load",d)}function c(){for(var a=b("pixastic",null,"img"),c=b("pixastic",null,"canvas"),d=a.concat(c),e=0;e<d.length;e++)(function(){for(var a=d[e],b=[],c=a.className.split(" "),l=0;l<c.length;l++){var g=c[l];"pixastic-"==g.substring(0,9)&&(g=g.substring(9),""!=g&&b.push(g))}if(b.length)if("img"==a.tagName.toLowerCase())if(c=new Image,c.src=a.src,c.complete)for(c=0;c<b.length;c++)(l=Pixastic.applyAction(a,a,b[c],null))&&(a=l);else c.onload=function(){for(var c=0;c<b.length;c++){var d=Pixastic.applyAction(a,
a,b[c],null);d&&(a=d)}};else setTimeout(function(){for(var c=0;c<b.length;c++){var d=Pixastic.applyAction(a,a,b[c],null);d&&(a=d)}},1)})()}function b(a,b,c){var d=[];null==b&&(b=document);null==c&&(c="*");b=b.getElementsByTagName(c);c=b.length;a=new RegExp("(^|\\s)"+a+"(\\s|$)");for(j=i=0;i<c;i++)a.test(b[i].className)&&(d[j]=b[i],j++);return d}"undefined"!=typeof pixastic_parseonload&&pixastic_parseonload&&d(c);var g=function(){var a=document.createElement("canvas"),b=!1;try{b=!("function"!=typeof a.getContext||
!a.getContext("2d"))}catch(c){}return function(){return b}}(),e=function(){var a=document.createElement("canvas"),b=!1,c;try{"function"==typeof a.getContext&&(c=a.getContext("2d"))&&(b="function"==typeof c.getImageData)}catch(d){}return function(){return b}}(),m=function(){var a=!1,b=document.createElement("canvas");if(g()&&e()){b.width=b.height=1;b=b.getContext("2d");b.fillStyle="rgb(255,0,0)";b.fillRect(0,0,1,1);var c=document.createElement("canvas");c.width=c.height=1;var d=c.getContext("2d");
d.fillStyle="rgb(0,0,255)";d.fillRect(0,0,1,1);b.globalAlpha=.5;b.drawImage(c,0,0);a=255!=b.getImageData(0,0,1,1).data[2]}return function(){return a}}();return{parseOnLoad:!1,debug:!1,applyAction:function(a,b,c,d){d=d||{};var e="canvas"==a.tagName.toLowerCase();if(e&&Pixastic.Client.isIE())return!1;var f,g,h=!1;Pixastic.Client.hasCanvas()&&(h=!!d.resultCanvas,f=d.resultCanvas||document.createElement("canvas"),g=f.getContext("2d"));var n=a.offsetWidth,m=a.offsetHeight;e&&(n=a.width,m=a.height);if(0==
n||0==m)n=a.naturalWidth,m=a.naturalHeight;if(0==n||0==m)if(null==a.parentNode){var v=a.style.position,w=a.style.left;a.style.position="absolute";a.style.left="-9999px";document.body.appendChild(a);n=a.offsetWidth;m=a.offsetHeight;document.body.removeChild(a);a.style.position=v;a.style.left=w}else return;if(-1<c.indexOf("(")&&(v=c,c=v.substr(0,v.indexOf("(")),v=v.match(/\((.*?)\)/),v[1]))for(v=v[1].split(";"),w=0;w<v.length;w++)if(thisArg=v[w].split("\x3d"),2==thisArg.length)if("rect"==thisArg[0]){var x=
thisArg[1].split(",");d[thisArg[0]]={left:parseInt(x[0],10)||0,top:parseInt(x[1],10)||0,width:parseInt(x[2],10)||0,height:parseInt(x[3],10)||0}}else d[thisArg[0]]=thisArg[1];d.rect?(d.rect.left=Math.round(d.rect.left),d.rect.top=Math.round(d.rect.top),d.rect.width=Math.round(d.rect.width),d.rect.height=Math.round(d.rect.height)):d.rect={left:0,top:0,width:n,height:m};v=!1;Pixastic.Actions[c]&&"function"==typeof Pixastic.Actions[c].process&&(v=!0);if(!v||!Pixastic.Actions[c].checkSupport())return!1;
Pixastic.Client.hasCanvas()?(f!==a&&(f.width=n,f.height=m),h||(f.style.width=n+"px",f.style.height=m+"px"),g.drawImage(b,0,0,n,m),a.__pixastic_org_image?(f.__pixastic_org_image=a.__pixastic_org_image,f.__pixastic_org_width=a.__pixastic_org_width,f.__pixastic_org_height=a.__pixastic_org_height):(f.__pixastic_org_image=a,f.__pixastic_org_width=n,f.__pixastic_org_height=m)):Pixastic.Client.isIE()&&"undefined"==typeof a.__pixastic_org_style&&(a.__pixastic_org_style=a.style.cssText);b={image:a,canvas:f,
width:n,height:m,useData:!0,options:d};return Pixastic.Actions[c].process(b)?Pixastic.Client.hasCanvas()?(b.useData&&Pixastic.Client.hasCanvasImageData()&&(f.getContext("2d").putImageData(b.canvasData,d.rect.left,d.rect.top),f.getContext("2d").fillRect(0,0,0,0)),d.leaveDOM||(f.title=a.title,f.imgsrc=a.imgsrc,e||(f.alt=a.alt),e||(f.imgsrc=a.src),f.className=a.className,f.style.cssText=a.style.cssText,f.name=a.name,f.tabIndex=a.tabIndex,f.id=a.id,a.parentNode&&a.parentNode.replaceChild&&a.parentNode.replaceChild(f,
a)),d.resultCanvas=f):a:!1},prepareData:function(a,b){var c=a.canvas.getContext("2d"),d=a.options.rect,c=c.getImageData(d.left,d.top,d.width,d.height),d=c.data;b||(a.canvasData=c);return d},process:function(a,b,c,d){if("img"==a.tagName.toLowerCase()){var e=new Image;e.src=a.src;if(e.complete){var f=Pixastic.applyAction(a,e,b,c);d&&d(f);return f}e.onload=function(){var f=Pixastic.applyAction(a,e,b,c);d&&d(f)}}if("canvas"==a.tagName.toLowerCase())return f=Pixastic.applyAction(a,a,b,c),d&&d(f),f},revert:function(a){if(Pixastic.Client.hasCanvas()){if("canvas"==
a.tagName.toLowerCase()&&a.__pixastic_org_image)return a.width=a.__pixastic_org_width,a.height=a.__pixastic_org_height,a.getContext("2d").drawImage(a.__pixastic_org_image,0,0),a.parentNode&&a.parentNode.replaceChild&&a.parentNode.replaceChild(a.__pixastic_org_image,a),a}else Pixastic.Client.isIE()&&"undefined"!=typeof a.__pixastic_org_style&&(a.style.cssText=a.__pixastic_org_style)},Client:{hasCanvas:g,hasCanvasImageData:e,hasGlobalAlpha:m,isIE:function(){return!!document.all&&!!window.attachEvent&&
!window.opera}},Actions:{}}}();"undefined"!=typeof jQuery&&jQuery&&jQuery.fn&&(jQuery.fn.pixastic=function(a,d){var c=[];this.each(function(){if("img"!=this.tagName.toLowerCase()||this.complete){var b=Pixastic.process(this,a,d);b&&c.push(b)}});return 0<c.length?jQuery(c):this});
Pixastic.Actions.blend={process:function(a){var d=parseFloat(a.options.amount),c=(a.options.mode||"normal").toLowerCase(),b=a.options.image,d=Math.max(0,Math.min(1,d));if(!b)return!1;if(Pixastic.Client.hasCanvasImageData()){var g=a.options.rect,e=Pixastic.prepareData(a),m=g.width,l=g.height;a.useData=!1;var p=document.createElement("canvas");p.width=a.canvas.width;p.height=a.canvas.height;var t=p.getContext("2d");t.drawImage(b,0,0);var q={canvas:p,options:a.options},b=Pixastic.prepareData(q),u=q.canvasData,
q=m*l,f=4*q,k,h,n,r,v,w,x,y,z,B,C,D,F,E,A=!1;switch(c){case "multiply":for(;q--;)b[f-=4]=e[f]*b[f]/255,b[k=f+1]=e[k]*b[k]/255,b[h=f+2]=e[h]*b[h]/255;A=!0;break;case "lighten":for(;q--;)(n=e[f-=4])>b[f]&&(b[f]=n),(r=e[k=f+1])>b[k]&&(b[k]=r),(v=e[h=f+2])>b[h]&&(b[h]=v);A=!0;break;case "darken":for(;q--;)(n=e[f-=4])<b[f]&&(b[f]=n),(r=e[k=f+1])<b[k]&&(b[k]=r),(v=e[h=f+2])<b[h]&&(b[h]=v);A=!0;break;case "darkercolor":for(;q--;).3*(n=e[f-=4])+.59*(r=e[k=f+1])+.11*(v=e[h=f+2])<=.3*b[f]+.59*b[k]+.11*b[h]&&
(b[f]=n,b[k]=r,b[h]=v);A=!0;break;case "lightercolor":for(;q--;).3*(n=e[f-=4])+.59*(r=e[k=f+1])+.11*(v=e[h=f+2])>.3*b[f]+.59*b[k]+.11*b[h]&&(b[f]=n,b[k]=r,b[h]=v);A=!0;break;case "lineardodge":for(;q--;)255<(z=e[f-=4]+b[f])?b[f]=255:b[f]=z,255<(B=e[k=f+1]+b[k])?b[k]=255:b[k]=B,255<(C=e[h=f+2]+b[h])?b[h]=255:b[h]=C;A=!0;break;case "linearburn":for(;q--;)255>(z=e[f-=4]+b[f])?b[f]=0:b[f]=z-255,255>(B=e[k=f+1]+b[k])?b[k]=0:b[k]=B-255,255>(C=e[h=f+2]+b[h])?b[h]=0:b[h]=C-255;A=!0;break;case "difference":for(;q--;)0>
(z=e[f-=4]-b[f])?b[f]=-z:b[f]=z,0>(B=e[k=f+1]-b[k])?b[k]=-B:b[k]=B,0>(C=e[h=f+2]-b[h])?b[h]=-C:b[h]=C;A=!0;break;case "screen":for(;q--;)b[f-=4]=255-((255-b[f])*(255-e[f])>>8),b[k=f+1]=255-((255-b[k])*(255-e[k])>>8),b[h=f+2]=255-((255-b[h])*(255-e[h])>>8);A=!0;break;case "exclusion":for(c=2/255;q--;)b[f-=4]=(n=e[f])-(n*c-1)*b[f],b[k=f+1]=(r=e[k])-(r*c-1)*b[k],b[h=f+2]=(v=e[h])-(v*c-1)*b[h];A=!0;break;case "overlay":for(c=2/255;q--;)128>(n=e[f-=4])?b[f]=b[f]*n*c:b[f]=255-(255-b[f])*(255-n)*c,128>(r=
e[k=f+1])?b[k]=b[k]*r*c:b[k]=255-(255-b[k])*(255-r)*c,128>(v=e[h=f+2])?b[h]=b[h]*v*c:b[h]=255-(255-b[h])*(255-v)*c;A=!0;break;case "softlight":for(c=2/255;q--;)128>(n=e[f-=4])?b[f]=((b[f]>>1)+64)*n*c:b[f]=255-(191-(b[f]>>1))*(255-n)*c,128>(r=e[k=f+1])?b[k]=((b[k]>>1)+64)*r*c:b[k]=255-(191-(b[k]>>1))*(255-r)*c,128>(v=e[h=f+2])?b[h]=((b[h]>>1)+64)*v*c:b[h]=255-(191-(b[h]>>1))*(255-v)*c;A=!0;break;case "hardlight":for(c=2/255;q--;)128>(w=b[f-=4])?b[f]=e[f]*w*c:b[f]=255-(255-e[f])*(255-w)*c,128>(x=b[k=
f+1])?b[k]=e[k]*x*c:b[k]=255-(255-e[k])*(255-x)*c,128>(y=b[h=f+2])?b[h]=e[h]*y*c:b[h]=255-(255-e[h])*(255-y)*c;A=!0;break;case "colordodge":for(;q--;)255<(z=(e[f-=4]<<8)/(255-(w=b[f])))||255==w?b[f]=255:b[f]=z,255<(B=(e[k=f+1]<<8)/(255-(x=b[k])))||255==x?b[k]=255:b[k]=B,255<(C=(e[h=f+2]<<8)/(255-(y=b[h])))||255==y?b[h]=255:b[h]=C;A=!0;break;case "colorburn":for(;q--;)0>(z=255-(255-e[f-=4]<<8)/b[f])||0==b[f]?b[f]=0:b[f]=z,0>(B=255-(255-e[k=f+1]<<8)/b[k])||0==b[k]?b[k]=0:b[k]=B,0>(C=255-(255-e[h=f+
2]<<8)/b[h])||0==b[h]?b[h]=0:b[h]=C;A=!0;break;case "linearlight":for(;q--;)0>(z=2*(w=b[f-=4])+e[f]-256)||128>w&&0>z?b[f]=0:b[f]=255<z?255:z,0>(B=2*(x=b[k=f+1])+e[k]-256)||128>x&&0>B?b[k]=0:b[k]=255<B?255:B,0>(C=2*(y=b[h=f+2])+e[h]-256)||128>y&&0>C?b[h]=0:b[h]=255<C?255:C;A=!0;break;case "vividlight":for(;q--;)128>(w=b[f-=4])?w?0>(z=255-(255-e[f]<<8)/(2*w))?b[f]=0:b[f]=z:b[f]=0:255>(z=D=2*w-256)?255<(z=(e[f]<<8)/(255-D))?b[f]=255:b[f]=z:b[f]=0>z?0:z,128>(x=b[k=f+1])?x?0>(B=255-(255-e[k]<<8)/(2*x))?
b[k]=0:b[k]=B:b[k]=0:255>(B=F=2*x-256)?255<(B=(e[k]<<8)/(255-F))?b[k]=255:b[k]=B:b[k]=0>B?0:B,128>(y=b[h=f+2])?y?0>(C=255-(255-e[h]<<8)/(2*y))?b[h]=0:b[h]=C:b[h]=0:255>(C=E=2*y-256)?255<(C=(e[h]<<8)/(255-E))?b[h]=255:b[h]=C:b[h]=0>C?0:C;A=!0;break;case "pinlight":for(;q--;)128>(w=b[f-=4])?(n=e[f])<(D=2*w)?b[f]=n:b[f]=D:(n=e[f])>(D=2*w-256)?b[f]=n:b[f]=D,128>(x=b[k=f+1])?(r=e[k])<(F=2*x)?b[k]=r:b[k]=F:(r=e[k])>(F=2*x-256)?b[k]=r:b[k]=F,128>(w=b[h=f+2])?(n=e[h])<(D=2*w)?b[h]=n:b[h]=D:(n=e[h])>(D=2*
w-256)?b[h]=n:b[h]=D;A=!0;break;case "hardmix":for(;q--;)128>(w=b[f-=4])?b[f]=128>255-(255-e[f]<<8)/(2*w)||0==w?0:255:255>(D=2*w-256)&&128>(e[f]<<8)/(255-D)?b[f]=0:b[f]=255,128>(x=b[k=f+1])?b[k]=128>255-(255-e[k]<<8)/(2*x)||0==x?0:255:255>(F=2*x-256)&&128>(e[k]<<8)/(255-F)?b[k]=0:b[k]=255,128>(y=b[h=f+2])?b[h]=128>255-(255-e[h]<<8)/(2*y)||0==y?0:255:255>(E=2*y-256)&&128>(e[h]<<8)/(255-E)?b[h]=0:b[h]=255;A=!0}A&&t.putImageData(u,0,0);if(1==d||Pixastic.Client.hasGlobalAlpha())a=a.canvas.getContext("2d"),
a.save(),a.globalAlpha=d,a.drawImage(p,0,0,g.width,g.height,g.left,g.top,g.width,g.height),a.globalAlpha=1,a.restore();else{q=m*l;g=d;for(d=1-d;q--;)f=4*q,p=e[f+1]*d+b[f+1]*g>>0,m=e[f+2]*d+b[f+2]*g>>0,e[f]=e[f]*d+b[f]*g>>0,e[f+1]=p,e[f+2]=m;a.useData=!0}return!0}},checkSupport:function(){return Pixastic.Client.hasCanvasImageData()}};
Pixastic.Actions.blur={process:function(a){"undefined"==typeof a.options.fixMargin&&(a.options.fixMargin=!0);if(Pixastic.Client.hasCanvasImageData()){for(var d=Pixastic.prepareData(a),c=Pixastic.prepareData(a,!0),b=[[0,1,0],[1,2,1],[0,1,0]],g=0,e=0;3>e;e++)for(var m=0;3>m;m++)g+=b[e][m];g=1/(2*g);b=a.options.rect;a=b.width;b=b.height;e=4*a;m=b;do{var l=(m-1)*e,p=(1==m?0:m-2)*a*4,t=(m==b?m-1:m)*a*4,q=a;do{var u=l+(4*q-4),f=p+4*(1==q?0:q-2),k=t+4*(q==a?q-1:q);d[u]=(2*(c[f]+c[u-4]+c[u+4]+c[k])+4*c[u])*
g;d[u+1]=(2*(c[f+1]+c[u-3]+c[u+5]+c[k+1])+4*c[u+1])*g;d[u+2]=(2*(c[f+2]+c[u-2]+c[u+6]+c[k+2])+4*c[u+2])*g}while(--q)}while(--m);return!0}if(Pixastic.Client.isIE())return a.image.style.filter+=" progid:DXImageTransform.Microsoft.Blur(pixelradius\x3d1.5)",a.options.fixMargin&&(a.image.style.marginLeft=(parseInt(a.image.style.marginLeft,10)||0)-2+"px",a.image.style.marginTop=(parseInt(a.image.style.marginTop,10)||0)-2+"px"),!0},checkSupport:function(){return Pixastic.Client.hasCanvasImageData()||Pixastic.Client.isIE()}};
Pixastic.Actions.blurfast={process:function(a){var d=parseFloat(a.options.amount)||0,d=Math.max(0,Math.min(5,d));if(Pixastic.Client.hasCanvas()){var c=a.options.rect,b=a.canvas.getContext("2d");b.save();b.beginPath();b.rect(c.left,c.top,c.width,c.height);b.clip();var c=Math.round(a.width/2),g=Math.round(a.height/2),e=document.createElement("canvas");e.width=c;e.height=g;for(var d=Math.round(20*d),m=e.getContext("2d"),l=0;l<d;l++){var p=Math.max(1,Math.round(c-l)),t=Math.max(1,Math.round(g-l));m.clearRect(0,
0,c,g);m.drawImage(a.canvas,0,0,a.width,a.height,0,0,p,t);b.drawImage(e,0,0,p,t,0,0,a.width,a.height)}b.restore();a.useData=!1;return!0}if(Pixastic.Client.isIE())return b=10*d,a.image.style.filter+=" progid:DXImageTransform.Microsoft.Blur(pixelradius\x3d"+b+")",a.image.style.marginLeft=(parseInt(a.image.style.marginLeft,10)||0)-Math.round(b)+"px",a.image.style.marginTop=(parseInt(a.image.style.marginTop,10)||0)-Math.round(b)+"px",!0},checkSupport:function(){return Pixastic.Client.hasCanvas()||Pixastic.Client.isIE()}};
Pixastic.Actions.brightness={process:function(a){var d=parseInt(a.options.brightness,10)||0,c=parseFloat(a.options.contrast)||0,b=!(!a.options.legacy||"false"==a.options.legacy);if(b)d=Math.min(150,Math.max(-150,d));else var g=1+Math.min(150,Math.max(-150,d))/150;c=Math.max(0,c+1);if(Pixastic.Client.hasCanvasImageData()){var e=Pixastic.prepareData(a);a=a.options.rect;a=a.width*a.height;var m=4*a,l,p;1!=c?b?(b=c,d=(d-128)*c+128):(b=g*c,d=128*-c+128):b?b=1:(b=g,d=0);for(var t,q,u;a--;)255<(t=e[m-=4]*
b+d)?e[m]=255:e[m]=0>t?0:t,255<(q=e[l=m+1]*b+d)?e[l]=255:e[l]=0>q?0:q,255<(u=e[p=m+2]*b+d)?e[p]=255:e[p]=0>u?0:u;return!0}},checkSupport:function(){return Pixastic.Client.hasCanvasImageData()}};
Pixastic.Actions.coloradjust={process:function(a){var d=parseFloat(a.options.red)||0,c=parseFloat(a.options.green)||0,b=parseFloat(a.options.blue)||0,d=Math.round(255*d),c=Math.round(255*c),b=Math.round(255*b);if(Pixastic.Client.hasCanvasImageData()){var g=Pixastic.prepareData(a);a=a.options.rect;a=a.width*a.height;for(var e=4*a,m,l,p,t,q;a--;)e-=4,d&&(0>(p=g[e]+d)?g[e]=0:g[e]=255<p?255:p),c&&(0>(t=g[m=e+1]+c)?g[m]=0:g[m]=255<t?255:t),b&&(0>(q=g[l=e+2]+b)?g[l]=0:g[l]=255<q?255:q);return!0}},checkSupport:function(){return Pixastic.Client.hasCanvasImageData()}};
Pixastic.Actions.colorhistogram={array256:function(a){arr=[];for(var d=0;256>d;d++)arr[d]=a;return arr},process:function(a){"object"!=typeof a.options.returnValue&&(a.options.returnValue={rvals:[],gvals:[],bvals:[]});var d=!!a.options.paint,c=a.options.returnValue;"array"!=typeof c.values&&(c.rvals=[],c.gvals=[],c.bvals=[]);if(Pixastic.Client.hasCanvasImageData()){var b=Pixastic.prepareData(a);a.useData=!1;for(var g=this.array256(0),e=this.array256(0),m=this.array256(0),l=a.options.rect,l=l.width*
l.height,p=4*l;l--;)g[b[p-=4]]++,e[b[p+1]]++,m[b[p+2]]++;c.rvals=g;c.gvals=e;c.bvals=m;if(d)for(d=a.canvas.getContext("2d"),g=[g,e,m],e=0;3>e;e++){m=(e+1)*a.height/3;for(c=b=0;256>c;c++)g[e][c]>b&&(b=g[e][c]);b=a.height/3/b;l=a.width/256;0==e?d.fillStyle="rgba(255,0,0,0.5)":1==e?d.fillStyle="rgba(0,255,0,0.5)":2==e&&(d.fillStyle="rgba(0,0,255,0.5)");for(c=0;256>c;c++)d.fillRect(c*l,a.height-b*g[e][c]-a.height+m,l,g[e][c]*b)}return!0}},checkSupport:function(){return Pixastic.Client.hasCanvasImageData()}};
Pixastic.Actions.crop={process:function(a){if(Pixastic.Client.hasCanvas()){var d=a.options.rect,c=d.width,b=d.height,g=d.top,d=d.left;"undefined"!=typeof a.options.left&&(d=parseInt(a.options.left,10));"undefined"!=typeof a.options.top&&(g=parseInt(a.options.top,10));"undefined"!=typeof a.options.height&&(c=parseInt(a.options.width,10));"undefined"!=typeof a.options.height&&(b=parseInt(a.options.height,10));0>d&&(d=0);d>a.width-1&&(d=a.width-1);0>g&&(g=0);g>a.height-1&&(g=a.height-1);1>c&&(c=1);d+
c>a.width&&(c=a.width-d);1>b&&(b=1);g+b>a.height&&(b=a.height-g);var e=document.createElement("canvas");e.width=a.width;e.height=a.height;e.getContext("2d").drawImage(a.canvas,0,0);a.canvas.width=c;a.canvas.height=b;a.canvas.getContext("2d").clearRect(0,0,c,b);a.canvas.getContext("2d").drawImage(e,d,g,c,b,0,0,c,b);a.useData=!1;return!0}},checkSupport:function(){return Pixastic.Client.hasCanvas()}};
Pixastic.Actions.desaturate={process:function(a){var d=!(!a.options.average||"false"==a.options.average);if(Pixastic.Client.hasCanvasImageData()){var c=Pixastic.prepareData(a);a=a.options.rect;a=a.width*a.height;var b=4*a,g,e;if(d)for(;a--;)c[b-=4]=c[g=b+1]=c[e=b+2]=(c[b]+c[g]+c[e])/3;else for(;a--;)c[b-=4]=c[g=b+1]=c[e=b+2]=.3*c[b]+.59*c[g]+.11*c[e];return!0}if(Pixastic.Client.isIE())return a.image.style.filter+=" gray",!0},checkSupport:function(){return Pixastic.Client.hasCanvasImageData()||Pixastic.Client.isIE()}};
Pixastic.Actions.edges={process:function(a){var d=!(!a.options.mono||"false"==a.options.mono),c=!(!a.options.invert||"false"==a.options.invert);if(Pixastic.Client.hasCanvasImageData()){var b=Pixastic.prepareData(a),g=Pixastic.prepareData(a,!0);weight=-8;var e=a.options.rect;a=e.width;var e=e.height,m=4*a,l=e;do{var p=(l-1)*m,t=(1==l?0:l-2)*a*4,q=(l==e?l-1:l)*a*4,u=a;do{var f=p+(4*u-4),k=t+4*(1==u?0:u-2),h=q+4*(u==a?u-1:u),n=(-.125*(g[k-4]+g[k]+g[k+4]+g[f-4]+g[f+4]+g[h-4]+g[h]+g[h+4])+g[f])*weight,
r=(-.125*(g[k-3]+g[k+1]+g[k+5]+g[f-3]+g[f+5]+g[h-3]+g[h+1]+g[h+5])+g[f+1])*weight,k=(-.125*(g[k-2]+g[k+2]+g[k+6]+g[f-2]+g[f+6]+g[h-2]+g[h+2]+g[h+6])+g[f+2])*weight;d?(n=.3*n+.59*r+.11*k||0,c&&(n=255-n),0>n&&(n=0),255<n&&(n=255),n=r=k=n):(c&&(n=255-n,r=255-r,k=255-k),0>n&&(n=0),0>r&&(r=0),0>k&&(k=0),255<n&&(n=255),255<r&&(r=255),255<k&&(k=255));b[f]=n;b[f+1]=r;b[f+2]=k}while(--u)}while(--l);return!0}},checkSupport:function(){return Pixastic.Client.hasCanvasImageData()}};
Pixastic.Actions.edges2={process:function(a){if(Pixastic.Client.hasCanvasImageData()){var d=Pixastic.prepareData(a),c=Pixastic.prepareData(a,!0),b=a.options.rect,g=b.width;a=4*g;for(var e=a+4,b=b.height-1,g=g-1,m=1;m<b;++m){for(var l=e-4,p=l-a,t=l+a,q=-c[p]-c[l]-c[t],u=-c[++p]-c[++l]-c[++t],f=-c[++p]-c[++l]-c[++t],k=c[p+=2],h=c[++p],n=c[++p],r=c[l+=2],v=c[++l],w=c[++l],x=c[t+=2],y=c[++t],z=c[++t],B=-k-r-x,C=-h-v-y,D=-n-w-z,F=1;F<g;++F){var l=e+4,p=l-a,t=l+a,E=127+q-k- -8*r-x,A=127+u-h- -8*v-y,G=127+
f-n- -8*w-z,q=B,u=C,f=D,k=c[p],h=c[++p],n=c[++p],r=c[l],v=c[++l],w=c[++l],x=c[t],y=c[++t],z=c[++t],E=E+(B=-k-r-x),A=A+(C=-h-v-y),G=G+(D=-n-w-z);255<E&&(E=255);255<A&&(A=255);255<G&&(G=255);0>E&&(E=0);0>A&&(A=0);0>G&&(G=0);d[e]=E;d[++e]=A;d[++e]=G;e+=2}e+=8}return!0}},checkSupport:function(){return Pixastic.Client.hasCanvasImageData()}};
Pixastic.Actions.emboss={process:function(a){var d=parseFloat(a.options.strength)||1,c="undefined"!=typeof a.options.greyLevel?parseInt(a.options.greyLevel):180,b=!(!a.options.blend||"false"==a.options.blend),g=0,e=0;switch(a.options.direction||"topleft"){case "topleft":e=g=-1;break;case "top":g=-1;e=0;break;case "topright":g=-1;e=1;break;case "right":g=0;e=1;break;case "bottomright":e=g=1;break;case "bottom":g=1;e=0;break;case "bottomleft":g=1;e=-1;break;case "left":g=0,e=-1}if(Pixastic.Client.hasCanvasImageData()){var m=
Pixastic.prepareData(a),l=Pixastic.prepareData(a,!0),p=a.options.rect;a=p.width;var p=p.height,t=4*a,q=p;do{var u=(q-1)*t,f=g;1>q+f&&(f=0);q+f>p&&(f=0);var f=(q-1+f)*a*4,k=a;do{var h=u+4*(k-1),n=e;1>k+n&&(n=0);k+n>a&&(n=0);var n=f+4*(k-1+n),r=l[h+1]-l[n+1],v=l[h+2]-l[n+2],n=l[h]-l[n],w=0<n?n:-n,x=0<v?v:-v;(0<r?r:-r)>w&&(n=r);x>w&&(n=v);n*=d;b?(r=m[h]+n,v=m[h+1]+n,n=m[h+2]+n,m[h]=255<r?255:0>r?0:r,m[h+1]=255<v?255:0>v?0:v,m[h+2]=255<n?255:0>n?0:n):(n=c-n,0>n?n=0:255<n&&(n=255),m[h]=m[h+1]=m[h+2]=n)}while(--k)}while(--q);
return!0}if(Pixastic.Client.isIE())return a.image.style.filter+=" progid:DXImageTransform.Microsoft.emboss()",!0},checkSupport:function(){return Pixastic.Client.hasCanvasImageData()||Pixastic.Client.isIE()}};
Pixastic.Actions.flip={process:function(a){var d=a.options.rect,c=document.createElement("canvas");c.width=d.width;c.height=d.height;c.getContext("2d").drawImage(a.image,d.left,d.top,d.width,d.height,0,0,d.width,d.height);var b=a.canvas.getContext("2d");b.clearRect(d.left,d.top,d.width,d.height);"horizontal"==a.options.axis?(b.scale(-1,1),b.drawImage(c,-d.left-d.width,d.top,d.width,d.height)):(b.scale(1,-1),b.drawImage(c,d.left,-d.top-d.height,d.width,d.height));a.useData=!1;return!0},checkSupport:function(){return Pixastic.Client.hasCanvas()}};
Pixastic.Actions.fliph={process:function(a){if(Pixastic.Client.hasCanvas()){var d=a.options.rect,c=document.createElement("canvas");c.width=d.width;c.height=d.height;c.getContext("2d").drawImage(a.image,d.left,d.top,d.width,d.height,0,0,d.width,d.height);var b=a.canvas.getContext("2d");b.clearRect(d.left,d.top,d.width,d.height);b.scale(-1,1);b.drawImage(c,-d.left-d.width,d.top,d.width,d.height);a.useData=!1;return!0}if(Pixastic.Client.isIE())return a.image.style.filter+=" fliph",!0},checkSupport:function(){return Pixastic.Client.hasCanvas()||
Pixastic.Client.isIE()}};
Pixastic.Actions.flipv={process:function(a){if(Pixastic.Client.hasCanvas()){var d=a.options.rect,c=document.createElement("canvas");c.width=d.width;c.height=d.height;c.getContext("2d").drawImage(a.image,d.left,d.top,d.width,d.height,0,0,d.width,d.height);var b=a.canvas.getContext("2d");b.clearRect(d.left,d.top,d.width,d.height);b.scale(1,-1);b.drawImage(c,d.left,-d.top-d.height,d.width,d.height);a.useData=!1;return!0}if(Pixastic.Client.isIE())return a.image.style.filter+=" flipv",!0},checkSupport:function(){return Pixastic.Client.hasCanvas()||
Pixastic.Client.isIE()}};
Pixastic.Actions.glow={process:function(a){var d=parseFloat(a.options.amount)||0,c=parseFloat(a.options.radius)||0,d=Math.min(1,Math.max(0,d)),c=Math.min(5,Math.max(0,c));if(Pixastic.Client.hasCanvasImageData()){var b=a.options.rect,g=document.createElement("canvas");g.width=a.width;g.height=a.height;var e=g.getContext("2d");e.drawImage(a.canvas,0,0);var m=Math.round(a.width/2),l=Math.round(a.height/2),p=document.createElement("canvas");p.width=m;p.height=l;for(var c=Math.round(20*c),t=p.getContext("2d"),
q=0;q<c;q++){var u=Math.max(1,Math.round(m-q)),f=Math.max(1,Math.round(l-q));t.clearRect(0,0,m,l);t.drawImage(g,0,0,a.width,a.height,0,0,u,f);e.clearRect(0,0,a.width,a.height);e.drawImage(p,0,0,u,f,0,0,a.width,a.height)}e=Pixastic.prepareData(a);a=Pixastic.prepareData({canvas:g,options:a.options});b=b.width*b.height;g=4*b;m=g+1;for(l=g+2;b--;)255<(e[g-=4]+=d*a[g])&&(e[g]=255),255<(e[m-=4]+=d*a[m])&&(e[m]=255),255<(e[l-=4]+=d*a[l])&&(e[l]=255);return!0}},checkSupport:function(){return Pixastic.Client.hasCanvasImageData()}};
Pixastic.Actions.histogram={process:function(a){var d=!(!a.options.average||"false"==a.options.average),c=!(!a.options.paint||"false"==a.options.paint),b=a.options.color||"rgba(255,255,255,0.5)",g;"object"!=typeof a.options.returnValue&&(a.options.returnValue={values:[]});var e=a.options.returnValue;"array"!=typeof e.values&&(e.values=[]);g=e.values;if(Pixastic.Client.hasCanvasImageData()){var m=Pixastic.prepareData(a);a.useData=!1;for(var l=0;256>l;l++)g[l]=0;var l=a.options.rect,l=l.width*l.height,
p=4*l,t=Math.round;if(d)for(;l--;)g[t((m[p-=4]+m[p+1]+m[p+2])/3)]++;else for(;l--;)g[t(.3*m[p-=4]+.59*m[p+1]+.11*m[p+2])]++;if(c){for(l=d=0;256>l;l++)g[l]>d&&(d=g[l]);d=a.height/d;c=a.width/256;m=a.canvas.getContext("2d");m.fillStyle=b;for(l=0;256>l;l++)m.fillRect(l*c,a.height-d*g[l],c,g[l]*d)}e.values=g;return!0}},checkSupport:function(){return Pixastic.Client.hasCanvasImageData()}};
Pixastic.Actions.hsl={process:function(a){var d=parseInt(a.options.hue,10)||0,c=(parseInt(a.options.saturation,10)||0)/100,b=(parseInt(a.options.lightness,10)||0)/100,g=0>c?1+c:1+2*c,d=d%360/360,e=6*d,m=255*b,l=1+b,p=1-b;if(Pixastic.Client.hasCanvasImageData()){var t=Pixastic.prepareData(a);a=a.options.rect;a=a.width*a.height;for(var q=4*a,u,f;a--;){var k=t[q-=4],h=t[u=q+1],n=t[f=q+2];if(0!=d||0!=c){var r=k;h>r&&(r=h);n>r&&(r=n);var v=k;h<v&&(v=h);n<v&&(v=n);var w=r-v,x=(v+r)/510;if(0<x&&0<w){if(.5>=
x){var y=w/(r+v)*g;1<y&&(y=1);y=x*(1+y)}else y=w/(510-r-v)*g,1<y&&(y=1),y=x+y-x*y;r=k==r?h==v?5+(r-n)/w+e:1-(r-h)/w+e:h==r?n==v?1+(r-k)/w+e:3-(r-n)/w+e:k==v?3+(r-h)/w+e:5-(r-k)/w+e;0>r&&(r+=6);6<=r&&(r-=6);x=x+x-y;v=r>>0;0==v?(k=255*y,h=255*(x+(y-x)*(r-v)),n=255*x):1==v?(k=255*(y-(y-x)*(r-v)),h=255*y,n=255*x):2==v?(k=255*x,h=255*y,n=255*(x+(y-x)*(r-v))):3==v?(k=255*x,h=255*(y-(y-x)*(r-v)),n=255*y):4==v?(k=255*(x+(y-x)*(r-v)),h=255*x,n=255*y):5==v&&(k=255*y,h=255*x,n=255*(y-(y-x)*(r-v)))}}0>b?(k*=
l,h*=l,n*=l):0<b&&(k=k*p+m,h=h*p+m,n=n*p+m);t[q]=0>k?0:255<k?255:k;t[u]=0>h?0:255<h?255:h;t[f]=0>n?0:255<n?255:n}return!0}},checkSupport:function(){return Pixastic.Client.hasCanvasImageData()}};
Pixastic.Actions.invert={process:function(a){if(Pixastic.Client.hasCanvasImageData()){var d=Pixastic.prepareData(a),c=!!a.options.invertAlpha;a=a.options.rect;a=a.width*a.height;for(var b=4*a,g=b+1,e=b+2,m=b+3;a--;)d[b-=4]=255-d[b],d[g-=4]=255-d[g],d[e-=4]=255-d[e],c&&(d[m-=4]=255-d[m]);return!0}if(Pixastic.Client.isIE())return a.image.style.filter+=" invert",!0},checkSupport:function(){return Pixastic.Client.hasCanvasImageData()||Pixastic.Client.isIE()}};
Pixastic.Actions.laplace={process:function(a){var d=!(!a.options.invert||"false"==a.options.invert),c=parseFloat(a.options.edgeStrength)||0,b=parseInt(a.options.greyLevel)||0,c=-c;if(Pixastic.Client.hasCanvasImageData()){var g=Pixastic.prepareData(a),e=Pixastic.prepareData(a,!0),m=a.options.rect;a=m.width;var m=m.height,l=4*a,p=m;do{var t=(p-1)*l,q=(1==p?0:p-2)*a*4,u=(p==m?p-1:p)*a*4,f=a;do{var k=t+(4*f-4),h=q+4*(1==f?0:f-2),n=u+4*(f==a?f-1:f),h=(.125*(-e[h-4]-e[h]-e[h+4]-e[k-4]-e[k+4]-e[n-4]-e[n]-
e[n+4]+8*e[k])+.125*(-e[h-3]-e[h+1]-e[h+5]-e[k-3]-e[k+5]-e[n-3]-e[n+1]-e[n+5]+8*e[k+1])+.125*(-e[h-2]-e[h+2]-e[h+6]-e[k-2]-e[k+6]-e[n-2]-e[n+2]-e[n+6]+8*e[k+2]))/3+b;0!=c&&(127<h?h+=(h+1-128)*c:127>h&&(h-=(h+1)*c));d&&(h=255-h);0>h&&(h=0);255<h&&(h=255);g[k]=g[k+1]=g[k+2]=h}while(--f)}while(--p);return!0}},checkSupport:function(){return Pixastic.Client.hasCanvasImageData()}};
Pixastic.Actions.lighten={process:function(a){var d=parseFloat(a.options.amount)||0,d=Math.max(-1,Math.min(1,d));if(Pixastic.Client.hasCanvasImageData()){var c=Pixastic.prepareData(a);a=a.options.rect;a=a.width*a.height;for(var b=4*a,g=b+1,e=b+2,d=d+1;a--;)255<(c[b-=4]=c[b]*d)&&(c[b]=255),255<(c[g-=4]=c[g]*d)&&(c[g]=255),255<(c[e-=4]=c[e]*d)&&(c[e]=255);return!0}if(Pixastic.Client.isIE())return c=a.image,0>d?(c.style.filter+=" light()",c.filters[c.filters.length-1].addAmbient(255,255,255,100*-d)):
0<d&&(c.style.filter+=" light()",c.filters[c.filters.length-1].addAmbient(255,255,255,100),c.filters[c.filters.length-1].addAmbient(255,255,255,100*d)),!0},checkSupport:function(){return Pixastic.Client.hasCanvasImageData()||Pixastic.Client.isIE()}};
Pixastic.Actions.mosaic={process:function(a){var d=Math.max(1,parseInt(a.options.blockSize,10));if(Pixastic.Client.hasCanvasImageData()){var c=a.options.rect,b=c.width,g=c.height,e,m=a.canvas.getContext("2d");e=document.createElement("canvas");e.width=e.height=1;var l=e.getContext("2d"),p=document.createElement("canvas");p.width=b;p.height=g;p.getContext("2d").drawImage(a.canvas,c.left,c.top,b,g,0,0,b,g);for(e=0;e<g;e+=d)for(var t=0;t<b;t+=d){var q=d,u=d;q+t>b&&(q=b-t);u+e>g&&(u=g-e);l.drawImage(p,
t,e,q,u,0,0,1,1);q=l.getImageData(0,0,1,1).data;m.fillStyle="rgb("+q[0]+","+q[1]+","+q[2]+")";m.fillRect(c.left+t,c.top+e,d,d)}a.useData=!1;return!0}},checkSupport:function(){return Pixastic.Client.hasCanvasImageData()}};
Pixastic.Actions.noise={process:function(a){var d=0,c=0,b=!1;"undefined"!=typeof a.options.amount&&(d=parseFloat(a.options.amount)||0);"undefined"!=typeof a.options.strength&&(c=parseFloat(a.options.strength)||0);"undefined"!=typeof a.options.mono&&(b=!(!a.options.mono||"false"==a.options.mono));var d=Math.max(0,Math.min(1,d)),c=Math.max(0,Math.min(1,c)),c=128*c,g=c/2;if(Pixastic.Client.hasCanvasImageData()){var e=Pixastic.prepareData(a),m=a.options.rect;a=m.width;var l=4*a,m=m.height,p=Math.random;
do{var t=(m-1)*l,q=a;do{var u=t+4*(q-1);if(p()<d){if(b)var f=-g+p()*c,k=e[u]+f,h=e[u+1]+f,f=e[u+2]+f;else k=e[u]-g+p()*c,h=e[u+1]-g+p()*c,f=e[u+2]-g+p()*c;0>k&&(k=0);0>h&&(h=0);0>f&&(f=0);255<k&&(k=255);255<h&&(h=255);255<f&&(f=255);e[u]=k;e[u+1]=h;e[u+2]=f}}while(--q)}while(--m);return!0}},checkSupport:function(){return Pixastic.Client.hasCanvasImageData()}};
Pixastic.Actions.posterize={process:function(a){var d=256;"undefined"!=typeof a.options.levels&&(d=parseInt(a.options.levels,10)||1);if(Pixastic.Client.hasCanvasImageData()){var c=Pixastic.prepareData(a),d=Math.max(2,Math.min(256,d)),b=256/d,d=256/(d-1),g=a.options.rect;a=g.width;var e=4*a,g=g.height;do{var m=(g-1)*e,l=a;do{var p=m+4*(l-1),t=d*(c[p]/b>>0),q=d*(c[p+1]/b>>0),u=d*(c[p+2]/b>>0);255<t&&(t=255);255<q&&(q=255);255<u&&(u=255);c[p]=t;c[p+1]=q;c[p+2]=u}while(--l)}while(--g);return!0}},checkSupport:function(){return Pixastic.Client.hasCanvasImageData()}};
Pixastic.Actions.pointillize={process:function(a){var d=Math.max(1,parseInt(a.options.radius,10)),c=Math.min(5,Math.max(0,parseFloat(a.options.density)||0)),b=Math.max(0,parseFloat(a.options.noise)||0),g=!(!a.options.transparent||"false"==a.options.transparent);if(Pixastic.Client.hasCanvasImageData()){var e=a.options.rect,m=e.width,l=e.height,p=a.canvas.getContext("2d"),t=a.canvas.width,q=a.canvas.height,u=document.createElement("canvas");u.width=u.height=1;var u=u.getContext("2d"),f=document.createElement("canvas");
f.width=m;f.height=l;f.getContext("2d").drawImage(a.canvas,e.left,e.top,m,l,0,0,m,l);var k=2*d;g&&p.clearRect(e.left,e.top,e.width,e.height);for(var g=d*b,h=1/c,c=0;c<l+d;c+=k*h)for(var n=0;n<m+d;n+=k*h){rndX=b?n+(2*Math.random()-1)*g>>0:n;rndY=b?c+(2*Math.random()-1)*g>>0:c;var r=rndX-d,v=rndY-d;0>r&&(r=0);0>v&&(v=0);var w=rndX+e.left,x=rndY+e.top;0>w&&(w=0);w>t&&(w=t);0>x&&(x=0);x>q&&(x=q);var y=k,z=k;y+r>m&&(y=m-r);z+v>l&&(z=l-v);1>y&&(y=1);1>z&&(z=1);u.drawImage(f,r,v,y,z,0,0,1,1);r=u.getImageData(0,
0,1,1).data;p.fillStyle="rgb("+r[0]+","+r[1]+","+r[2]+")";p.beginPath();p.arc(w,x,d,0,2*Math.PI,!0);p.closePath();p.fill()}a.useData=!1;return!0}},checkSupport:function(){return Pixastic.Client.hasCanvasImageData()}};
Pixastic.Actions.removenoise={process:function(a){if(Pixastic.Client.hasCanvasImageData()){var d=Pixastic.prepareData(a),c=a.options.rect;a=c.width;var c=c.height,b=4*a,g=c;do{var e=(g-1)*b,m=(1==g?0:g-2)*a*4,l=(g==c?g-1:g)*a*4,p=a;do{var t=e+(4*p-4),q=m+4*(1==p?0:p-2),u=l+4*(p==a?p-1:p),f,k,h,n,r;f=k=d[q];h=d[t-4];n=d[t+4];r=d[u];h<f&&(f=h);n<f&&(f=n);r<f&&(f=r);h>k&&(k=h);n>k&&(k=n);r>k&&(k=r);h=n=d[q+1];r=d[t-3];var v=d[t+5],w=d[u+1];r<h&&(h=r);v<h&&(h=v);w<h&&(h=w);r>n&&(n=r);v>n&&(n=v);w>n&&
(n=w);q=r=d[q+2];v=d[t-2];w=d[t+6];u=d[u+2];v<q&&(q=v);w<q&&(q=w);u<q&&(q=u);v>r&&(r=v);w>r&&(r=w);u>r&&(r=u);d[t]>k?d[t]=k:d[t]<f&&(d[t]=f);d[t+1]>n?d[t+1]=n:d[t+1]<h&&(d[t+1]=h);d[t+2]>r?d[t+2]=r:d[t+2]<q&&(d[t+2]=q)}while(--p)}while(--g);return!0}},checkSupport:function(){return Pixastic.Client.hasCanvasImageData()}};
Pixastic.Actions.resize={process:function(a){if(Pixastic.Client.hasCanvas()){var d=parseInt(a.options.width,10),c=parseInt(a.options.height,10),b=a.canvas;1>d&&(d=1);2>d&&(d=2);var g=document.createElement("canvas");g.width=d;g.height=c;g.getContext("2d").drawImage(b,0,0,d,c);b.width=d;b.height=c;b.getContext("2d").drawImage(g,0,0);a.useData=!1;return!0}},checkSupport:function(){return Pixastic.Client.hasCanvas()}};
Pixastic.Actions.rotate={process:function(a){if(Pixastic.Client.hasCanvas()){var d=a.canvas,c=a.width,b=a.height,g=document.createElement("canvas");g.width=c;g.height=b;g.getContext("2d").drawImage(d,0,0,c,b);var e=-parseFloat(a.options.angle)*Math.PI/180,m=e;m>.5*Math.PI&&(m=Math.PI-m);m<.5*-Math.PI&&(m=-Math.PI-m);var l=Math.sqrt(c*c+b*b),p=Math.abs(Math.cos(Math.abs(m)-Math.abs(Math.atan2(b,c)))*l),m=Math.abs(Math.sin(Math.abs(m)+Math.abs(Math.atan2(b,c)))*l);d.width=p;d.height=m;d=d.getContext("2d");
d.translate(p/2,m/2);d.rotate(e);d.drawImage(g,-c/2,-b/2);a.useData=!1;return!0}},checkSupport:function(){return Pixastic.Client.hasCanvas()}};
Pixastic.Actions.sepia={process:function(a){var d=parseInt(a.options.mode,10)||0;0>d&&(d=0);1<d&&(d=1);if(Pixastic.Client.hasCanvasImageData()){var c=Pixastic.prepareData(a),b=a.options.rect;a=b.width;var g=4*a,b=b.height;do{var e=(b-1)*g,m=a;do{var l=e+4*(m-1);if(d)var p=.299*c[l]+.587*c[l+1]+.114*c[l+2],t=p+39,q=p+14,p=p-36;else var p=c[l],u=c[l+1],f=c[l+2],t=.393*p+.769*u+.189*f,q=.349*p+.686*u+.168*f,p=.272*p+.534*u+.131*f;0>t&&(t=0);255<t&&(t=255);0>q&&(q=0);255<q&&(q=255);0>p&&(p=0);255<p&&
(p=255);c[l]=t;c[l+1]=q;c[l+2]=p}while(--m)}while(--b);return!0}},checkSupport:function(){return Pixastic.Client.hasCanvasImageData()}};
Pixastic.Actions.sharpen={process:function(a){var d=0;"undefined"!=typeof a.options.amount&&(d=parseFloat(a.options.amount)||0);0>d&&(d=0);1<d&&(d=1);if(Pixastic.Client.hasCanvasImageData()){for(var c=Pixastic.prepareData(a),b=Pixastic.prepareData(a,!0),g=15,d=1+3*d,e=[[0,-d,0],[-d,g,-d],[0,-d,0]],m=0,l=0;3>l;l++)for(var p=0;3>p;p++)m+=e[l][p];m=1/m;e=a.options.rect;a=e.width;e=e.height;g*=m;d*=m;m=4*a;l=e;do{var p=(l-1)*m,t=(1==l?0:l-2)*m,q=(l==e?l-1:l)*m,u=a;do{var f=p+(4*u-4),k=t+4*(1==u?0:u-2),
h=q+4*(u==a?u-1:u),n=(-b[k]-b[f-4]-b[f+4]-b[h])*d+b[f]*g,r=(-b[k+1]-b[f-3]-b[f+5]-b[h+1])*d+b[f+1]*g,k=(-b[k+2]-b[f-2]-b[f+6]-b[h+2])*d+b[f+2]*g;0>n&&(n=0);0>r&&(r=0);0>k&&(k=0);255<n&&(n=255);255<r&&(r=255);255<k&&(k=255);c[f]=n;c[f+1]=r;c[f+2]=k}while(--u)}while(--l);return!0}},checkSupport:function(){return Pixastic.Client.hasCanvasImageData()}};
Pixastic.Actions.solarize={process:function(a){if(Pixastic.Client.hasCanvasImageData()){var d=Pixastic.prepareData(a),c=a.options.rect;a=c.width;var b=4*a,c=c.height;do{var g=(c-1)*b,e=a;do{var m=g+4*(e-1),l=d[m],p=d[m+1],t=d[m+2];127<l&&(l=255-l);127<p&&(p=255-p);127<t&&(t=255-t);d[m]=l;d[m+1]=p;d[m+2]=t}while(--e)}while(--c);return!0}},checkSupport:function(){return Pixastic.Client.hasCanvasImageData()}};
Pixastic.Actions.unsharpmask={process:function(a){var d=parseFloat(a.options.amount)||0,c=parseFloat(a.options.radius)||0,b=parseFloat(a.options.threshold)||0,d=Math.min(500,Math.max(0,d))/2,c=Math.min(5,Math.max(0,c))/10,b=Math.min(255,Math.max(0,b));b--;var g=-b,d=.016*d;d++;if(Pixastic.Client.hasCanvasImageData()){var e=a.options.rect,m=document.createElement("canvas");m.width=a.width;m.height=a.height;var l=m.getContext("2d");l.drawImage(a.canvas,0,0);var p=Math.round(a.width/2),t=Math.round(a.height/
2),q=document.createElement("canvas");q.width=p;q.height=t;for(var c=Math.round(20*c),u=q.getContext("2d"),f=0;f<c;f++){var k=Math.max(1,Math.round(p-f)),h=Math.max(1,Math.round(t-f));u.clearRect(0,0,p,t);u.drawImage(m,0,0,a.width,a.height,0,0,k,h);l.clearRect(0,0,a.width,a.height);l.drawImage(q,0,0,k,h,0,0,a.width,a.height)}l=Pixastic.prepareData(a);a=Pixastic.prepareData({canvas:m,options:a.options});m=e.width;p=4*m;e=e.height;do{t=(e-1)*p;q=m;do{c=t+(4*q-4);u=l[c]-a[c];if(u>b||u<g)f=a[c],f=d*u+
f,l[c]=255<f?255:0>f?0:f;u=l[c+1]-a[c+1];if(u>b||u<g)f=a[c+1],f=d*u+f,l[c+1]=255<f?255:0>f?0:f;u=l[c+2]-a[c+2];if(u>b||u<g)f=a[c+2],f=d*u+f,l[c+2]=255<f?255:0>f?0:f}while(--q)}while(--e);return!0}},checkSupport:function(){return Pixastic.Client.hasCanvasImageData()}};