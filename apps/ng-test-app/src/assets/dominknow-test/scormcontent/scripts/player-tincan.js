 
"0.50.0";
var CryptoJS=CryptoJS||function(e,a){var c={},b=c.lib={},d=function(){},g=b.Base={extend:function(a){d.prototype=this;var c=new d;return a&&c.mixIn(a),c.hasOwnProperty("init")||(c.init=function(){c.$super.init.apply(this,arguments)}),c.init.prototype=c,c.$super=this,c},create:function(){var a=this.extend();return a.init.apply(a,arguments),a},init:function(){},mixIn:function(a){for(var c in a)a.hasOwnProperty(c)&&(this[c]=a[c]);a.hasOwnProperty("toString")&&(this.toString=a.toString)},clone:function(){return this.init.prototype.extend(this)}},f=
b.WordArray=g.extend({init:function(c,b){c=this.words=c||[];this.sigBytes=b!=a?b:4*c.length},toString:function(a){return(a||l).stringify(this)},concat:function(a){var c=this.words,b=a.words,d=this.sigBytes;if(a=a.sigBytes,this.clamp(),d%4)for(var g=0;g<a;g++)c[d+g>>>2]|=(b[g>>>2]>>>24-g%4*8&255)<<24-(d+g)%4*8;else if(65535<b.length)for(g=0;g<a;g+=4)c[d+g>>>2]=b[g>>>2];else c.push.apply(c,b);return this.sigBytes+=a,this},clamp:function(){var a=this.words,c=this.sigBytes;a[c>>>2]&=4294967295<<32-c%
4*8;a.length=e.ceil(c/4)},clone:function(){var a=g.clone.call(this);return a.words=this.words.slice(0),a},random:function(a){for(var c=[],b=0;b<a;b+=4)c.push(4294967296*e.random()|0);return new f.init(c,a)}}),h=c.enc={},l=h.Hex={stringify:function(a){var c=a.words;a=a.sigBytes;for(var b=[],d=0;d<a;d++){var g=c[d>>>2]>>>24-d%4*8&255;b.push((g>>>4).toString(16));b.push((15&g).toString(16))}return b.join("")},parse:function(a){for(var c=a.length,b=[],d=0;d<c;d+=2)b[d>>>3]|=parseInt(a.substr(d,2),16)<<
24-d%8*4;return new f.init(b,c/2)}},m=h.Latin1={stringify:function(a){var c=a.words;a=a.sigBytes;for(var b=[],d=0;d<a;d++)b.push(String.fromCharCode(c[d>>>2]>>>24-d%4*8&255));return b.join("")},parse:function(a){for(var c=a.length,b=[],d=0;d<c;d++)b[d>>>2]|=(255&a.charCodeAt(d))<<24-d%4*8;return new f.init(b,c)}},n=h.Utf8={stringify:function(a){try{return decodeURIComponent(escape(m.stringify(a)))}catch(c){throw Error("Malformed UTF-8 data");}},parse:function(a){return m.parse(unescape(encodeURIComponent(a)))}},
u=b.BufferedBlockAlgorithm=g.extend({reset:function(){this._data=new f.init;this._nDataBytes=0},_append:function(a){"string"==typeof a&&(a=n.parse(a));this._data.concat(a);this._nDataBytes+=a.sigBytes},_process:function(a){var c=this._data,b=c.words,d=c.sigBytes,g=this.blockSize,h=d/(4*g),h=a?e.ceil(h):e.max((0|h)-this._minBufferSize,0);if(a=h*g,d=e.min(4*a,d),a){for(var l=0;l<a;l+=g)this._doProcessBlock(b,l);l=b.splice(0,a);c.sigBytes-=d}return new f.init(l,d)},clone:function(){var a=g.clone.call(this);
return a._data=this._data.clone(),a},_minBufferSize:0});b.Hasher=u.extend({cfg:g.extend(),init:function(a){this.cfg=this.cfg.extend(a);this.reset()},reset:function(){u.reset.call(this);this._doReset()},update:function(a){return this._append(a),this._process(),this},finalize:function(a){return a&&this._append(a),this._doFinalize()},blockSize:16,_createHelper:function(a){return function(c,b){return(new a.init(b)).finalize(c)}},_createHmacHelper:function(a){return function(c,b){return(new r.HMAC.init(a,
b)).finalize(c)}}});var r=c.algo={};return c}(Math);
!function(){var e=CryptoJS,a=e.lib,c=a.WordArray,b=a.Hasher,d=[],a=e.algo.SHA1=b.extend({_doReset:function(){this._hash=new c.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(a,c){for(var b=this._hash.words,e=b[0],m=b[1],n=b[2],u=b[3],r=b[4],v=0;80>v;v++){if(16>v)d[v]=0|a[c+v];else{var k=d[v-3]^d[v-8]^d[v-14]^d[v-16];d[v]=k<<1|k>>>31}k=(e<<5|e>>>27)+r+d[v];k=20>v?k+((m&n|~m&u)+1518500249):40>v?k+((m^n^u)+1859775393):60>v?k+((m&n|m&u|n&u)-1894007588):k+((m^n^
u)-899497514);r=u;u=n;n=m<<30|m>>>2;m=e;e=k}b[0]=b[0]+e|0;b[1]=b[1]+m|0;b[2]=b[2]+n|0;b[3]=b[3]+u|0;b[4]=b[4]+r|0},_doFinalize:function(){var a=this._data,c=a.words,b=8*this._nDataBytes,d=8*a.sigBytes;return c[d>>>5]|=128<<24-d%32,c[(d+64>>>9<<4)+14]=Math.floor(b/4294967296),c[(d+64>>>9<<4)+15]=b,a.sigBytes=4*c.length,this._process(),this._hash},clone:function(){var a=b.clone.call(this);return a._hash=this._hash.clone(),a}});e.SHA1=b._createHelper(a);e.HmacSHA1=b._createHmacHelper(a)}();
CryptoJS=CryptoJS||function(e,a){var c={},b=c.lib={},d=function(){},g=b.Base={extend:function(a){d.prototype=this;var c=new d;return a&&c.mixIn(a),c.hasOwnProperty("init")||(c.init=function(){c.$super.init.apply(this,arguments)}),c.init.prototype=c,c.$super=this,c},create:function(){var a=this.extend();return a.init.apply(a,arguments),a},init:function(){},mixIn:function(a){for(var c in a)a.hasOwnProperty(c)&&(this[c]=a[c]);a.hasOwnProperty("toString")&&(this.toString=a.toString)},clone:function(){return this.init.prototype.extend(this)}},
f=b.WordArray=g.extend({init:function(c,b){c=this.words=c||[];this.sigBytes=b!=a?b:4*c.length},toString:function(a){return(a||l).stringify(this)},concat:function(a){var c=this.words,b=a.words,d=this.sigBytes;if(a=a.sigBytes,this.clamp(),d%4)for(var g=0;g<a;g++)c[d+g>>>2]|=(b[g>>>2]>>>24-g%4*8&255)<<24-(d+g)%4*8;else if(65535<b.length)for(g=0;g<a;g+=4)c[d+g>>>2]=b[g>>>2];else c.push.apply(c,b);return this.sigBytes+=a,this},clamp:function(){var a=this.words,c=this.sigBytes;a[c>>>2]&=4294967295<<32-
c%4*8;a.length=e.ceil(c/4)},clone:function(){var a=g.clone.call(this);return a.words=this.words.slice(0),a},random:function(a){for(var c=[],b=0;b<a;b+=4)c.push(4294967296*e.random()|0);return new f.init(c,a)}}),h=c.enc={},l=h.Hex={stringify:function(a){var c=a.words;a=a.sigBytes;for(var b=[],d=0;d<a;d++){var g=c[d>>>2]>>>24-d%4*8&255;b.push((g>>>4).toString(16));b.push((15&g).toString(16))}return b.join("")},parse:function(a){for(var c=a.length,b=[],d=0;d<c;d+=2)b[d>>>3]|=parseInt(a.substr(d,2),16)<<
24-d%8*4;return new f.init(b,c/2)}},m=h.Latin1={stringify:function(a){var c=a.words;a=a.sigBytes;for(var b=[],d=0;d<a;d++)b.push(String.fromCharCode(c[d>>>2]>>>24-d%4*8&255));return b.join("")},parse:function(a){for(var c=a.length,b=[],d=0;d<c;d++)b[d>>>2]|=(255&a.charCodeAt(d))<<24-d%4*8;return new f.init(b,c)}},n=h.Utf8={stringify:function(a){try{return decodeURIComponent(escape(m.stringify(a)))}catch(c){throw Error("Malformed UTF-8 data");}},parse:function(a){return m.parse(unescape(encodeURIComponent(a)))}},
u=b.BufferedBlockAlgorithm=g.extend({reset:function(){this._data=new f.init;this._nDataBytes=0},_append:function(a){"string"==typeof a&&(a=n.parse(a));this._data.concat(a);this._nDataBytes+=a.sigBytes},_process:function(a){var c=this._data,b=c.words,d=c.sigBytes,g=this.blockSize,h=d/(4*g),h=a?e.ceil(h):e.max((0|h)-this._minBufferSize,0);if(a=h*g,d=e.min(4*a,d),a){for(var l=0;l<a;l+=g)this._doProcessBlock(b,l);l=b.splice(0,a);c.sigBytes-=d}return new f.init(l,d)},clone:function(){var a=g.clone.call(this);
return a._data=this._data.clone(),a},_minBufferSize:0});b.Hasher=u.extend({cfg:g.extend(),init:function(a){this.cfg=this.cfg.extend(a);this.reset()},reset:function(){u.reset.call(this);this._doReset()},update:function(a){return this._append(a),this._process(),this},finalize:function(a){return a&&this._append(a),this._doFinalize()},blockSize:16,_createHelper:function(a){return function(c,b){return(new a.init(b)).finalize(c)}},_createHmacHelper:function(a){return function(c,b){return(new r.HMAC.init(a,
b)).finalize(c)}}});var r=c.algo={};return c}(Math);
!function(e){for(var a=CryptoJS,c=a.lib,b=c.WordArray,d=c.Hasher,c=a.algo,g=[],f=[],h=function(a){return 4294967296*(a-(0|a))|0},l=2,m=0;64>m;){var n;a:{n=l;for(var u=e.sqrt(n),r=2;r<=u;r++)if(!(n%r)){n=!1;break a}n=!0}n&&(8>m&&(g[m]=h(e.pow(l,.5))),f[m]=h(e.pow(l,1/3)),m++);l++}var v=[],c=c.SHA256=d.extend({_doReset:function(){this._hash=new b.init(g.slice(0))},_doProcessBlock:function(a,c){for(var b=this._hash.words,d=b[0],g=b[1],e=b[2],h=b[3],l=b[4],m=b[5],n=b[6],u=b[7],r=0;64>r;r++){if(16>r)v[r]=
0|a[c+r];else{var F=v[r-15],t=v[r-2];v[r]=((F<<25|F>>>7)^(F<<14|F>>>18)^F>>>3)+v[r-7]+((t<<15|t>>>17)^(t<<13|t>>>19)^t>>>10)+v[r-16]}F=u+((l<<26|l>>>6)^(l<<21|l>>>11)^(l<<7|l>>>25))+(l&m^~l&n)+f[r]+v[r];t=((d<<30|d>>>2)^(d<<19|d>>>13)^(d<<10|d>>>22))+(d&g^d&e^g&e);u=n;n=m;m=l;l=h+F|0;h=e;e=g;g=d;d=F+t|0}b[0]=b[0]+d|0;b[1]=b[1]+g|0;b[2]=b[2]+e|0;b[3]=b[3]+h|0;b[4]=b[4]+l|0;b[5]=b[5]+m|0;b[6]=b[6]+n|0;b[7]=b[7]+u|0},_doFinalize:function(){var a=this._data,c=a.words,b=8*this._nDataBytes,d=8*a.sigBytes;
return c[d>>>5]|=128<<24-d%32,c[(d+64>>>9<<4)+14]=e.floor(b/4294967296),c[(d+64>>>9<<4)+15]=b,a.sigBytes=4*c.length,this._process(),this._hash},clone:function(){var a=d.clone.call(this);return a._hash=this._hash.clone(),a}});a.SHA256=d._createHelper(c);a.HmacSHA256=d._createHmacHelper(c)}(Math);
(function(){var e=CryptoJS,a=e.lib.WordArray;e.enc.Base64={stringify:function(a){var b=a.words,d=a.sigBytes,g=this._map;a.clamp();a=[];for(var f=0;f<d;f+=3)for(var e=(b[f>>>2]>>>24-f%4*8&255)<<16|(b[f+1>>>2]>>>24-(f+1)%4*8&255)<<8|b[f+2>>>2]>>>24-(f+2)%4*8&255,l=0;4>l&&f+.75*l<d;l++)a.push(g.charAt(e>>>6*(3-l)&63));if(b=g.charAt(64))for(;a.length%4;)a.push(b);return a.join("")},parse:function(c){var b=c.length,d=this._map,g=d.charAt(64);g&&(g=c.indexOf(g),-1!=g&&(b=g));for(var g=[],e=0,h=0;h<b;h++)if(h%
4){var l=d.indexOf(c.charAt(h-1))<<h%4*2,m=d.indexOf(c.charAt(h))>>>6-h%4*2;g[e>>>2]|=(l|m)<<24-e%4*8;e++}return a.create(g,e)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\x3d"}})();
(function(){if("function"==typeof ArrayBuffer){var e=CryptoJS.lib.WordArray,a=e.init;(e.init=function(c){if(c instanceof ArrayBuffer&&(c=new Uint8Array(c)),(c instanceof Int8Array||c instanceof Uint8ClampedArray||c instanceof Int16Array||c instanceof Uint16Array||c instanceof Int32Array||c instanceof Uint32Array||c instanceof Float32Array||c instanceof Float64Array)&&(c=new Uint8Array(c.buffer,c.byteOffset,c.byteLength)),c instanceof Uint8Array){for(var b=c.byteLength,d=[],g=0;g<b;g++)d[g>>>2]|=c[g]<<
24-g%4*8;a.call(this,d,b)}else a.apply(this,arguments)}).prototype=e}})();var TinCan;
!function(){var e={statementId:!0,voidedStatementId:!0,verb:!0,object:!0,registration:!0,context:!0,actor:!0,since:!0,until:!0,limit:!0,authoritative:!0,sparse:!0,instructor:!0,ascending:!0,continueToken:!0,agent:!0,activityId:!0,stateId:!0,profileId:!0,activity_platform:!0,grouping:!0,"Accept-Language":!0};TinCan=function(a){this.log("constructor");this.recordStores=[];this.context=this.registration=this.activity=this.actor=null;this.init(a)};TinCan.prototype={LOG_SRC:"TinCan",log:function(a,c){},
init:function(a){this.log("init");var c;if(a=a||{},a.hasOwnProperty("url")&&""!==a.url&&this._initFromQueryString(a.url),a.hasOwnProperty("recordStores")&&void 0!==a.recordStores)for(c=0;c<a.recordStores.length;c+=1)this.addRecordStore(a.recordStores[c]);a.hasOwnProperty("activity")&&(a.activity instanceof TinCan.Activity?this.activity=a.activity:this.activity=new TinCan.Activity(a.activity));a.hasOwnProperty("actor")&&(a.actor instanceof TinCan.Agent?this.actor=a.actor:this.actor=new TinCan.Agent(a.actor));
a.hasOwnProperty("context")&&(a.context instanceof TinCan.Context?this.context=a.context:this.context=new TinCan.Context(a.context));a.hasOwnProperty("registration")&&(this.registration=a.registration)},_initFromQueryString:function(a){this.log("_initFromQueryString");var c,b;a=TinCan.Utils.parseURL(a).params;var d=["endpoint","auth"],g={},f=null;if(a.hasOwnProperty("actor")){this.log("_initFromQueryString - found actor: "+a.actor);try{this.actor=TinCan.Agent.fromJSON(a.actor),delete a.actor}catch(h){this.log("_initFromQueryString - failed to set actor: "+
h)}}if(a.hasOwnProperty("activity_id")&&(this.activity=new TinCan.Activity({id:a.activity_id}),delete a.activity_id),(a.hasOwnProperty("activity_platform")||a.hasOwnProperty("registration")||a.hasOwnProperty("grouping"))&&(c={},a.hasOwnProperty("activity_platform")&&(c.platform=a.activity_platform,delete a.activity_platform),a.hasOwnProperty("registration")&&(c.registration=this.registration=a.registration,delete a.registration),a.hasOwnProperty("grouping")&&(c.contextActivities={},c.contextActivities.grouping=
a.grouping,delete a.grouping),this.context=new TinCan.Context(c)),a.hasOwnProperty("endpoint")){for(c=0;c<d.length;c+=1)b=d[c],a.hasOwnProperty(b)&&(g[b]=a[b],delete a[b]);for(c in a)a.hasOwnProperty(c)&&(e.hasOwnProperty(c)?delete a[c]:(f=f||{},f[c]=a[c]));null!==f&&(g.extended=f);g.allowFail=!1;this.addRecordStore(g)}},addRecordStore:function(a){this.log("addRecordStore");a=a instanceof TinCan.LRS?a:new TinCan.LRS(a);this.recordStores.push(a)},prepareStatement:function(a){return this.log("prepareStatement"),
a instanceof TinCan.Statement||(a=new TinCan.Statement(a)),null===a.actor&&null!==this.actor&&(a.actor=this.actor),null===a.target&&null!==this.activity&&(a.target=this.activity),null!==this.context&&(null===a.context?a.context=this.context:(null===a.context.registration&&(a.context.registration=this.context.registration),null===a.context.platform&&(a.context.platform=this.context.platform),null!==this.context.contextActivities&&(null===a.context.contextActivities?a.context.contextActivities=this.context.contextActivities:
(null!==this.context.contextActivities.grouping&&null===a.context.contextActivities.grouping&&(a.context.contextActivities.grouping=this.context.contextActivities.grouping),null!==this.context.contextActivities.parent&&null===a.context.contextActivities.parent&&(a.context.contextActivities.parent=this.context.contextActivities.parent),null!==this.context.contextActivities.other&&null===a.context.contextActivities.other&&(a.context.contextActivities.other=this.context.contextActivities.other))))),
a},sendStatement:function(a,c){this.log("sendStatement");var b,d,g=this,e=this.prepareStatement(a),h=this.recordStores.length,l=[],m=[];if(0<h)for("function"==typeof c&&(d=function(a,b){var d;g.log("sendStatement - callbackWrapper: "+h);1<h?(--h,m.push({err:a,xhr:b})):1===h?(m.push({err:a,xhr:b}),d=[m,e],c.apply(this,d)):g.log("sendStatement - unexpected record store count: "+h)}),b=0;b<h;b+=1)a=this.recordStores[b],l.push(a.saveStatement(e,{callback:d}));else this.log("[warning] sendStatement: No LRSs added yet (statement not sent)"),
"function"==typeof c&&c.apply(this,[null,e]);return{statement:e,results:l}},getStatement:function(a,c,b){this.log("getStatement");var d;return b=b||{},b.params=b.params||{},0<this.recordStores.length?(d=this.recordStores[0],d.retrieveStatement(a,{callback:c,params:b.params})):void this.log("[warning] getStatement: No LRSs added yet (statement not retrieved)")},voidStatement:function(a,c,b){this.log("voidStatement");var d,g,e,h=this,l=this.recordStores.length,m=[],n=[];if(a instanceof TinCan.Statement&&
(a=a.id),"undefined"!=typeof b.actor?d=b.actor:null!==this.actor&&(d=this.actor),g=new TinCan.Statement({actor:d,verb:{id:"http://adlnet.gov/expapi/verbs/voided"},target:{objectType:"StatementRef",id:a}}),0<l)for("function"==typeof c&&(e=function(a,b){var d;h.log("voidStatement - callbackWrapper: "+l);1<l?(--l,n.push({err:a,xhr:b})):1===l?(n.push({err:a,xhr:b}),d=[n,g],c.apply(this,d)):h.log("voidStatement - unexpected record store count: "+l)}),b=0;b<l;b+=1)a=this.recordStores[b],m.push(a.saveStatement(g,
{callback:e}));else this.log("[warning] voidStatement: No LRSs added yet (statement not sent)"),"function"==typeof c&&c.apply(this,[null,g]);return{statement:g,results:m}},getVoidedStatement:function(a,c){this.log("getVoidedStatement");var b;return 0<this.recordStores.length?(b=this.recordStores[0],b.retrieveVoidedStatement(a,{callback:c})):void this.log("[warning] getVoidedStatement: No LRSs added yet (statement not retrieved)")},sendStatements:function(a,c){this.log("sendStatements");var b,d,g=
this,e=[],h=this.recordStores.length,l=[],m=[];if(0===a.length)"function"==typeof c&&c.apply(this,[null,e]);else{for(b=0;b<a.length;b+=1)e.push(this.prepareStatement(a[b]));if(0<h)for("function"==typeof c&&(d=function(a,b){var d;g.log("sendStatements - callbackWrapper: "+h);1<h?(--h,m.push({err:a,xhr:b})):1===h?(m.push({err:a,xhr:b}),d=[m,e],c.apply(this,d)):g.log("sendStatements - unexpected record store count: "+h)}),b=0;b<h;b+=1)a=this.recordStores[b],l.push(a.saveStatements(e,{callback:d}));else this.log("[warning] sendStatements: No LRSs added yet (statements not sent)"),
"function"==typeof c&&c.apply(this,[null,e])}return{statements:e,results:l}},getStatements:function(a){this.log("getStatements");var c,b,d={};return 0<this.recordStores.length?(c=this.recordStores[0],a=a||{},b=a.params||{},a.sendActor&&null!==this.actor&&("0.9"===c.version||"0.95"===c.version?b.actor=this.actor:b.agent=this.actor),a.sendActivity&&null!==this.activity&&("0.9"===c.version||"0.95"===c.version?b.target=this.activity:b.activity=this.activity),"undefined"==typeof b.registration&&null!==
this.registration&&(b.registration=this.registration),d={params:b},"undefined"!=typeof a.callback&&(d.callback=a.callback),c.queryStatements(d)):void this.log("[warning] getStatements: No LRSs added yet (statements not read)")},getState:function(a,c){this.log("getState");var b,d;return 0<this.recordStores.length?(d=this.recordStores[0],c=c||{},b={agent:"undefined"!=typeof c.agent?c.agent:this.actor,activity:"undefined"!=typeof c.activity?c.activity:this.activity},"undefined"!=typeof c.registration?
b.registration=c.registration:null!==this.registration&&(b.registration=this.registration),"undefined"!=typeof c.callback&&(b.callback=c.callback),d.retrieveState(a,b)):void this.log("[warning] getState: No LRSs added yet (state not retrieved)")},setState:function(a,c,b){this.log("setState");var d,g;return 0<this.recordStores.length?(g=this.recordStores[0],b=b||{},d={agent:"undefined"!=typeof b.agent?b.agent:this.actor,activity:"undefined"!=typeof b.activity?b.activity:this.activity},"undefined"!=
typeof b.registration?d.registration=b.registration:null!==this.registration&&(d.registration=this.registration),"undefined"!=typeof b.lastSHA1&&(d.lastSHA1=b.lastSHA1),"undefined"!=typeof b.contentType&&(d.contentType=b.contentType,"undefined"!=typeof b.overwriteJSON&&!b.overwriteJSON&&TinCan.Utils.isApplicationJSON(b.contentType)&&(d.method="POST")),"undefined"!=typeof b.callback&&(d.callback=b.callback),g.saveState(a,c,d)):void this.log("[warning] setState: No LRSs added yet (state not saved)")},
deleteState:function(a,c){this.log("deleteState");var b,d;return 0<this.recordStores.length?(d=this.recordStores[0],c=c||{},b={agent:"undefined"!=typeof c.agent?c.agent:this.actor,activity:"undefined"!=typeof c.activity?c.activity:this.activity},"undefined"!=typeof c.registration?b.registration=c.registration:null!==this.registration&&(b.registration=this.registration),"undefined"!=typeof c.callback&&(b.callback=c.callback),d.dropState(a,b)):void this.log("[warning] deleteState: No LRSs added yet (state not deleted)")},
getActivityProfile:function(a,c){this.log("getActivityProfile");var b,d;return 0<this.recordStores.length?(d=this.recordStores[0],c=c||{},b={activity:"undefined"!=typeof c.activity?c.activity:this.activity},"undefined"!=typeof c.callback&&(b.callback=c.callback),d.retrieveActivityProfile(a,b)):void this.log("[warning] getActivityProfile: No LRSs added yet (activity profile not retrieved)")},setActivityProfile:function(a,c,b){this.log("setActivityProfile");var d,g;return 0<this.recordStores.length?
(g=this.recordStores[0],b=b||{},d={activity:"undefined"!=typeof b.activity?b.activity:this.activity},"undefined"!=typeof b.callback&&(d.callback=b.callback),"undefined"!=typeof b.lastSHA1&&(d.lastSHA1=b.lastSHA1),"undefined"!=typeof b.contentType&&(d.contentType=b.contentType,"undefined"!=typeof b.overwriteJSON&&!b.overwriteJSON&&TinCan.Utils.isApplicationJSON(b.contentType)&&(d.method="POST")),g.saveActivityProfile(a,c,d)):void this.log("[warning] setActivityProfile: No LRSs added yet (activity profile not saved)")},
deleteActivityProfile:function(a,c){this.log("deleteActivityProfile");var b,d;return 0<this.recordStores.length?(d=this.recordStores[0],c=c||{},b={activity:"undefined"!=typeof c.activity?c.activity:this.activity},"undefined"!=typeof c.callback&&(b.callback=c.callback),d.dropActivityProfile(a,b)):void this.log("[warning] deleteActivityProfile: No LRSs added yet (activity profile not deleted)")},getAgentProfile:function(a,c){this.log("getAgentProfile");var b,d;return 0<this.recordStores.length?(d=this.recordStores[0],
c=c||{},b={agent:"undefined"!=typeof c.agent?c.agent:this.actor},"undefined"!=typeof c.callback&&(b.callback=c.callback),d.retrieveAgentProfile(a,b)):void this.log("[warning] getAgentProfile: No LRSs added yet (agent profile not retrieved)")},setAgentProfile:function(a,c,b){this.log("setAgentProfile");var d,g;return 0<this.recordStores.length?(g=this.recordStores[0],b=b||{},d={agent:"undefined"!=typeof b.agent?b.agent:this.actor},"undefined"!=typeof b.callback&&(d.callback=b.callback),"undefined"!=
typeof b.lastSHA1&&(d.lastSHA1=b.lastSHA1),"undefined"!=typeof b.contentType&&(d.contentType=b.contentType,"undefined"!=typeof b.overwriteJSON&&!b.overwriteJSON&&TinCan.Utils.isApplicationJSON(b.contentType)&&(d.method="POST")),g.saveAgentProfile(a,c,d)):void this.log("[warning] setAgentProfile: No LRSs added yet (agent profile not saved)")},deleteAgentProfile:function(a,c){this.log("deleteAgentProfile");var b,d;return 0<this.recordStores.length?(d=this.recordStores[0],c=c||{},b={agent:"undefined"!=
typeof c.agent?c.agent:this.actor},"undefined"!=typeof c.callback&&(b.callback=c.callback),d.dropAgentProfile(a,b)):void this.log("[warning] deleteAgentProfile: No LRSs added yet (agent profile not deleted)")}};TinCan.DEBUG=!1;TinCan.enableDebug=function(){TinCan.DEBUG=!0};TinCan.disableDebug=function(){TinCan.DEBUG=!1};TinCan.versions=function(){return["1.0.2","1.0.1","1.0.0","0.95","0.9"]};"object"==typeof module&&(module.exports=TinCan)}();
(function(){TinCan.Utils={defaultEncoding:"utf8",getUUID:function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var a=16*Math.random()|0;return("x"==e?a:3&a|8).toString(16)})},getISODateString:function(e){function a(a,b){var d;"undefined"!=typeof a&&null!==a||(a=0);"undefined"!=typeof b&&null!==b||(b=2);b=Math.pow(10,b-1);for(d=a.toString();a<b&&1<b;)d="0"+d,b/=10;return d}return e.getUTCFullYear()+"-"+a(e.getUTCMonth()+1)+"-"+a(e.getUTCDate())+"T"+a(e.getUTCHours())+
":"+a(e.getUTCMinutes())+":"+a(e.getUTCSeconds())+"."+a(e.getUTCMilliseconds(),3)+"Z"},convertISO8601DurationToMilliseconds:function(e){var a,c,b,d,g=0<=e.indexOf("-"),f=e.indexOf("T"),h=e.indexOf("H"),l=e.indexOf("M"),m=e.indexOf("S");if(-1===f||-1!==l&&l<f||-1!==e.indexOf("D")||-1!==e.indexOf("Y"))throw Error("ISO 8601 timestamps including years, months and/or days are not currently supported");return-1===h?(h=f,a=0):a=parseInt(e.slice(f+1,h),10),-1===l?(l=f,c=0):c=parseInt(e.slice(h+1,l),10),b=
parseFloat(e.slice(l+1,m)),d=parseInt(1E3*(60*(60*a+c)+b),10),isNaN(d)&&(d=0),g&&(d*=-1),d},convertMillisecondsToISO8601Duration:function(e){var a,c,b,d;e=parseInt(e,10);var g="",f="";return d=Math.round(e/10),0>d&&(g="-",d*=-1),a=parseInt(d/36E4,10),c=parseInt(d%36E4/6E3,10),b=d%36E4%6E3/100,f=g+"PT",0<a&&(f+=a+"H"),0<c&&(f+=c+"M"),f+(b+"S")},getSHA1String:function(e){return CryptoJS.SHA1(e).toString(CryptoJS.enc.Hex)},getSHA256String:function(e){return"[object ArrayBuffer]"===Object.prototype.toString.call(e)&&
(e=CryptoJS.lib.WordArray.create(e)),CryptoJS.SHA256(e).toString(CryptoJS.enc.Hex)},getBase64String:function(e){return CryptoJS.enc.Base64.stringify(CryptoJS.enc.Latin1.parse(e))},getLangDictionaryValue:function(e,a){var c;e=this[e];if("undefined"!=typeof a&&"undefined"!=typeof e[a])return e[a];if("undefined"!=typeof e.und)return e.und;if("undefined"!=typeof e["en-US"])return e["en-US"];for(c in e)if(e.hasOwnProperty(c))return e[c];return""},parseURL:function(e,a){var c,b,d,g="/"===e.charAt(0),f=
["(/[^?#]*)","(\\?[^#]*|)","(#.*|)$"],h=/\+/g,l=/([^&=]+)=?([^&]*)/g;if(a=a||{},g){if("undefined"==typeof a.allowRelative||!a.allowRelative)throw Error("Refusing to parse relative URL without 'allowRelative' option");}else f.unshift("^(https?:)//","(([^:/?#]*)(?::([0-9]+))?)"),-1===e.indexOf("/",8)&&(e+="/");if(c=new RegExp(f.join("")),b=e.match(c),null===b)throw Error("Unable to parse URL regular expression did not match: '"+e+"'");if(g?(d={protocol:null,host:null,hostname:null,port:null,path:null,
pathname:b[1],search:b[2],hash:b[3],params:{}},d.path=d.pathname):(d={protocol:b[1],host:b[2],hostname:b[3],port:b[4],pathname:b[5],search:b[6],hash:b[7],params:{}},d.path=d.protocol+"//"+d.host+d.pathname),""!==d.search)for(;e=l.exec(d.search.substring(1));)d.params[decodeURIComponent(e[1].replace(h," "))]=decodeURIComponent(e[2].replace(h," "));return d},getServerRoot:function(e){e=e.split("/");return e[0]+"//"+e[2]},getContentTypeFromHeader:function(e){return String(e).split(";")[0]},isApplicationJSON:function(e){return 0===
TinCan.Utils.getContentTypeFromHeader(e).toLowerCase().indexOf("application/json")},stringToArrayBuffer:function(){TinCan.prototype.log("stringToArrayBuffer not overloaded - no environment loaded?")},stringFromArrayBuffer:function(){TinCan.prototype.log("stringFromArrayBuffer not overloaded - no environment loaded?")}}})();
(function(){var e=TinCan.LRS=function(a){this.log("constructor");this.auth=this.version=this.endpoint=null;this.allowFail=!0;this.extended=null;this.init(a)};e.prototype={LOG_SRC:"LRS",log:TinCan.prototype.log,init:function(a){this.log("init");var c,b=TinCan.versions(),d=!1;if(a=a||{},a.hasOwnProperty("alertOnRequestFailure")&&this.log("'alertOnRequestFailure' is deprecated (alerts have been removed) no need to set it now"),!a.hasOwnProperty("endpoint")||null===a.endpoint||""===a.endpoint)throw this.log("[error] LRS invalid: no endpoint"),
{code:3,mesg:"LRS invalid: no endpoint"};if(this.endpoint=String(a.endpoint),"/"!==this.endpoint.slice(-1)&&(this.log("adding trailing slash to endpoint"),this.endpoint+="/"),a.hasOwnProperty("allowFail")&&(this.allowFail=a.allowFail),a.hasOwnProperty("auth")?this.auth=a.auth:a.hasOwnProperty("username")&&a.hasOwnProperty("password")&&(this.auth="Basic "+TinCan.Utils.getBase64String(a.username+":"+a.password)),a.hasOwnProperty("extended")&&(this.extended=a.extended),this._initByEnvironment(a),"undefined"!=
typeof a.version){this.log("version: "+a.version);for(c=0;c<b.length;c+=1)if(b[c]===a.version){d=!0;break}if(!d)throw this.log("[error] LRS invalid: version not supported ("+a.version+")"),{code:5,mesg:"LRS invalid: version not supported ("+a.version+")"};this.version=a.version}else this.version=b[0]},_getBoundary:function(){return TinCan.Utils.getUUID().replace(/-/g,"")},_initByEnvironment:function(){this.log("_initByEnvironment not overloaded - no environment loaded?")},_makeRequest:function(){this.log("_makeRequest not overloaded - no environment loaded?")},
_getMultipartRequestData:function(){this.log("_getMultipartRequestData not overloaded - no environment loaded?")},_IEModeConversion:function(){this.log("_IEModeConversion not overloaded - browser environment not loaded.")},_processGetStatementResult:function(a,c){var b,d={};if(!c.attachments)return TinCan.Statement.fromJSON(a.responseText);c=a.getResponseHeader("Content-Type").split("boundary\x3d")[1];a=this._parseMultipart(c,a.response);c=JSON.parse(a[0].body);for(b=1;b<a.length;b+=1)d[a[b].headers["X-Experience-API-Hash"]]=
a[b].body;return this._assignAttachmentContent([c],d),new TinCan.Statement(c)},sendRequest:function(a){this.log("sendRequest");var c,b=this.endpoint+a.url,d={};if(0===a.url.indexOf("http")&&(b=a.url),null!==this.extended)for(c in a.params=a.params||{},this.extended)this.extended.hasOwnProperty(c)&&(a.params.hasOwnProperty(c)||null!==this.extended[c]&&(a.params[c]=this.extended[c]));d.Authorization=this.auth;"0.9"!==this.version&&(d["X-Experience-API-Version"]=this.version);for(c in a.headers)a.headers.hasOwnProperty(c)&&
(d[c]=a.headers[c]);return this._makeRequest(b,d,a)},about:function(a){this.log("about");var c,b,d;if(a=a||{},c={url:"about",method:"GET",params:{}},"undefined"!=typeof a.callback&&(d=function(c,b){var d=b;null===c&&(d=TinCan.About.fromJSON(b.responseText));a.callback(c,d)},c.callback=d),b=this.sendRequest(c),!d)return null===b.err&&(b.xhr=TinCan.About.fromJSON(b.xhr.responseText)),b},saveStatement:function(a,c){this.log("saveStatement");var b,d,g,e={url:"statements",headers:{}},h=[];c=c||{};try{b=
a.asVersion(this.version)}catch(l){return this.allowFail?(this.log("[warning] statement could not be serialized in version ("+this.version+"): "+l),"undefined"!=typeof c.callback?void c.callback(null,null):{err:null,xhr:null}):(this.log("[error] statement could not be serialized in version ("+this.version+"): "+l),"undefined"!=typeof c.callback?void c.callback(l,null):{err:l,xhr:null})}if(b.hasOwnProperty("attachments")&&a.hasAttachmentWithContent()){d=this._getBoundary();e.headers["Content-Type"]=
"multipart/mixed; boundary\x3d"+d;for(g=0;g<a.attachments.length;g+=1)null!==a.attachments[g].content&&h.push(a.attachments[g]);try{e.data=this._getMultipartRequestData(d,b,h)}catch(l){return this.allowFail?(this.log("[warning] multipart request data could not be created (attachments probably not supported): "+l),"undefined"!=typeof c.callback?void c.callback(null,null):{err:null,xhr:null}):(this.log("[error] multipart request data could not be created (attachments probably not supported): "+l),"undefined"!=
typeof c.callback?void c.callback(l,null):{err:l,xhr:null})}}else e.headers["Content-Type"]="application/json",e.data=JSON.stringify(b);return null!==a.id?(e.method="PUT",e.params={statementId:a.id}):e.method="POST","undefined"!=typeof c.callback&&(e.callback=c.callback),this.sendRequest(e)},retrieveStatement:function(a,c){this.log("retrieveStatement");var b,d,g,e=this;return c=c||{},c.params=c.params||{},b={url:"statements",method:"GET",params:{statementId:a}},c.params.attachments&&(b.params.attachments=
!0,b.expectMultipart=!0),"undefined"!=typeof c.callback&&(g=function(a,b){var d=b;null===a&&(d=e._processGetStatementResult(b,c.params));c.callback(a,d)},b.callback=g),d=this.sendRequest(b),g||(d.statement=null,null===d.err&&(d.statement=e._processGetStatementResult(d.xhr,c.params))),d},retrieveVoidedStatement:function(a,c){this.log("retrieveVoidedStatement");var b,d,g,e=this;return c=c||{},c.params=c.params||{},b={url:"statements",method:"GET",params:{}},"0.9"===this.version||"0.95"===this.version?
b.params.statementId=a:(b.params.voidedStatementId=a,c.params.attachments&&(b.params.attachments=!0,b.expectMultipart=!0)),"undefined"!=typeof c.callback&&(g=function(a,b){var d=b;null===a&&(d=e._processGetStatementResult(b,c.params));c.callback(a,d)},b.callback=g),d=this.sendRequest(b),g||(d.statement=null,null===d.err&&(d.statement=e._processGetStatementResult(d.xhr,c.params))),d},saveStatements:function(a,c){this.log("saveStatements");var b,d,g,e={url:"statements",method:"POST",headers:{}},h=[],
l=[];if(c=c||{},0===a.length)return"undefined"!=typeof c.callback?void c.callback(Error("no statements"),null):{err:Error("no statements"),xhr:null};for(d=0;d<a.length;d+=1){try{b=a[d].asVersion(this.version)}catch(m){return this.allowFail?(this.log("[warning] statement could not be serialized in version ("+this.version+"): "+m),"undefined"!=typeof c.callback?void c.callback(null,null):{err:null,xhr:null}):(this.log("[error] statement could not be serialized in version ("+this.version+"): "+m),"undefined"!=
typeof c.callback?void c.callback(m,null):{err:m,xhr:null})}if(a[d].hasAttachmentWithContent())for(g=0;g<a[d].attachments.length;g+=1)null!==a[d].attachments[g].content&&l.push(a[d].attachments[g]);h.push(b)}if(0!==l.length){a=this._getBoundary();e.headers["Content-Type"]="multipart/mixed; boundary\x3d"+a;try{e.data=this._getMultipartRequestData(a,h,l)}catch(m){return this.allowFail?(this.log("[warning] multipart request data could not be created (attachments probably not supported): "+m),"undefined"!=
typeof c.callback?void c.callback(null,null):{err:null,xhr:null}):(this.log("[error] multipart request data could not be created (attachments probably not supported): "+m),"undefined"!=typeof c.callback?void c.callback(m,null):{err:m,xhr:null})}}else e.headers["Content-Type"]="application/json",e.data=JSON.stringify(h);return"undefined"!=typeof c.callback&&(e.callback=c.callback),this.sendRequest(e)},queryStatements:function(a){this.log("queryStatements");var c,b,d,g=this;a=a||{};a.params=a.params||
{};try{c=this._queryStatementsRequestCfg(a),a.params.attachments&&(c.expectMultipart=!0)}catch(e){return this.log("[error] Query statements failed - "+e),"undefined"!=typeof a.callback&&a.callback(e,{}),{err:e,statementsResult:null}}return"undefined"!=typeof a.callback&&(d=function(c,b){var d,e;d=b;var n={};if(null===c)if(a.params.attachments){d=b.getResponseHeader("Content-Type").split("boundary\x3d")[1];d=g._parseMultipart(d,b.response);e=JSON.parse(d[0].body);for(b=1;b<d.length;b+=1)n[d[b].headers["X-Experience-API-Hash"]]=
d[b].body;g._assignAttachmentContent(e.statements,n);d=new TinCan.StatementsResult({statements:e.statements});for(b=0;b<d.statements.length;b+=1)d.statements[b]instanceof TinCan.Statement||(d.statements[b]=new TinCan.Statement(d.statements[b]))}else d=TinCan.StatementsResult.fromJSON(b.responseText);a.callback(c,d)},c.callback=d),b=this.sendRequest(c),b.config=c,d||(b.statementsResult=null,null===b.err&&(b.statementsResult=TinCan.StatementsResult.fromJSON(b.xhr.responseText))),b},_queryStatementsRequestCfg:function(a){this.log("_queryStatementsRequestCfg");
var c,b={},d={url:"statements",method:"GET",params:b},e=["agent","actor","object","instructor"],f=["verb","activity"],h="registration context since until limit authoritative sparse ascending related_activities related_agents format attachments".split(" "),l={verb:!0,registration:!0,since:!0,until:!0,limit:!0,ascending:!0},m={"0.9":{supported:{actor:!0,instructor:!0,target:!0,object:!0,context:!0,authoritative:!0,sparse:!0}},"1.0.0":{supported:{agent:!0,activity:!0,related_activities:!0,related_agents:!0,
format:!0,attachments:!0}}};m[.95]=m[.9];m["1.0.1"]=m["1.0.0"];m["1.0.2"]=m["1.0.0"];a.params.hasOwnProperty("target")&&(a.params.object=a.params.target);for(c in a.params)if(a.params.hasOwnProperty(c)&&"undefined"==typeof l[c]&&"undefined"==typeof m[this.version].supported[c])throw"Unrecognized query parameter configured: "+c;for(c=0;c<e.length;c+=1)"undefined"!=typeof a.params[e[c]]&&(b[e[c]]=JSON.stringify(a.params[e[c]].asVersion(this.version)));for(c=0;c<f.length;c+=1)"undefined"!=typeof a.params[f[c]]&&
("undefined"==typeof a.params[f[c]].id?b[f[c]]=a.params[f[c]]:b[f[c]]=a.params[f[c]].id);for(c=0;c<h.length;c+=1)"undefined"!=typeof a.params[h[c]]&&null!==a.params[h[c]]&&(b[h[c]]=a.params[h[c]]);return d},_assignAttachmentContent:function(a,c){var b,d;for(b=0;b<a.length;b+=1)if(a[b].hasOwnProperty("attachments")&&null!==a[b].attachments)for(d=0;d<a[b].attachments.length;d+=1)c.hasOwnProperty(a[b].attachments[d].sha2)&&(a[b].attachments[d].content=c[a[b].attachments[d].sha2])},_parseMultipart:function(a,
c){var b,d,e,f,h,l,m;a="--"+a;var n=[];b=new Uint8Array(c);b=this.__uint8ToString(b);d=b.indexOf(a+"--");for(e=b.indexOf(a);-1!==e;)f=b.indexOf(a,e+a.length),h=e+a.length+2,l=b.indexOf("\r\n\r\n",e),e=l+2+2,m=f-2,h=this._parseHeaders(this.__uint8ToString(new Uint8Array(c.slice(h,l)))),e=c.slice(e,m),0===n.length&&(e=TinCan.Utils.stringFromArrayBuffer(e)),n.push({headers:h,body:e}),e=f===d?-1:f;return n},__uint8ToString:function(a){var c,b="",d=a.byteLength;for(c=0;c<d;c+=1)b+=String.fromCharCode(a[c]);
return b},_parseHeaders:function(a){var c,b,d={};a=a.split("\n");for(b=0;b<a.length;b+=1)c=a[b].split(":",2),null!==c[1]?d[c[0]]=c[1].replace(/^\s+|\s+$/g,""):"\t"===c[0].substring(0,1)&&(d[c[0]]=c[1].replace(/^\s+|\s+$/g,""));return d},moreStatements:function(a){this.log("moreStatements: "+a.url);var c,b,d,e,f;return a=a||{},e=TinCan.Utils.parseURL(a.url,{allowRelative:!0}),f=TinCan.Utils.getServerRoot(this.endpoint),0===e.path.indexOf("/statements")&&(e.path=this.endpoint.replace(f,"")+e.path,this.log("converting non-standard more URL to "+
e.path)),0!==e.path.indexOf("/")&&(e.path="/"+e.path),c={method:"GET",url:f+e.path,params:e.params},"undefined"!=typeof a.callback&&(d=function(c,b){var d=b;null===c&&(d=TinCan.StatementsResult.fromJSON(b.responseText));a.callback(c,d)},c.callback=d),b=this.sendRequest(c),b.config=c,d||(b.statementsResult=null,null===b.err&&(b.statementsResult=TinCan.StatementsResult.fromJSON(b.xhr.responseText))),b},retrieveState:function(a,c){this.log("retrieveState");var b,d,e,f={},h={},l=this;if(e=c.requestHeaders||
{},f={stateId:a,activityId:c.activity.id},"0.9"===this.version?f.actor=JSON.stringify(c.agent.asVersion(this.version)):f.agent=JSON.stringify(c.agent.asVersion(this.version)),"undefined"!=typeof c.registration&&null!==c.registration&&("0.9"===this.version?f.registrationId=c.registration:f.registration=c.registration),h={url:"activities/state",method:"GET",params:f,ignore404:!0,headers:e},"undefined"!=typeof c.callback&&(d=function(b,d){var e=d;if(null===b)if(404===d.status)e=null;else if(e=new TinCan.State({id:a,
contents:d.responseText}),"undefined"!=typeof d.getResponseHeader&&null!==d.getResponseHeader("ETag")&&""!==d.getResponseHeader("ETag")?e.etag=d.getResponseHeader("ETag"):e.etag='"'+TinCan.Utils.getSHA1String(d.responseText)+'"',"undefined"!=typeof d.contentType?e.contentType=d.contentType:"undefined"!=typeof d.getResponseHeader&&null!==d.getResponseHeader("Content-Type")&&""!==d.getResponseHeader("Content-Type")&&(e.contentType=d.getResponseHeader("Content-Type")),TinCan.Utils.isApplicationJSON(e.contentType))try{e.contents=
JSON.parse(e.contents)}catch(g){l.log("retrieveState - failed to deserialize JSON: "+g)}c.callback(b,e)},h.callback=d),b=this.sendRequest(h),!d&&(b.state=null,null===b.err&&404!==b.xhr.status&&(b.state=new TinCan.State({id:a,contents:b.xhr.responseText}),"undefined"!=typeof b.xhr.getResponseHeader&&null!==b.xhr.getResponseHeader("ETag")&&""!==b.xhr.getResponseHeader("ETag")?b.state.etag=b.xhr.getResponseHeader("ETag"):b.state.etag='"'+TinCan.Utils.getSHA1String(b.xhr.responseText)+'"',"undefined"!=
typeof b.xhr.contentType?b.state.contentType=b.xhr.contentType:"undefined"!=typeof b.xhr.getResponseHeader&&null!==b.xhr.getResponseHeader("Content-Type")&&""!==b.xhr.getResponseHeader("Content-Type")&&(b.state.contentType=b.xhr.getResponseHeader("Content-Type")),TinCan.Utils.isApplicationJSON(b.state.contentType))))try{b.state.contents=JSON.parse(b.state.contents)}catch(m){this.log("retrieveState - failed to deserialize JSON: "+m)}return b},retrieveStateIds:function(a){this.log("retrieveStateIds");
var c,b,d,e;d={};if(a=a||{},b=a.requestHeaders||{},d.activityId=a.activity.id,"0.9"===this.version?d.actor=JSON.stringify(a.agent.asVersion(this.version)):d.agent=JSON.stringify(a.agent.asVersion(this.version)),"undefined"!=typeof a.registration&&null!==a.registration&&("0.9"===this.version?d.registrationId=a.registration:d.registration=a.registration),c={url:"activities/state",method:"GET",params:d,headers:b,ignore404:!0},"undefined"!=typeof a.callback&&(e=function(c,b){var d=b;if(null!==c)return void a.callback(c,
d);if(404===b.status)d=[];else try{d=JSON.parse(b.responseText)}catch(e){c="Response JSON parse error: "+e}a.callback(c,d)},c.callback=e),"undefined"!=typeof a.since&&(c.params.since=a.since),d=this.sendRequest(c),!e){if(d.profileIds=null,null!==d.err)return d;if(404===d.xhr.status)d.profileIds=[];else try{d.profileIds=JSON.parse(d.xhr.responseText)}catch(f){d.err="retrieveStateIds - JSON parse error: "+f}}return d},saveState:function(a,c,b){this.log("saveState");var d,e,f;return f=b.requestHeaders||
{},"undefined"==typeof b.contentType&&(b.contentType="application/octet-stream"),f["Content-Type"]=b.contentType,"object"==typeof c&&TinCan.Utils.isApplicationJSON(b.contentType)&&(c=JSON.stringify(c)),"undefined"!=typeof b.method&&"POST"===b.method||(b.method="PUT"),d={stateId:a,activityId:b.activity.id},"0.9"===this.version?d.actor=JSON.stringify(b.agent.asVersion(this.version)):d.agent=JSON.stringify(b.agent.asVersion(this.version)),"undefined"!=typeof b.registration&&null!==b.registration&&("0.9"===
this.version?d.registrationId=b.registration:d.registration=b.registration),e={url:"activities/state",method:b.method,params:d,data:c,headers:f},"undefined"!=typeof b.callback&&(e.callback=b.callback),"undefined"!=typeof b.lastSHA1&&null!==b.lastSHA1&&(e.headers["If-Match"]=b.lastSHA1),this.sendRequest(e)},dropState:function(a,c){this.log("dropState");var b,d,e;return e=c.requestHeaders||{},b={activityId:c.activity.id},"0.9"===this.version?b.actor=JSON.stringify(c.agent.asVersion(this.version)):b.agent=
JSON.stringify(c.agent.asVersion(this.version)),null!==a&&(b.stateId=a),"undefined"!=typeof c.registration&&null!==c.registration&&("0.9"===this.version?b.registrationId=c.registration:b.registration=c.registration),d={url:"activities/state",method:"DELETE",params:b,headers:e},"undefined"!=typeof c.callback&&(d.callback=c.callback),this.sendRequest(d)},retrieveActivity:function(a,c){this.log("retrieveActivity");var b,d,e,f={};return e=c.requestHeaders||{},f={url:"activities",method:"GET",params:{activityId:a},
ignore404:!0,headers:e},"undefined"!=typeof c.callback&&(d=function(b,d){var e=d;null===b&&(e=404===d.status?new TinCan.Activity({id:a}):TinCan.Activity.fromJSON(d.responseText));c.callback(b,e)},f.callback=d),b=this.sendRequest(f),d||(b.activity=null,null===b.err&&(404===b.xhr.status?b.activity=new TinCan.Activity({id:a}):b.activity=TinCan.Activity.fromJSON(b.xhr.responseText))),b},retrieveActivityProfile:function(a,c){this.log("retrieveActivityProfile");var b,d,e,f={},h=this;if(e=c.requestHeaders||
{},f={url:"activities/profile",method:"GET",params:{profileId:a,activityId:c.activity.id},ignore404:!0,headers:e},"undefined"!=typeof c.callback&&(d=function(b,d){var e=d;if(null===b)if(404===d.status)e=null;else if(e=new TinCan.ActivityProfile({id:a,activity:c.activity,contents:d.responseText}),"undefined"!=typeof d.getResponseHeader&&null!==d.getResponseHeader("ETag")&&""!==d.getResponseHeader("ETag")?e.etag=d.getResponseHeader("ETag"):e.etag='"'+TinCan.Utils.getSHA1String(d.responseText)+'"',"undefined"!=
typeof d.contentType?e.contentType=d.contentType:"undefined"!=typeof d.getResponseHeader&&null!==d.getResponseHeader("Content-Type")&&""!==d.getResponseHeader("Content-Type")&&(e.contentType=d.getResponseHeader("Content-Type")),TinCan.Utils.isApplicationJSON(e.contentType))try{e.contents=JSON.parse(e.contents)}catch(g){h.log("retrieveActivityProfile - failed to deserialize JSON: "+g)}c.callback(b,e)},f.callback=d),b=this.sendRequest(f),!d&&(b.profile=null,null===b.err&&404!==b.xhr.status&&(b.profile=
new TinCan.ActivityProfile({id:a,activity:c.activity,contents:b.xhr.responseText}),"undefined"!=typeof b.xhr.getResponseHeader&&null!==b.xhr.getResponseHeader("ETag")&&""!==b.xhr.getResponseHeader("ETag")?b.profile.etag=b.xhr.getResponseHeader("ETag"):b.profile.etag='"'+TinCan.Utils.getSHA1String(b.xhr.responseText)+'"',"undefined"!=typeof b.xhr.contentType?b.profile.contentType=b.xhr.contentType:"undefined"!=typeof b.xhr.getResponseHeader&&null!==b.xhr.getResponseHeader("Content-Type")&&""!==b.xhr.getResponseHeader("Content-Type")&&
(b.profile.contentType=b.xhr.getResponseHeader("Content-Type")),TinCan.Utils.isApplicationJSON(b.profile.contentType))))try{b.profile.contents=JSON.parse(b.profile.contents)}catch(l){this.log("retrieveActivityProfile - failed to deserialize JSON: "+l)}return b},retrieveActivityProfileIds:function(a){this.log("retrieveActivityProfileIds");var c,b,d,e;if(a=a||{},b=a.requestHeaders||{},c={url:"activities/profile",method:"GET",params:{activityId:a.activity.id},headers:b,ignore404:!0},"undefined"!=typeof a.callback&&
(e=function(c,b){var d=b;if(null!==c)return void a.callback(c,d);if(404===b.status)d=[];else try{d=JSON.parse(b.responseText)}catch(e){c="Response JSON parse error: "+e}a.callback(c,d)},c.callback=e),"undefined"!=typeof a.since&&(c.params.since=a.since),d=this.sendRequest(c),!e){if(d.profileIds=null,null!==d.err)return d;if(404===d.xhr.status)d.profileIds=[];else try{d.profileIds=JSON.parse(d.xhr.responseText)}catch(f){d.err="retrieveActivityProfileIds - JSON parse error: "+f}}return d},saveActivityProfile:function(a,
c,b){this.log("saveActivityProfile");var d,e;return e=b.requestHeaders||{},"undefined"==typeof b.contentType&&(b.contentType="application/octet-stream"),e["Content-Type"]=b.contentType,"undefined"!=typeof b.method&&"POST"===b.method||(b.method="PUT"),"object"==typeof c&&TinCan.Utils.isApplicationJSON(b.contentType)&&(c=JSON.stringify(c)),d={url:"activities/profile",method:b.method,params:{profileId:a,activityId:b.activity.id},data:c,headers:e},"undefined"!=typeof b.callback&&(d.callback=b.callback),
"undefined"!=typeof b.lastSHA1&&null!==b.lastSHA1?d.headers["If-Match"]=b.lastSHA1:d.headers["If-None-Match"]="*",this.sendRequest(d)},dropActivityProfile:function(a,c){this.log("dropActivityProfile");var b,d,e;return e=c.requestHeaders||{},b={profileId:a,activityId:c.activity.id},d={url:"activities/profile",method:"DELETE",params:b,headers:e},"undefined"!=typeof c.callback&&(d.callback=c.callback),this.sendRequest(d)},retrieveAgentProfile:function(a,c){this.log("retrieveAgentProfile");var b,d,e,
f={},h=this;if(e=c.requestHeaders||{},f={method:"GET",params:{profileId:a},ignore404:!0,headers:e},"0.9"===this.version?(f.url="actors/profile",f.params.actor=JSON.stringify(c.agent.asVersion(this.version))):(f.url="agents/profile",f.params.agent=JSON.stringify(c.agent.asVersion(this.version))),"undefined"!=typeof c.callback&&(d=function(b,d){var e=d;if(null===b)if(404===d.status)e=null;else if(e=new TinCan.AgentProfile({id:a,agent:c.agent,contents:d.responseText}),"undefined"!=typeof d.getResponseHeader&&
null!==d.getResponseHeader("ETag")&&""!==d.getResponseHeader("ETag")?e.etag=d.getResponseHeader("ETag"):e.etag='"'+TinCan.Utils.getSHA1String(d.responseText)+'"',"undefined"!=typeof d.contentType?e.contentType=d.contentType:"undefined"!=typeof d.getResponseHeader&&null!==d.getResponseHeader("Content-Type")&&""!==d.getResponseHeader("Content-Type")&&(e.contentType=d.getResponseHeader("Content-Type")),TinCan.Utils.isApplicationJSON(e.contentType))try{e.contents=JSON.parse(e.contents)}catch(g){h.log("retrieveAgentProfile - failed to deserialize JSON: "+
g)}c.callback(b,e)},f.callback=d),b=this.sendRequest(f),!d&&(b.profile=null,null===b.err&&404!==b.xhr.status&&(b.profile=new TinCan.AgentProfile({id:a,agent:c.agent,contents:b.xhr.responseText}),"undefined"!=typeof b.xhr.getResponseHeader&&null!==b.xhr.getResponseHeader("ETag")&&""!==b.xhr.getResponseHeader("ETag")?b.profile.etag=b.xhr.getResponseHeader("ETag"):b.profile.etag='"'+TinCan.Utils.getSHA1String(b.xhr.responseText)+'"',"undefined"!=typeof b.xhr.contentType?b.profile.contentType=b.xhr.contentType:
"undefined"!=typeof b.xhr.getResponseHeader&&null!==b.xhr.getResponseHeader("Content-Type")&&""!==b.xhr.getResponseHeader("Content-Type")&&(b.profile.contentType=b.xhr.getResponseHeader("Content-Type")),TinCan.Utils.isApplicationJSON(b.profile.contentType))))try{b.profile.contents=JSON.parse(b.profile.contents)}catch(l){this.log("retrieveAgentProfile - failed to deserialize JSON: "+l)}return b},retrieveAgentProfileIds:function(a){this.log("retrieveAgentProfileIds");var c,b,d,e;d={};if(a=a||{},b=a.requestHeaders||
{},c={method:"GET",params:d,headers:b,ignore404:!0},"0.9"===this.version?(c.url="actors/profile",d.actor=JSON.stringify(a.agent.asVersion(this.version))):(c.url="agents/profile",d.agent=JSON.stringify(a.agent.asVersion(this.version))),"undefined"!=typeof a.callback&&(e=function(c,b){var d=b;if(null!==c)return void a.callback(c,d);if(404===b.status)d=[];else try{d=JSON.parse(b.responseText)}catch(e){c="Response JSON parse error: "+e}a.callback(c,d)},c.callback=e),"undefined"!=typeof a.since&&(c.params.since=
a.since),d=this.sendRequest(c),!e){if(d.profileIds=null,null!==d.err)return d;if(404===d.xhr.status)d.profileIds=[];else try{d.profileIds=JSON.parse(d.xhr.responseText)}catch(f){d.err="retrieveAgentProfileIds - JSON parse error: "+f}}return d},saveAgentProfile:function(a,c,b){this.log("saveAgentProfile");var d,e;return e=b.requestHeaders||{},"undefined"==typeof b.contentType&&(b.contentType="application/octet-stream"),e["Content-Type"]=b.contentType,"undefined"!=typeof b.method&&"POST"===b.method||
(b.method="PUT"),"object"==typeof c&&TinCan.Utils.isApplicationJSON(b.contentType)&&(c=JSON.stringify(c)),d={method:b.method,params:{profileId:a},data:c,headers:e},"0.9"===this.version?(d.url="actors/profile",d.params.actor=JSON.stringify(b.agent.asVersion(this.version))):(d.url="agents/profile",d.params.agent=JSON.stringify(b.agent.asVersion(this.version))),"undefined"!=typeof b.callback&&(d.callback=b.callback),"undefined"!=typeof b.lastSHA1&&null!==b.lastSHA1?d.headers["If-Match"]=b.lastSHA1:d.headers["If-None-Match"]=
"*",this.sendRequest(d)},dropAgentProfile:function(a,c){this.log("dropAgentProfile");var b,d,e;return e=c.requestHeaders||{},b={profileId:a},d={method:"DELETE",params:b,headers:e},"0.9"===this.version?(d.url="actors/profile",b.actor=JSON.stringify(c.agent.asVersion(this.version))):(d.url="agents/profile",b.agent=JSON.stringify(c.agent.asVersion(this.version))),"undefined"!=typeof c.callback&&(d.callback=c.callback),this.sendRequest(d)}};e.syncEnabled=null})();
(function(){var e=TinCan.AgentAccount=function(a){this.log("constructor");this.name=this.homePage=null;this.init(a)};e.prototype={LOG_SRC:"AgentAccount",log:TinCan.prototype.log,init:function(a){this.log("init");var c,b=["name","homePage"];a=a||{};"undefined"!=typeof a.accountServiceHomePage&&(a.homePage=a.accountServiceHomePage);"undefined"!=typeof a.accountName&&(a.name=a.accountName);for(c=0;c<b.length;c+=1)a.hasOwnProperty(b[c])&&null!==a[b[c]]&&(this[b[c]]=a[b[c]])},toString:function(){this.log("toString");
var a="";return null!==this.name||null!==this.homePage?(a+=null!==this.name?this.name:"-",a+=":",a+=null!==this.homePage?this.homePage:"-"):a="AgentAccount: unidentified",a},asVersion:function(a){this.log("asVersion: "+a);var c={};return a=a||TinCan.versions()[0],"0.9"===a?(c.accountName=this.name,c.accountServiceHomePage=this.homePage):(c.name=this.name,c.homePage=this.homePage),c}};e.fromJSON=function(a){e.prototype.log("fromJSON");a=JSON.parse(a);return new e(a)}})();
(function(){var e=TinCan.Agent=function(a){this.log("constructor");this.account=this.openid=this.mbox_sha1sum=this.mbox=this.name=null;this.degraded=!1;this.init(a)};e.prototype={objectType:"Agent",LOG_SRC:"Agent",log:TinCan.prototype.log,init:function(a){this.log("init");var c,b,d=["name","mbox","mbox_sha1sum","openid"];a=a||{};"undefined"!=typeof a.lastName||"undefined"!=typeof a.firstName?(a.name="","undefined"!=typeof a.firstName&&0<a.firstName.length&&(a.name=a.firstName[0],1<a.firstName.length&&
(this.degraded=!0)),""!==a.name&&(a.name+=" "),"undefined"!=typeof a.lastName&&0<a.lastName.length&&(a.name+=a.lastName[0],1<a.lastName.length&&(this.degraded=!0))):"undefined"==typeof a.familyName&&"undefined"==typeof a.givenName||(a.name="","undefined"!=typeof a.givenName&&0<a.givenName.length&&(a.name=a.givenName[0],1<a.givenName.length&&(this.degraded=!0)),""!==a.name&&(a.name+=" "),"undefined"!=typeof a.familyName&&0<a.familyName.length&&(a.name+=a.familyName[0],1<a.familyName.length&&(this.degraded=
!0)));"object"==typeof a.name&&null!==a.name&&(1<a.name.length&&(this.degraded=!0),a.name=a.name[0]);"object"==typeof a.mbox&&null!==a.mbox&&(1<a.mbox.length&&(this.degraded=!0),a.mbox=a.mbox[0]);"object"==typeof a.mbox_sha1sum&&null!==a.mbox_sha1sum&&(1<a.mbox_sha1sum.length&&(this.degraded=!0),a.mbox_sha1sum=a.mbox_sha1sum[0]);"object"==typeof a.openid&&null!==a.openid&&(1<a.openid.length&&(this.degraded=!0),a.openid=a.openid[0]);"object"==typeof a.account&&null!==a.account&&"undefined"==typeof a.account.homePage&&
"undefined"==typeof a.account.name&&(0===a.account.length?delete a.account:(1<a.account.length&&(this.degraded=!0),a.account=a.account[0]));a.hasOwnProperty("account")&&(a.account instanceof TinCan.AgentAccount?this.account=a.account:this.account=new TinCan.AgentAccount(a.account));for(c=0;c<d.length;c+=1)a.hasOwnProperty(d[c])&&null!==a[d[c]]&&(b=a[d[c]],"mbox"===d[c]&&-1===b.indexOf("mailto:")&&(b="mailto:"+b),this[d[c]]=b)},toString:function(){return this.log("toString"),null!==this.name?this.name:
null!==this.mbox?this.mbox.replace("mailto:",""):null!==this.mbox_sha1sum?this.mbox_sha1sum:null!==this.openid?this.openid:null!==this.account?this.account.toString():this.objectType+": unidentified"},asVersion:function(a){this.log("asVersion: "+a);var c={objectType:this.objectType};return a=a||TinCan.versions()[0],"0.9"===a?(null!==this.mbox?c.mbox=[this.mbox]:null!==this.mbox_sha1sum?c.mbox_sha1sum=[this.mbox_sha1sum]:null!==this.openid?c.openid=[this.openid]:null!==this.account&&(c.account=[this.account.asVersion(a)]),
null!==this.name&&(c.name=[this.name])):(null!==this.mbox?c.mbox=this.mbox:null!==this.mbox_sha1sum?c.mbox_sha1sum=this.mbox_sha1sum:null!==this.openid?c.openid=this.openid:null!==this.account&&(c.account=this.account.asVersion(a)),null!==this.name&&(c.name=this.name)),c}};e.fromJSON=function(a){e.prototype.log("fromJSON");a=JSON.parse(a);return new e(a)}})();
(function(){var e=TinCan.Group=function(a){this.log("constructor");this.account=this.openid=this.mbox_sha1sum=this.mbox=this.name=null;this.member=[];this.init(a)};e.prototype={objectType:"Group",LOG_SRC:"Group",log:TinCan.prototype.log,init:function(a){this.log("init");var c;if(a=a||{},TinCan.Agent.prototype.init.call(this,a),"undefined"!=typeof a.member)for(c=0;c<a.member.length;c+=1)a.member[c]instanceof TinCan.Agent?this.member.push(a.member[c]):this.member.push(new TinCan.Agent(a.member[c]))},
toString:function(a){this.log("toString");a=TinCan.Agent.prototype.toString.call(this,a);return a!==this.objectType+": unidentified"&&(a=this.objectType+": "+a),a},asVersion:function(a){this.log("asVersion: "+a);var c,b;if(a=a||TinCan.versions()[0],c=TinCan.Agent.prototype.asVersion.call(this,a),0<this.member.length)for(c.member=[],b=0;b<this.member.length;b+=1)c.member.push(this.member[b].asVersion(a));return c}};e.fromJSON=function(a){e.prototype.log("fromJSON");a=JSON.parse(a);return new e(a)}})();
(function(){var e={"http://adlnet.gov/expapi/verbs/experienced":"experienced","http://adlnet.gov/expapi/verbs/attended":"attended","http://adlnet.gov/expapi/verbs/attempted":"attempted","http://adlnet.gov/expapi/verbs/completed":"completed","http://adlnet.gov/expapi/verbs/passed":"passed","http://adlnet.gov/expapi/verbs/failed":"failed","http://adlnet.gov/expapi/verbs/answered":"answered","http://adlnet.gov/expapi/verbs/interacted":"interacted","http://adlnet.gov/expapi/verbs/imported":"imported",
"http://adlnet.gov/expapi/verbs/created":"created","http://adlnet.gov/expapi/verbs/shared":"shared","http://adlnet.gov/expapi/verbs/voided":"voided"},a=TinCan.Verb=function(a){this.log("constructor");this.display=this.id=null;this.init(a)};a.prototype={LOG_SRC:"Verb",log:TinCan.prototype.log,init:function(a){this.log("init");var b,d=["id","display"];if("string"==typeof a)for(b in this.id=a,this.display={und:this.id},e){if(e.hasOwnProperty(b)&&e[b]===a){this.id=b;break}}else{a=a||{};for(b=0;b<d.length;b+=
1)a.hasOwnProperty(d[b])&&null!==a[d[b]]&&(this[d[b]]=a[d[b]]);null===this.display&&"undefined"!=typeof e[this.id]&&(this.display={und:e[this.id]})}},toString:function(a){return this.log("toString"),null!==this.display?this.getLangDictionaryValue("display",a):this.id},asVersion:function(a){this.log("asVersion");var b;return a=a||TinCan.versions()[0],"0.9"===a?b=e[this.id]:(b={id:this.id},null!==this.display&&(b.display=this.display)),b},getLangDictionaryValue:TinCan.Utils.getLangDictionaryValue};
a.fromJSON=function(c){a.prototype.log("fromJSON");c=JSON.parse(c);return new a(c)}})();
(function(){var e=TinCan.Result=function(a){this.log("constructor");this.extensions=this.response=this.duration=this.completion=this.success=this.score=null;this.init(a)};e.prototype={LOG_SRC:"Result",log:TinCan.prototype.log,init:function(a){this.log("init");var c,b=["completion","duration","extensions","response","success"];a=a||{};a.hasOwnProperty("score")&&null!==a.score&&(a.score instanceof TinCan.Score?this.score=a.score:this.score=new TinCan.Score(a.score));for(c=0;c<b.length;c+=1)a.hasOwnProperty(b[c])&&
null!==a[b[c]]&&(this[b[c]]=a[b[c]]);"Completed"===this.completion&&(this.completion=!0)},asVersion:function(a){this.log("asVersion");var c,b={},d=["success","duration","response","extensions"],e=["score"];a=a||TinCan.versions()[0];for(c=0;c<d.length;c+=1)null!==this[d[c]]&&(b[d[c]]=this[d[c]]);for(c=0;c<e.length;c+=1)null!==this[e[c]]&&(b[e[c]]=this[e[c]].asVersion(a));return null!==this.completion&&("0.9"===a?this.completion&&(b.completion="Completed"):b.completion=this.completion),b}};e.fromJSON=
function(a){e.prototype.log("fromJSON");a=JSON.parse(a);return new e(a)}})();
(function(){var e=TinCan.Score=function(a){this.log("constructor");this.max=this.min=this.raw=this.scaled=null;this.init(a)};e.prototype={LOG_SRC:"Score",log:TinCan.prototype.log,init:function(a){this.log("init");var c,b=["scaled","raw","min","max"];a=a||{};for(c=0;c<b.length;c+=1)a.hasOwnProperty(b[c])&&null!==a[b[c]]&&(this[b[c]]=a[b[c]])},asVersion:function(a){this.log("asVersion");var c={},b=["scaled","raw","min","max"];a||TinCan.versions();for(a=0;a<b.length;a+=1)null!==this[b[a]]&&(c[b[a]]=
this[b[a]]);return c}};e.fromJSON=function(a){e.prototype.log("fromJSON");a=JSON.parse(a);return new e(a)}})();
(function(){var e=TinCan.InteractionComponent=function(a){this.log("constructor");this.description=this.id=null;this.init(a)};e.prototype={LOG_SRC:"InteractionComponent",log:TinCan.prototype.log,init:function(a){this.log("init");var c,b=["id","description"];a=a||{};for(c=0;c<b.length;c+=1)a.hasOwnProperty(b[c])&&null!==a[b[c]]&&(this[b[c]]=a[b[c]])},asVersion:function(a){this.log("asVersion");var c,b={id:this.id},d=["description"];a||TinCan.versions();for(a=0;a<d.length;a+=1)c=d[a],null!==this[c]&&
(b[c]=this[c]);return b},getLangDictionaryValue:TinCan.Utils.getLangDictionaryValue};e.fromJSON=function(a){e.prototype.log("fromJSON");a=JSON.parse(a);return new e(a)}})();
(function(){var e={"http://adlnet.gov/expapi/activities/course":"course","http://adlnet.gov/expapi/activities/module":"module","http://adlnet.gov/expapi/activities/meeting":"meeting","http://adlnet.gov/expapi/activities/media":"media","http://adlnet.gov/expapi/activities/performance":"performance","http://adlnet.gov/expapi/activities/simulation":"simulation","http://adlnet.gov/expapi/activities/assessment":"assessment","http://adlnet.gov/expapi/activities/interaction":"interaction","http://adlnet.gov/expapi/activities/cmi.interaction":"cmi.interaction",
"http://adlnet.gov/expapi/activities/question":"question","http://adlnet.gov/expapi/activities/objective":"objective","http://adlnet.gov/expapi/activities/link":"link"},a=TinCan.ActivityDefinition=function(a){this.log("constructor");this.steps=this.target=this.source=this.scale=this.choices=this.correctResponsesPattern=this.interactionType=this.extensions=this.moreInfo=this.type=this.description=this.name=null;this.init(a)};a.prototype={LOG_SRC:"ActivityDefinition",log:TinCan.prototype.log,init:function(a){this.log("init");
var b,d,g,f=["name","description","moreInfo","extensions","correctResponsesPattern"],h=[];if(a=a||{},a.hasOwnProperty("type")&&null!==a.type){for(g in e)e.hasOwnProperty(g)&&e[g]===a.type&&(a.type=e[g]);this.type=a.type}if(a.hasOwnProperty("interactionType")&&null!==a.interactionType&&(this.interactionType=a.interactionType,"choice"===a.interactionType||"sequencing"===a.interactionType?h.push("choices"):"likert"===a.interactionType?h.push("scale"):"matching"===a.interactionType?(h.push("source"),
h.push("target")):"performance"===a.interactionType&&h.push("steps"),0<h.length))for(b=0;b<h.length;b+=1)if(g=h[b],a.hasOwnProperty(g)&&null!==a[g])for(this[g]=[],d=0;d<a[g].length;d+=1)a[g][d]instanceof TinCan.InteractionComponent?this[g].push(a[g][d]):this[g].push(new TinCan.InteractionComponent(a[g][d]));for(b=0;b<f.length;b+=1)a.hasOwnProperty(f[b])&&null!==a[f[b]]&&(this[f[b]]=a[f[b]])},toString:function(a){return this.log("toString"),null!==this.name?this.getLangDictionaryValue("name",a):null!==
this.description?this.getLangDictionaryValue("description",a):""},asVersion:function(a){this.log("asVersion");var b,d,g,f={};d=["name","description","interactionType","correctResponsesPattern","extensions"];var h=["choices","scale","source","target","steps"];a=a||TinCan.versions()[0];null!==this.type&&("0.9"===a?f.type=e[this.type]:f.type=this.type);for(b=0;b<d.length;b+=1)g=d[b],null!==this[g]&&(f[g]=this[g]);for(b=0;b<h.length;b+=1)if(g=h[b],null!==this[g])for(f[g]=[],d=0;d<this[g].length;d+=1)f[g].push(this[g][d].asVersion(a));
return 0!==a.indexOf("0.9")&&null!==this.moreInfo&&(f.moreInfo=this.moreInfo),f},getLangDictionaryValue:TinCan.Utils.getLangDictionaryValue};a.fromJSON=function(c){a.prototype.log("fromJSON");c=JSON.parse(c);return new a(c)}})();
(function(){var e=TinCan.Activity=function(a){this.log("constructor");this.objectType="Activity";this.definition=this.id=null;this.init(a)};e.prototype={LOG_SRC:"Activity",log:TinCan.prototype.log,init:function(a){this.log("init");var c,b=["id"];a=a||{};a.hasOwnProperty("definition")&&(a.definition instanceof TinCan.ActivityDefinition?this.definition=a.definition:this.definition=new TinCan.ActivityDefinition(a.definition));for(c=0;c<b.length;c+=1)a.hasOwnProperty(b[c])&&null!==a[b[c]]&&(this[b[c]]=
a[b[c]])},toString:function(a){this.log("toString");var c="";return null!==this.definition&&(c=this.definition.toString(a),""!==c)?c:null!==this.id?this.id:"Activity: unidentified"},asVersion:function(a){this.log("asVersion");var c={id:this.id,objectType:this.objectType};return a=a||TinCan.versions()[0],null!==this.definition&&(c.definition=this.definition.asVersion(a)),c}};e.fromJSON=function(a){e.prototype.log("fromJSON");a=JSON.parse(a);return new e(a)}})();
(function(){var e=TinCan.ContextActivities=function(a){this.log("constructor");this.other=this.grouping=this.parent=this.category=null;this.init(a)};e.prototype={LOG_SRC:"ContextActivities",log:TinCan.prototype.log,init:function(a){this.log("init");var c,b,d,e=["category","parent","grouping","other"];a=a||{};for(c=0;c<e.length;c+=1)if(d=e[c],a.hasOwnProperty(d)&&null!==a[d])if("[object Array]"===Object.prototype.toString.call(a[d]))for(b=0;b<a[d].length;b+=1)this.add(d,a[d][b]);else b=a[d],this.add(d,
b)},add:function(a,c){if("category"===a||"parent"===a||"grouping"===a||"other"===a)return null===this[a]&&(this[a]=[]),c instanceof TinCan.Activity||(c="string"==typeof c?{id:c}:c,c=new TinCan.Activity(c)),this[a].push(c),this[a].length-1},asVersion:function(a){this.log("asVersion");var c,b,d={},e=["parent","grouping","other"];a=a||TinCan.versions()[0];for(c=0;c<e.length;c+=1)if(null!==this[e[c]]&&0<this[e[c]].length)if("0.9"===a||"0.95"===a)1<this[e[c]].length&&this.log("[warning] version does not support multiple values in: "+
e[c]),d[e[c]]=this[e[c]][0].asVersion(a);else for(d[e[c]]=[],b=0;b<this[e[c]].length;b+=1)d[e[c]].push(this[e[c]][b].asVersion(a));if(null!==this.category&&0<this.category.length){if("0.9"===a||"0.95"===a)throw this.log("[error] version does not support the 'category' property: "+a),Error(a+" does not support the 'category' property");d.category=[];for(c=0;c<this.category.length;c+=1)d.category.push(this.category[c].asVersion(a))}return d}};e.fromJSON=function(a){e.prototype.log("fromJSON");a=JSON.parse(a);
return new e(a)}})();
(function(){var e=TinCan.Context=function(a){this.log("constructor");this.extensions=this.statement=this.language=this.platform=this.revision=this.contextActivities=this.team=this.instructor=this.registration=null;this.init(a)};e.prototype={LOG_SRC:"Context",log:TinCan.prototype.log,init:function(a){this.log("init");var c,b,d,e=["registration","revision","platform","language","extensions"],f=["instructor","team"];a=a||{};for(c=0;c<e.length;c+=1)b=e[c],a.hasOwnProperty(b)&&null!==a[b]&&(this[b]=a[b]);
for(c=0;c<f.length;c+=1)b=f[c],a.hasOwnProperty(b)&&null!==a[b]&&(d=a[b],"undefined"!=typeof d.objectType&&"Person"!==d.objectType||(d.objectType="Agent"),"Agent"!==d.objectType||d instanceof TinCan.Agent?"Group"!==d.objectType||d instanceof TinCan.Group||(d=new TinCan.Group(d)):d=new TinCan.Agent(d),this[b]=d);a.hasOwnProperty("contextActivities")&&null!==a.contextActivities&&(a.contextActivities instanceof TinCan.ContextActivities?this.contextActivities=a.contextActivities:this.contextActivities=
new TinCan.ContextActivities(a.contextActivities));a.hasOwnProperty("statement")&&null!==a.statement&&(a.statement instanceof TinCan.StatementRef?this.statement=a.statement:a.statement instanceof TinCan.SubStatement?this.statement=a.statement:"StatementRef"===a.statement.objectType?this.statement=new TinCan.StatementRef(a.statement):"SubStatement"===a.statement.objectType?this.statement=new TinCan.SubStatement(a.statement):this.log("Unable to parse statement.context.statement property."))},asVersion:function(a){this.log("asVersion");
var c,b={},d=["registration","revision","platform","language","extensions"],e=["instructor","team","contextActivities","statement"];if(a=a||TinCan.versions()[0],this.statement instanceof TinCan.SubStatement&&"0.9"!==a&&"0.95"!==a)throw this.log("[error] version does not support SubStatements in the 'statement' property: "+a),Error(a+" does not support SubStatements in the 'statement' property");for(c=0;c<d.length;c+=1)null!==this[d[c]]&&(b[d[c]]=this[d[c]]);for(c=0;c<e.length;c+=1)null!==this[e[c]]&&
(b[e[c]]=this[e[c]].asVersion(a));return b}};e.fromJSON=function(a){e.prototype.log("fromJSON");a=JSON.parse(a);return new e(a)}})();
(function(){var e=TinCan.StatementRef=function(a){this.log("constructor");this.id=null;this.init(a)};e.prototype={objectType:"StatementRef",LOG_SRC:"StatementRef",log:TinCan.prototype.log,init:function(a){this.log("init");var c,b=["id"];a=a||{};for(c=0;c<b.length;c+=1)a.hasOwnProperty(b[c])&&null!==a[b[c]]&&(this[b[c]]=a[b[c]])},toString:function(){return this.log("toString"),this.id},asVersion:function(a){this.log("asVersion");var c={objectType:this.objectType,id:this.id};return"0.9"===a&&(c.objectType=
"Statement"),c}};e.fromJSON=function(a){e.prototype.log("fromJSON");a=JSON.parse(a);return new e(a)}})();
(function(){var e=TinCan.SubStatement=function(a){this.log("constructor");this.timestamp=this.context=this.result=this.target=this.verb=this.actor=null;this.init(a)};e.prototype={objectType:"SubStatement",LOG_SRC:"SubStatement",log:TinCan.prototype.log,init:function(a){this.log("init");var c,b=["timestamp"];a=a||{};a.hasOwnProperty("object")&&(a.target=a.object);a.hasOwnProperty("actor")&&("undefined"!=typeof a.actor.objectType&&"Person"!==a.actor.objectType||(a.actor.objectType="Agent"),"Agent"===
a.actor.objectType?a.actor instanceof TinCan.Agent?this.actor=a.actor:this.actor=new TinCan.Agent(a.actor):"Group"===a.actor.objectType&&(a.actor instanceof TinCan.Group?this.actor=a.actor:this.actor=new TinCan.Group(a.actor)));a.hasOwnProperty("verb")&&(a.verb instanceof TinCan.Verb?this.verb=a.verb:this.verb=new TinCan.Verb(a.verb));a.hasOwnProperty("target")&&(a.target instanceof TinCan.Activity||a.target instanceof TinCan.Agent||a.target instanceof TinCan.Group||a.target instanceof TinCan.SubStatement||
a.target instanceof TinCan.StatementRef?this.target=a.target:("undefined"==typeof a.target.objectType&&(a.target.objectType="Activity"),"Activity"===a.target.objectType?this.target=new TinCan.Activity(a.target):"Agent"===a.target.objectType?this.target=new TinCan.Agent(a.target):"Group"===a.target.objectType?this.target=new TinCan.Group(a.target):"SubStatement"===a.target.objectType?this.target=new TinCan.SubStatement(a.target):"StatementRef"===a.target.objectType?this.target=new TinCan.StatementRef(a.target):
this.log("Unrecognized target type: "+a.target.objectType)));a.hasOwnProperty("result")&&(a.result instanceof TinCan.Result?this.result=a.result:this.result=new TinCan.Result(a.result));a.hasOwnProperty("context")&&(a.context instanceof TinCan.Context?this.context=a.context:this.context=new TinCan.Context(a.context));for(c=0;c<b.length;c+=1)a.hasOwnProperty(b[c])&&null!==a[b[c]]&&(this[b[c]]=a[b[c]])},toString:function(a){return this.log("toString"),(null!==this.actor?this.actor.toString(a):"")+" "+
(null!==this.verb?this.verb.toString(a):"")+" "+(null!==this.target?this.target.toString(a):"")},asVersion:function(a){this.log("asVersion");var c,b,d=["timestamp"],e=["actor","verb","result","context"];c={objectType:this.objectType};a=a||TinCan.versions()[0];for(b=0;b<d.length;b+=1)null!==this[d[b]]&&(c[d[b]]=this[d[b]]);for(b=0;b<e.length;b+=1)null!==this[e[b]]&&(c[e[b]]=this[e[b]].asVersion(a));return null!==this.target&&(c.object=this.target.asVersion(a)),"0.9"===a&&(c.objectType="Statement"),
c}};e.fromJSON=function(a){e.prototype.log("fromJSON");a=JSON.parse(a);return new e(a)}})();
(function(){var e=TinCan.Statement=function(a,c){this.log("constructor");c="number"==typeof c?{storeOriginal:c}:c||{};"undefined"==typeof c.storeOriginal&&(c.storeOriginal=null);"undefined"==typeof c.doStamp&&(c.doStamp=!0);this.version=this.attachments=this.authority=this.stored=this.timestamp=this.context=this.result=this.target=this.verb=this.actor=this.id=null;this.degraded=!1;this.originalJSON=this.inProgress=this.voided=null;this.init(a,c)};e.prototype={LOG_SRC:"Statement",log:TinCan.prototype.log,
init:function(a,c){this.log("init");var b,d="id stored timestamp version inProgress voided".split(" ");if(a=a||{},c.storeOriginal&&(this.originalJSON=JSON.stringify(a,null,c.storeOriginal)),a.hasOwnProperty("object")&&(a.target=a.object),a.hasOwnProperty("actor")&&("undefined"!=typeof a.actor.objectType&&"Person"!==a.actor.objectType||(a.actor.objectType="Agent"),"Agent"===a.actor.objectType?a.actor instanceof TinCan.Agent?this.actor=a.actor:this.actor=new TinCan.Agent(a.actor):"Group"===a.actor.objectType&&
(a.actor instanceof TinCan.Group?this.actor=a.actor:this.actor=new TinCan.Group(a.actor))),a.hasOwnProperty("authority")&&("undefined"!=typeof a.authority.objectType&&"Person"!==a.authority.objectType||(a.authority.objectType="Agent"),"Agent"===a.authority.objectType?a.authority instanceof TinCan.Agent?this.authority=a.authority:this.authority=new TinCan.Agent(a.authority):"Group"===a.authority.objectType&&(a.actor instanceof TinCan.Group?this.authority=a.authority:this.authority=new TinCan.Group(a.authority))),
a.hasOwnProperty("verb")&&(a.verb instanceof TinCan.Verb?this.verb=a.verb:this.verb=new TinCan.Verb(a.verb)),a.hasOwnProperty("target")&&(a.target instanceof TinCan.Activity||a.target instanceof TinCan.Agent||a.target instanceof TinCan.Group||a.target instanceof TinCan.SubStatement||a.target instanceof TinCan.StatementRef?this.target=a.target:("undefined"==typeof a.target.objectType&&(a.target.objectType="Activity"),"Activity"===a.target.objectType?this.target=new TinCan.Activity(a.target):"Agent"===
a.target.objectType?this.target=new TinCan.Agent(a.target):"Group"===a.target.objectType?this.target=new TinCan.Group(a.target):"SubStatement"===a.target.objectType?this.target=new TinCan.SubStatement(a.target):"StatementRef"===a.target.objectType?this.target=new TinCan.StatementRef(a.target):this.log("Unrecognized target type: "+a.target.objectType))),a.hasOwnProperty("result")&&(a.result instanceof TinCan.Result?this.result=a.result:this.result=new TinCan.Result(a.result)),a.hasOwnProperty("context")&&
(a.context instanceof TinCan.Context?this.context=a.context:this.context=new TinCan.Context(a.context)),a.hasOwnProperty("attachments")&&null!==a.attachments)for(this.attachments=[],b=0;b<a.attachments.length;b+=1)a.attachments[b]instanceof TinCan.Attachment?this.attachments.push(a.attachments[b]):this.attachments.push(new TinCan.Attachment(a.attachments[b]));for(b=0;b<d.length;b+=1)a.hasOwnProperty(d[b])&&null!==a[d[b]]&&(this[d[b]]=a[d[b]]);c.doStamp&&this.stamp()},toString:function(a){return this.log("toString"),
(null!==this.actor?this.actor.toString(a):"")+" "+(null!==this.verb?this.verb.toString(a):"")+" "+(null!==this.target?this.target.toString(a):"")},asVersion:function(a){this.log("asVersion");var c,b={},d=["id","timestamp"],e=["actor","verb","result","context","authority"];a=a||TinCan.versions()[0];for(c=0;c<d.length;c+=1)null!==this[d[c]]&&(b[d[c]]=this[d[c]]);for(c=0;c<e.length;c+=1)null!==this[e[c]]&&(b[e[c]]=this[e[c]].asVersion(a));if(null!==this.target&&(b.object=this.target.asVersion(a)),"0.9"!==
a&&"0.95"!==a||null!==this.voided&&(b.voided=this.voided),"0.9"===a&&null!==this.inProgress&&(b.inProgress=this.inProgress),null!==this.attachments&&"0.9"!==a&&"0.95"!==a)for(b.attachments=[],c=0;c<this.attachments.length;c+=1)this.attachments[c]instanceof TinCan.Attachment?b.attachments.push(this.attachments[c].asVersion(a)):b.attachments.push((new TinCan.Attachment(this.attachments[c])).asVersion(a));return b},stamp:function(){this.log("stamp");null===this.id&&(this.id=TinCan.Utils.getUUID());null===
this.timestamp&&(this.timestamp=TinCan.Utils.getISODateString(new Date))},hasAttachmentWithContent:function(){this.log("hasAttachmentWithContent");var a;if(null===this.attachments)return!1;for(a=0;a<this.attachments.length;a+=1)if(null!==this.attachments[a].content)return!0;return!1}};e.fromJSON=function(a){e.prototype.log("fromJSON");a=JSON.parse(a);return new e(a)}})();
(function(){var e=TinCan.StatementsResult=function(a){this.log("constructor");this.more=this.statements=null;this.init(a)};e.prototype={LOG_SRC:"StatementsResult",log:TinCan.prototype.log,init:function(a){this.log("init");a=a||{};a.hasOwnProperty("statements")&&(this.statements=a.statements);a.hasOwnProperty("more")&&(this.more=a.more)}};e.fromJSON=function(a){e.prototype.log("fromJSON");var c,b,d=[];try{c=JSON.parse(a)}catch(g){e.prototype.log("fromJSON - JSON.parse error: "+g)}if(c){for(a=0;a<c.statements.length;a+=
1){try{b=new TinCan.Statement(c.statements[a],4)}catch(g){e.prototype.log("fromJSON - statement instantiation failed: "+g+" ("+JSON.stringify(c.statements[a])+")"),b=new TinCan.Statement({id:c.statements[a].id},4)}d.push(b)}c.statements=d}return new e(c)}})();
(function(){var e=TinCan.State=function(a){this.log("constructor");this.contentType=this.etag=this.contents=this.updated=this.id=null;this.init(a)};e.prototype={LOG_SRC:"State",log:TinCan.prototype.log,init:function(a){this.log("init");var c,b=["id","contents","etag","contentType"];a=a||{};for(c=0;c<b.length;c+=1)a.hasOwnProperty(b[c])&&null!==a[b[c]]&&(this[b[c]]=a[b[c]]);this.updated=!1}};e.fromJSON=function(a){e.prototype.log("fromJSON");a=JSON.parse(a);return new e(a)}})();
(function(){var e=TinCan.ActivityProfile=function(a){this.log("constructor");this.contentType=this.etag=this.contents=this.updated=this.activity=this.id=null;this.init(a)};e.prototype={LOG_SRC:"ActivityProfile",log:TinCan.prototype.log,init:function(a){this.log("init");var c,b=["id","contents","etag","contentType"];a=a||{};a.hasOwnProperty("activity")&&(a.activity instanceof TinCan.Activity?this.activity=a.activity:this.activity=new TinCan.Activity(a.activity));for(c=0;c<b.length;c+=1)a.hasOwnProperty(b[c])&&
null!==a[b[c]]&&(this[b[c]]=a[b[c]]);this.updated=!1}};e.fromJSON=function(a){e.prototype.log("fromJSON");a=JSON.parse(a);return new e(a)}})();
(function(){var e=TinCan.AgentProfile=function(a){this.log("constructor");this.contentType=this.etag=this.contents=this.updated=this.agent=this.id=null;this.init(a)};e.prototype={LOG_SRC:"AgentProfile",log:TinCan.prototype.log,init:function(a){this.log("init");var c,b=["id","contents","etag","contentType"];a=a||{};a.hasOwnProperty("agent")&&(a.agent instanceof TinCan.Agent?this.agent=a.agent:this.agent=new TinCan.Agent(a.agent));for(c=0;c<b.length;c+=1)a.hasOwnProperty(b[c])&&null!==a[b[c]]&&(this[b[c]]=
a[b[c]]);this.updated=!1}};e.fromJSON=function(a){e.prototype.log("fromJSON");a=JSON.parse(a);return new e(a)}})();(function(){var e=TinCan.About=function(a){this.log("constructor");this.version=null;this.init(a)};e.prototype={LOG_SRC:"About",log:TinCan.prototype.log,init:function(a){this.log("init");var c,b=["version"];a=a||{};for(c=0;c<b.length;c+=1)a.hasOwnProperty(b[c])&&null!==a[b[c]]&&(this[b[c]]=a[b[c]])}};e.fromJSON=function(a){e.prototype.log("fromJSON");a=JSON.parse(a);return new e(a)}})();
(function(){var e=TinCan.Attachment=function(a){this.log("constructor");this.content=this.fileUrl=this.description=this.sha2=this.length=this.contentType=this.display=this.usageType=null;this.init(a)};e.prototype={LOG_SRC:"Attachment",log:TinCan.prototype.log,init:function(a){this.log("init");var c,b="contentType length sha2 usageType display description fileUrl".split(" ");a=a||{};for(c=0;c<b.length;c+=1)a.hasOwnProperty(b[c])&&null!==a[b[c]]&&(this[b[c]]=a[b[c]]);a.hasOwnProperty("content")&&null!==
a.content&&("string"==typeof a.content?this.setContentFromString(a.content):this.setContent(a.content))},asVersion:function(a){this.log("asVersion");var c;return a=a||TinCan.versions()[0],"0.9"===a||"0.95"===a?c=null:(c={contentType:this.contentType,display:this.display,length:this.length,sha2:this.sha2,usageType:this.usageType},null!==this.fileUrl&&(c.fileUrl=this.fileUrl),null!==this.description&&(c.description=this.description)),c},getLangDictionaryValue:TinCan.Utils.getLangDictionaryValue,setContent:function(a){this.content=
a;this.length=a.byteLength;this.sha2=TinCan.Utils.getSHA256String(a)},setContentFromString:function(a){a=TinCan.Utils.stringToArrayBuffer(a);this.setContent(a)},getContentAsString:function(){return TinCan.Utils.stringFromArrayBuffer(this.content)}};e.fromJSON=function(a){e.prototype.log("fromJSON");a=JSON.parse(a);return new e(a)};e._defaultEncoding="utf-8"})();
(function(){var e,a,c,b,d,g,f,h,l,m=TinCan.prototype.log;return"undefined"==typeof window?void m("'window' not defined","Environment.Browser"):(window.JSON||(window.JSON={parse:function(a){return eval("("+a+")")},stringify:function(a){var c,b="";if(a instanceof Object){if(a.constructor===Array){for(c=0;c<a.length;c+=1)b+=this.stringify(a[c])+",";return"["+b.substr(0,b.length-1)+"]"}if(a.toString!==Object.prototype.toString)return'"'+a.toString().replace(/"/g,"\\$\x26")+'"';for(c in a)a.hasOwnProperty(c)&&
(b+='"'+c.replace(/"/g,"\\$\x26")+'":'+this.stringify(a[c])+",");return"{"+b.substr(0,b.length-1)+"}"}return"string"==typeof a?'"'+a.replace(/"/g,"\\$\x26")+'"':String(a)}}),Date.now||(Date.now=function(){return+new Date}),Array.prototype.forEach||(Array.prototype.forEach=function(a,c){if(void 0===this||null===this)throw new TypeError;var b=Object(this),d=b.length>>>0;if("function"!=typeof a)throw new TypeError;var e;for(e=0;e<d;e+=1)e in b&&a.call(c,b[e],e,b)}),h=!1,l=!1,"undefined"!=typeof XMLHttpRequest&&
"undefined"!=typeof(new XMLHttpRequest).withCredentials?h=!0:"undefined"!=typeof XDomainRequest&&(h=!0,l=!0),e=function(a,c,b){m("requestComplete: "+b.finished+", xhr.status: "+a.status,"Environment.Browser");var d,e,g;return g="undefined"==typeof a.status?b.fakeStatus:1223===a.status?204:a.status,b.finished?d:(b.finished=!0,e=c.ignore404&&404===g,200<=g&&400>g||e?c.callback?void c.callback(null,a):{err:null,xhr:a}:(d={err:g,xhr:a},0===g?m("[warning] There was a problem communicating with the Learning Record Store. Aborted, offline, or invalid CORS endpoint ("+
g+")","Environment.Browser"):m("[warning] There was a problem communicating with the Learning Record Store. ("+g+" | "+a.responseText+")","Environment.Browser"),c.callback&&c.callback(g,a),d))},a=function(a,c,b,d){for(var e in c)c.hasOwnProperty(e)&&b.push(e+"\x3d"+encodeURIComponent(c[e]));return"undefined"!=typeof d.data&&b.push("content\x3d"+encodeURIComponent(d.data)),c["Content-Type"]="application/x-www-form-urlencoded",a+="?method\x3d"+d.method,d.method="POST",d.params={},0<b.length&&(d.data=
b.join("\x26")),a},c=function(c,b,d){m("sendRequest using XMLHttpRequest","Environment.Browser");var g,k,f,h=this,l=[],y={finished:!1,fakeStatus:null},D="undefined"!=typeof d.callback,K=c;m("sendRequest using XMLHttpRequest - async: "+D,"Environment.Browser");for(k in d.params)d.params.hasOwnProperty(k)&&l.push(k+"\x3d"+encodeURIComponent(d.params[k]));if(0<l.length&&(K+="?"+l.join("\x26")),2048<=K.length){if("undefined"==typeof d.method)return f=Error("method must not be undefined for an IE Mode Request conversion"),
"undefined"!=typeof d.callback&&d.callback(f,null),{err:f,xhr:null};c=a(c,b,l,d)}else c=K;if("undefined"!=typeof XMLHttpRequest)g=new XMLHttpRequest;else if(g=new ActiveXObject("Microsoft.XMLHTTP"),d.expectMultipart)return f=Error("Attachment support not available"),"undefined"!=typeof d.callback&&d.callback(f,null),{err:f,xhr:null};g.open(d.method,c,D);d.expectMultipart&&(g.responseType="arraybuffer");for(k in b)b.hasOwnProperty(k)&&g.setRequestHeader(k,b[k]);c=d.data;D&&(g.onreadystatechange=function(){m("xhr.onreadystatechange - xhr.readyState: "+
g.readyState,"Environment.Browser");4===g.readyState&&e.call(h,g,d,y)});try{g.send(c)}catch(M){m("sendRequest caught send exception: "+M,"Environment.Browser")}return D?g:e.call(this,g,d,y)},b=function(a,c,b){m("sendRequest using XDomainRequest","Environment.Browser");var d,g,h,l=this,C=[],y={finished:!1,fakeStatus:null};if(b.expectMultipart)return h=Error("Attachment support not available"),"undefined"!=typeof b.callback&&b.callback(h,null),{err:h,xhr:null};a+="?method\x3d"+b.method;for(g in b.params)b.params.hasOwnProperty(g)&&
C.push(g+"\x3d"+encodeURIComponent(b.params[g]));for(g in c)c.hasOwnProperty(g)&&C.push(g+"\x3d"+encodeURIComponent(c[g]));"undefined"!=typeof b.data&&C.push("content\x3d"+encodeURIComponent(b.data));c=C.join("\x26");d=new XDomainRequest;d.open("POST",a);b.callback?(d.onload=function(){y.fakeStatus=200;e.call(l,d,b,y)},d.onerror=function(){y.fakeStatus=400;e.call(l,d,b,y)},d.ontimeout=function(){y.fakeStatus=0;e.call(l,d,b,y)}):(d.onload=function(){y.fakeStatus=200},d.onerror=function(){y.fakeStatus=
400},d.ontimeout=function(){y.fakeStatus=0});d.onprogress=function(){};d.timeout=0;try{d.send(c)}catch(D){m("sendRequest caught send exception: "+D,"Environment.Browser")}if(!b.callback){a=1E4+Date.now();for(m("sendRequest - until: "+a+", finished: "+y.finished,"Environment.Browser");Date.now()<a&&null===y.fakeStatus;)f();return e.call(l,d,b,y)}return d},TinCan.LRS.prototype._initByEnvironment=function(d){m("_initByEnvironment","Environment.Browser");var e,g,f;if(d=d||{},this._makeRequest=c,this._IEModeConversion=
a,e=this.endpoint.toLowerCase().match(/([A-Za-z]+:)\/\/([^:\/]+):?(\d+)?(\/.*)?$/),null===e)throw m("[error] LRS invalid: failed to divide URL parts","Environment.Browser"),{code:4,mesg:"LRS invalid: failed to divide URL parts"};if(f=location.port,g=location.protocol.toLowerCase()===e[1],""===f&&(f="http:"===location.protocol.toLowerCase()?"80":"https:"===location.protocol.toLowerCase()?"443":""),!g||location.hostname.toLowerCase()!==e[2]||f!==(null!==e[3]&&"undefined"!=typeof e[3]&&""!==e[3]?e[3]:
"http:"===e[1]?"80":"https:"===e[1]?"443":""))if(h)if(l&&g)this._makeRequest=b;else{if(l&&!g){if(!d.allowFail)throw m("[error] LRS invalid: cross domain request for differing scheme in IE with XDR","Environment.Browser"),{code:2,mesg:"LRS invalid: cross domain request for differing scheme in IE with XDR"};m("[warning] LRS invalid: cross domain request for differing scheme in IE with XDR (allowed to fail)","Environment.Browser")}}else{if(!d.allowFail)throw m("[error] LRS invalid: cross domain requests not supported in this browser",
"Environment.Browser"),{code:1,mesg:"LRS invalid: cross domain requests not supported in this browser"};m("[warning] LRS invalid: cross domain requests not supported in this browser (allowed to fail)","Environment.Browser")}},f=function(){var a=new XMLHttpRequest,b=window.location+"?forcenocache\x3d"+TinCan.Utils.getUUID();a.open("GET",b,!1);a.send(null)},TinCan.LRS.syncEnabled=!0,TinCan.LRS.prototype._getMultipartRequestData=function(a,b,c){var e=[];e.push(d(a,b));for(b=0;b<c.length;b+=1)null!==
c[b].content&&e.push(g(a,c[b].content,c[b].sha2,c[b].contentType));return e.push("\r\n--"+a+"--\r\n"),new Blob(e)},d=function(a,b){return["--"+a,"Content-Type: application/json","",JSON.stringify(b)].join("\r\n")+"\r\n"},g=function(a,b,c,d){var e=[];a=["--"+a,"Content-Type: "+d,"Content-Transfer-Encoding: binary","X-Experience-API-Hash: "+c].join("\r\n");return a+="\r\n\r\n",e.push(a),e.push(b),new Blob(e)},TinCan.Utils.stringToArrayBuffer=function(a,b){var c;return b||(b=TinCan.Utils.defaultEncoding),
c=new TextEncoder(b),c.encode(a).buffer},void(TinCan.Utils.stringFromArrayBuffer=function(a,b){var c;return b||(b=TinCan.Utils.defaultEncoding),c=new TextDecoder(b),c.decode(a)}))})();
(function(e){function a(a){switch(typeof a){case "undefined":return"undefined";case "boolean":return"boolean";case "number":return"number";case "string":return"string";default:return null===a?"null":"object"}}function c(a){return Object.prototype.toString.call(a).replace(/^\[object *|\]$/g,"")}function b(a){return"function"==typeof a}function d(a){if(null===a||a===t)throw TypeError();return Object(a)}function g(a){function b(c){Object.defineProperty(a,c,{get:function(){return a._getter(c)},set:function(b){a._setter(c,
b)},enumerable:!0,configurable:!1})}if(!("TYPED_ARRAY_POLYFILL_NO_ARRAY_ACCESSORS"in e)){if(a.length>T)throw RangeError("Array too large for polyfill");var c;for(c=0;c<a.length;c+=1)b(c)}}function f(a,b){b=32-b;return a<<b>>b}function h(a,b){b=32-b;return a<<b>>>b}function l(a){return[255&a]}function m(a){return f(a[0],8)}function n(a){return[255&a]}function u(a){return h(a[0],8)}function r(a){return a=p(Number(a)),[0>a?0:255<a?255:255&a]}function v(a){return[255&a,a>>8&255]}function k(a){return f(a[1]<<
8|a[0],16)}function q(a){return[255&a,a>>8&255]}function E(a){return h(a[1]<<8|a[0],16)}function C(a){return[255&a,a>>8&255,a>>16&255,a>>24&255]}function y(a){return f(a[3]<<24|a[2]<<16|a[1]<<8|a[0],32)}function D(a){return[255&a,a>>8&255,a>>16&255,a>>24&255]}function K(a){return h(a[3]<<24|a[2]<<16|a[1]<<8|a[0],32)}function M(a,b,c){function d(a){var b=H(a);a-=b;return.5>a?b:.5<a?b+1:b%2?b+1:b}var e,g,f,k=(1<<b-1)-1;a!==a?(g=(1<<b)-1,f=x(2,c-1),e=0):a===1/0||a===-(1/0)?(g=(1<<b)-1,f=0,e=0>a?1:0):
0===a?(f=g=0,e=1/a===-(1/0)?1:0):(e=0>a,a=J(a),a>=x(2,1-k))?(g=z(H(V(a)/N),1023),f=a/x(2,g),1>f&&(--g,f*=2),2<=f&&(g+=1,f/=2),a=x(2,c),f=d(f*a)-a,g+=k,1<=f/a&&(g+=1,f=0),g>2*k&&(g=(1<<b)-1,f=0)):(g=0,f=d(a/x(2,1-k-c)));for(k=[];c;--c)k.push(f%2?1:0),f=H(f/2);for(c=b;c;--c)k.push(g%2?1:0),g=H(g/2);k.push(e?1:0);k.reverse();b=k.join("");for(e=[];b.length;)e.unshift(parseInt(b.substring(0,8),2)),b=b.substring(8);return e}function O(a,b,c){var d,e,g,f,k,L,h,l,q=[];for(d=0;d<a.length;++d)for(g=a[d],e=
8;e;--e)q.push(g%2?1:0),g>>=1;return q.reverse(),f=q.join(""),k=(1<<b-1)-1,L=parseInt(f.substring(0,1),2)?-1:1,h=parseInt(f.substring(1,1+b),2),l=parseInt(f.substring(1+b),2),h===(1<<b)-1?0!==l?NaN:1/0*L:0<h?L*x(2,h-k)*(1+l/x(2,c)):0!==l?L*x(2,-(k-1))*(l/x(2,c)):0>L?-0:0}function Q(a){return O(a,11,52)}function R(a){return M(a,11,52)}function S(a){return O(a,8,23)}function F(a){return M(a,8,23)}var t=void 0,T=1E5,N=Math.LN2,J=Math.abs,H=Math.floor,V=Math.log,G=Math.max,z=Math.min,x=Math.pow,p=Math.round;
!function(){var a=Object.defineProperty,b;try{b=Object.defineProperty({},"x",{})}catch(c){b=!1}a&&b||(Object.defineProperty=function(b,c,d){if(a)try{return a(b,c,d)}catch(e){}if(b!==Object(b))throw TypeError("Object.defineProperty called on non-object");return Object.prototype.__defineGetter__&&"get"in d&&Object.prototype.__defineGetter__.call(b,c,d.get),Object.prototype.__defineSetter__&&"set"in d&&Object.prototype.__defineSetter__.call(b,c,d.set),"value"in d&&(b[c]=d.value),b})}();(function(){function f(a){if(a>>=
0,0>a)throw RangeError("ArrayBuffer size is not a small enough positive integer.");Object.defineProperty(this,"byteLength",{value:a});Object.defineProperty(this,"_bytes",{value:Array(a)});for(var b=0;b<a;b+=1)this._bytes[b]=0}function h(){if(!arguments.length||"object"!=typeof arguments[0])return function(a){if(a>>=0,0>a)throw RangeError("length is not a small enough positive integer.");Object.defineProperty(this,"length",{value:a});Object.defineProperty(this,"byteLength",{value:a*this.BYTES_PER_ELEMENT});
Object.defineProperty(this,"buffer",{value:new f(this.byteLength)});Object.defineProperty(this,"byteOffset",{value:0})}.apply(this,arguments);if(1<=arguments.length&&"object"===a(arguments[0])&&arguments[0]instanceof h)return function(a){if(this.constructor!==a.constructor)throw TypeError();var b=a.length*this.BYTES_PER_ELEMENT;Object.defineProperty(this,"buffer",{value:new f(b)});Object.defineProperty(this,"byteLength",{value:b});Object.defineProperty(this,"byteOffset",{value:0});Object.defineProperty(this,
"length",{value:a.length});for(b=0;b<this.length;b+=1)this._setter(b,a._getter(b))}.apply(this,arguments);if(1<=arguments.length&&"object"===a(arguments[0])&&!(arguments[0]instanceof h)&&!(arguments[0]instanceof f||"ArrayBuffer"===c(arguments[0])))return function(a){var b=a.length*this.BYTES_PER_ELEMENT;Object.defineProperty(this,"buffer",{value:new f(b)});Object.defineProperty(this,"byteLength",{value:b});Object.defineProperty(this,"byteOffset",{value:0});Object.defineProperty(this,"length",{value:a.length});
for(b=0;b<this.length;b+=1)this._setter(b,Number(a[b]))}.apply(this,arguments);if(1<=arguments.length&&"object"===a(arguments[0])&&(arguments[0]instanceof f||"ArrayBuffer"===c(arguments[0])))return function(a,b,c){if(b>>>=0,b>a.byteLength)throw RangeError("byteOffset out of range");if(b%this.BYTES_PER_ELEMENT)throw RangeError("buffer length minus the byteOffset is not a multiple of the element size.");if(c===t){var d=a.byteLength-b;if(d%this.BYTES_PER_ELEMENT)throw RangeError("length of buffer minus byteOffset not a multiple of the element size");
c=d/this.BYTES_PER_ELEMENT}else c>>>=0,d=c*this.BYTES_PER_ELEMENT;if(b+d>a.byteLength)throw RangeError("byteOffset and length reference an area beyond the end of the buffer");Object.defineProperty(this,"buffer",{value:a});Object.defineProperty(this,"byteLength",{value:d});Object.defineProperty(this,"byteOffset",{value:b});Object.defineProperty(this,"length",{value:c})}.apply(this,arguments);throw TypeError();}function p(a,b,c){var d=function(){Object.defineProperty(this,"constructor",{value:d});h.apply(this,
arguments);g(this)};"__proto__"in d?d.__proto__=h:(d.from=h.from,d.of=h.of);d.BYTES_PER_ELEMENT=a;var e=function(){};return e.prototype=A,d.prototype=new e,Object.defineProperty(d.prototype,"BYTES_PER_ELEMENT",{value:a}),Object.defineProperty(d.prototype,"_pack",{value:b}),Object.defineProperty(d.prototype,"_unpack",{value:c}),d}e.ArrayBuffer=e.ArrayBuffer||f;Object.defineProperty(h,"from",{value:function(a){return new this(a)}});Object.defineProperty(h,"of",{value:function(){return new this(arguments)}});
var A={};h.prototype=A;Object.defineProperty(h.prototype,"_getter",{value:function(a){if(1>arguments.length)throw SyntaxError("Not enough arguments");if(a>>>=0,a>=this.length)return t;var b,c,d=[];b=0;for(c=this.byteOffset+a*this.BYTES_PER_ELEMENT;b<this.BYTES_PER_ELEMENT;b+=1,c+=1)d.push(this.buffer._bytes[c]);return this._unpack(d)}});Object.defineProperty(h.prototype,"get",{value:h.prototype._getter});Object.defineProperty(h.prototype,"_setter",{value:function(a,b){if(2>arguments.length)throw SyntaxError("Not enough arguments");
if(a>>>=0,!(a>=this.length)){var c,d,e=this._pack(b);c=0;for(d=this.byteOffset+a*this.BYTES_PER_ELEMENT;c<this.BYTES_PER_ELEMENT;c+=1,d+=1)this.buffer._bytes[d]=e[c]}}});Object.defineProperty(h.prototype,"constructor",{value:h});Object.defineProperty(h.prototype,"copyWithin",{value:function(a,b,c){var e=d(this),g=e.length>>>0,g=G(g,0);a>>=0;a=0>a?G(g+a,0):z(a,g);b>>=0;b=0>b?G(g+b,0):z(b,g);c=c===t?g:c>>0;c=0>c?G(g+c,0):z(c,g);var f,g=z(c-b,g-a);for(b<a&&a<b+g?(f=-1,b=b+g-1,a=a+g-1):f=1;0<g;)e._setter(a,
e._getter(b)),b+=f,a+=f,--g;return e}});Object.defineProperty(h.prototype,"every",{value:function(a,c){if(this===t||null===this)throw TypeError();var d=Object(this),e=d.length>>>0;if(!b(a))throw TypeError();for(var g=0;g<e;g++)if(!a.call(c,d._getter(g),g,d))return!1;return!0}});Object.defineProperty(h.prototype,"fill",{value:function(a,b,c){var e=d(this),g=e.length>>>0,g=G(g,0);b>>=0;b=0>b?G(g+b,0):z(b,g);c=c===t?g:c>>0;for(g=0>c?G(g+c,0):z(c,g);b<g;)e._setter(b,a),b+=1;return e}});Object.defineProperty(h.prototype,
"filter",{value:function(a,c){if(this===t||null===this)throw TypeError();var d=Object(this),e=d.length>>>0;if(!b(a))throw TypeError();for(var g=[],f=0;f<e;f++){var k=d._getter(f);a.call(c,k,f,d)&&g.push(k)}return new this.constructor(g)}});Object.defineProperty(h.prototype,"find",{value:function(a){var c=d(this),e=c.length>>>0;if(!b(a))throw TypeError();for(var g=1<arguments.length?arguments[1]:t,f=0;f<e;){var k=c._getter(f);if(a.call(g,k,f,c))return k;++f}return t}});Object.defineProperty(h.prototype,
"findIndex",{value:function(a){var c=d(this),e=c.length>>>0;if(!b(a))throw TypeError();for(var g=1<arguments.length?arguments[1]:t,f=0;f<e;){var k=c._getter(f);if(a.call(g,k,f,c))return f;++f}return-1}});Object.defineProperty(h.prototype,"forEach",{value:function(a,c){if(this===t||null===this)throw TypeError();var d=Object(this),e=d.length>>>0;if(!b(a))throw TypeError();for(var g=0;g<e;g++)a.call(c,d._getter(g),g,d)}});Object.defineProperty(h.prototype,"indexOf",{value:function(a){if(this===t||null===
this)throw TypeError();var b=Object(this),c=b.length>>>0;if(0===c)return-1;var d=0;if(0<arguments.length&&(d=Number(arguments[1]),d!==d?d=0:0!==d&&d!==1/0&&d!==-(1/0)&&(d=(0<d||-1)*H(J(d)))),d>=c)return-1;for(d=0<=d?d:G(c-J(d),0);d<c;d++)if(b._getter(d)===a)return d;return-1}});Object.defineProperty(h.prototype,"join",{value:function(a){if(this===t||null===this)throw TypeError();for(var b=Object(this),c=b.length>>>0,d=Array(c),e=0;e<c;++e)d[e]=b._getter(e);return d.join(a===t?",":a)}});Object.defineProperty(h.prototype,
"lastIndexOf",{value:function(a){if(this===t||null===this)throw TypeError();var b=Object(this),c=b.length>>>0;if(0===c)return-1;var d=c;1<arguments.length&&(d=Number(arguments[1]),d!==d?d=0:0!==d&&d!==1/0&&d!==-(1/0)&&(d=(0<d||-1)*H(J(d))));for(c=0<=d?z(d,c-1):c-J(d);0<=c;c--)if(b._getter(c)===a)return c;return-1}});Object.defineProperty(h.prototype,"map",{value:function(a,c){if(this===t||null===this)throw TypeError();var d=Object(this),e=d.length>>>0;if(!b(a))throw TypeError();var g=[];g.length=
e;for(var f=0;f<e;f++)g[f]=a.call(c,d._getter(f),f,d);return new this.constructor(g)}});Object.defineProperty(h.prototype,"reduce",{value:function(a){if(this===t||null===this)throw TypeError();var c=Object(this),d=c.length>>>0;if(!b(a))throw TypeError();if(0===d&&1===arguments.length)throw TypeError();var e,g=0;for(e=2<=arguments.length?arguments[1]:c._getter(g++);g<d;)e=a.call(t,e,c._getter(g),g,c),g++;return e}});Object.defineProperty(h.prototype,"reduceRight",{value:function(a){if(this===t||null===
this)throw TypeError();var c=Object(this),d=c.length>>>0;if(!b(a))throw TypeError();if(0===d&&1===arguments.length)throw TypeError();for(var e=d-1,d=2<=arguments.length?arguments[1]:c._getter(e--);0<=e;)d=a.call(t,d,c._getter(e),e,c),e--;return d}});Object.defineProperty(h.prototype,"reverse",{value:function(){if(this===t||null===this)throw TypeError();for(var a=Object(this),b=a.length>>>0,c=H(b/2),d=0,b=b-1;d<c;++d,--b){var e=a._getter(d);a._setter(d,a._getter(b));a._setter(b,e)}return a}});Object.defineProperty(h.prototype,
"set",{value:function(a,b){if(1>arguments.length)throw SyntaxError("Not enough arguments");var c,d,e,g,f,k;if("object"==typeof arguments[0]&&arguments[0].constructor===this.constructor){if(c=arguments[0],e=arguments[1]>>>0,e+c.length>this.length)throw RangeError("Offset plus length of array is out of range");if(g=this.byteOffset+e*this.BYTES_PER_ELEMENT,d=c.length*this.BYTES_PER_ELEMENT,c.buffer===this.buffer){e=[];f=0;for(k=c.byteOffset;f<d;f+=1,k+=1)e[f]=c.buffer._bytes[k];for(f=0;f<d;f+=1,g+=1)this.buffer._bytes[g]=
e[f]}else for(f=0,k=c.byteOffset;f<d;f+=1,k+=1,g+=1)this.buffer._bytes[g]=c.buffer._bytes[k]}else{if("object"!=typeof arguments[0]||"undefined"==typeof arguments[0].length)throw TypeError("Unexpected argument type(s)");if(d=arguments[0],g=d.length>>>0,e=arguments[1]>>>0,e+g>this.length)throw RangeError("Offset plus length of array is out of range");for(f=0;f<g;f+=1)k=d[f],this._setter(e+f,Number(k))}}});Object.defineProperty(h.prototype,"slice",{value:function(a,b){var c=d(this),e=c.length>>>0;a>>=
0;a=0>a?G(e+a,0):z(a,e);b=b===t?e:b>>0;e=0>b?G(e+b,0):z(b,e);b=new c.constructor(e-a);for(var g=0;a<e;){var f=c._getter(a);b._setter(g,f);++a;++g}return b}});Object.defineProperty(h.prototype,"some",{value:function(a,c){if(this===t||null===this)throw TypeError();var d=Object(this),e=d.length>>>0;if(!b(a))throw TypeError();for(var g=0;g<e;g++)if(a.call(c,d._getter(g),g,d))return!0;return!1}});Object.defineProperty(h.prototype,"sort",{value:function(a){if(this===t||null===this)throw TypeError();for(var b=
Object(this),c=b.length>>>0,d=Array(c),e=0;e<c;++e)d[e]=b._getter(e);a?d.sort(a):d.sort();for(e=0;e<c;++e)b._setter(e,d[e]);return b}});Object.defineProperty(h.prototype,"subarray",{value:function(a,b){a>>=0;b>>=0;1>arguments.length&&(a=0);2>arguments.length&&(b=this.length);0>a&&(a=this.length+a);0>b&&(b=this.length+b);var c=this.length;a=0>a?0:a>c?c:a;c=this.length;c=(0>b?0:b>c?c:b)-a;return 0>c&&(c=0),new this.constructor(this.buffer,this.byteOffset+a*this.BYTES_PER_ELEMENT,c)}});var x=p(1,l,m),
P=p(1,n,u),I=p(1,r,u),Y=p(2,v,k),L=p(2,q,E),X=p(4,C,y),Z=p(4,D,K),aa=p(4,F,S),ba=p(8,R,Q);e.Int8Array=e.Int8Array||x;e.Uint8Array=e.Uint8Array||P;e.Uint8ClampedArray=e.Uint8ClampedArray||I;e.Int16Array=e.Int16Array||Y;e.Uint16Array=e.Uint16Array||L;e.Int32Array=e.Int32Array||X;e.Uint32Array=e.Uint32Array||Z;e.Float32Array=e.Float32Array||aa;e.Float64Array=e.Float64Array||ba})();(function(){function a(c,d){return b(c.get)?c.get(d):c[d]}function d(a,b,e){if(!(a instanceof ArrayBuffer||"ArrayBuffer"===
c(a)))throw TypeError();if(b>>>=0,b>a.byteLength)throw RangeError("byteOffset out of range");if(e=e===t?a.byteLength-b:e>>>0,b+e>a.byteLength)throw RangeError("byteOffset and length reference an area beyond the end of the buffer");Object.defineProperty(this,"buffer",{value:a});Object.defineProperty(this,"byteLength",{value:e});Object.defineProperty(this,"byteOffset",{value:b})}function g(b){return function(c,d){if(c>>>=0,c+b.BYTES_PER_ELEMENT>this.byteLength)throw RangeError("Array index out of range");
c+=this.byteOffset;c=new Uint8Array(this.buffer,c,b.BYTES_PER_ELEMENT);for(var e=[],g=0;g<b.BYTES_PER_ELEMENT;g+=1)e.push(a(c,g));return!!d===!!k&&e.reverse(),a(new b((new Uint8Array(e)).buffer),0)}}function f(b){return function(c,d,e){if(c>>>=0,c+b.BYTES_PER_ELEMENT>this.byteLength)throw RangeError("Array index out of range");d=new b([d]);var g=new Uint8Array(d.buffer),f=[];for(d=0;d<b.BYTES_PER_ELEMENT;d+=1)f.push(a(g,d));!!e===!!k&&f.reverse();(new Uint8Array(this.buffer,c,b.BYTES_PER_ELEMENT)).set(f)}}
var k=function(){var b=new Uint16Array([4660]),b=new Uint8Array(b.buffer);return 18===a(b,0)}();Object.defineProperty(d.prototype,"getUint8",{value:g(Uint8Array)});Object.defineProperty(d.prototype,"getInt8",{value:g(Int8Array)});Object.defineProperty(d.prototype,"getUint16",{value:g(Uint16Array)});Object.defineProperty(d.prototype,"getInt16",{value:g(Int16Array)});Object.defineProperty(d.prototype,"getUint32",{value:g(Uint32Array)});Object.defineProperty(d.prototype,"getInt32",{value:g(Int32Array)});
Object.defineProperty(d.prototype,"getFloat32",{value:g(Float32Array)});Object.defineProperty(d.prototype,"getFloat64",{value:g(Float64Array)});Object.defineProperty(d.prototype,"setUint8",{value:f(Uint8Array)});Object.defineProperty(d.prototype,"setInt8",{value:f(Int8Array)});Object.defineProperty(d.prototype,"setUint16",{value:f(Uint16Array)});Object.defineProperty(d.prototype,"setInt16",{value:f(Int16Array)});Object.defineProperty(d.prototype,"setUint32",{value:f(Uint32Array)});Object.defineProperty(d.prototype,
"setInt32",{value:f(Int32Array)});Object.defineProperty(d.prototype,"setFloat32",{value:f(Float32Array)});Object.defineProperty(d.prototype,"setFloat64",{value:f(Float64Array)});e.DataView=e.DataView||d})()})(self);
(function(e){function a(a,b){return a=0|a||0,0>a?Math.max(a+b,0):Math.min(a,b)}ArrayBuffer.prototype.slice||(ArrayBuffer.prototype.slice=function(c,b){var d=this.byteLength;c=a(c,d);var g=d;if(b!==e&&(g=a(b,d)),c>g)return new ArrayBuffer(0);g-=c;b=new ArrayBuffer(g);d=new Uint8Array(b);c=new Uint8Array(this,c,g);return d.set(c),b})})();"undefined"!=typeof module&&module.exports&&(this["encoding-indexes"]=require("./encoding-indexes.js")["encoding-indexes"]);
(function(e){function a(a,b,c){return b<=a&&a<=c}function c(a){if(void 0===a)return{};if(a===Object(a))return a;throw TypeError("Could not convert argument to dictionary");}function b(a){return 0<=a&&127>=a}function d(a){this.tokens=[].slice.call(a);this.tokens.reverse()}function g(a,b){if(a)throw TypeError("Decoder error");return b||65533}function f(a){throw TypeError("The code point "+a+" could not be encoded.");}function h(a){return a=String(a).trim().toLowerCase(),Object.prototype.hasOwnProperty.call(U,
a)?U[a]:null}function l(a,b){return b?b[a]||null:null}function m(a,b){a=b.indexOf(a);return-1===a?null:a}function n(a){if(!("encoding-indexes"in e))throw Error("Indexes missing. Did you forget to include encoding-indexes.js?");return e["encoding-indexes"][a]}function u(a,b){if(!(this instanceof u))throw TypeError("Called as a function. Did you forget 'new'?");a=void 0!==a?String(a):P;b=c(b);this._decoder=this._encoding=null;this._BOMseen=this._ignoreBOM=!1;this._error_mode="replacement";this._do_not_flush=
!1;var d=h(a);if(null===d||"replacement"===d.name)throw RangeError("Unknown encoding: "+a);if(!B[d.name])throw Error("Decoder not present. Did you forget to include encoding-indexes.js?");return this._encoding=d,!!b.fatal&&(this._error_mode="fatal"),!!b.ignoreBOM&&(this._ignoreBOM=!0),Object.defineProperty||(this.encoding=this._encoding.name.toLowerCase(),this.fatal="fatal"===this._error_mode,this.ignoreBOM=this._ignoreBOM),this}function r(a,b){if(!(this instanceof r))throw TypeError("Called as a function. Did you forget 'new'?");
b=c(b);this._encoder=this._encoding=null;this._do_not_flush=!1;this._fatal=b.fatal?"fatal":"replacement";if(b.NONSTANDARD_allowLegacyEncoding){a=void 0!==a?String(a):P;b=h(a);if(null===b||"replacement"===b.name)throw RangeError("Unknown encoding: "+a);if(!A[b.name])throw Error("Encoder not present. Did you forget to include encoding-indexes.js?");this._encoding=b}else this._encoding=h("utf-8");return Object.defineProperty||(this.encoding=this._encoding.name.toLowerCase()),this}function v(b){var c=
b.fatal,d=0,e=0,f=0,k=128,h=191;this.handler=function(b,l){if(l===p&&0!==f)return f=0,g(c);if(l===p)return w;if(0===f){if(a(l,0,127))return l;if(a(l,194,223))f=1,d=l-192;else if(a(l,224,239))224===l&&(k=160),237===l&&(h=159),f=2,d=l-224;else{if(!a(l,240,244))return g(c);240===l&&(k=144);244===l&&(h=143);f=3;d=l-240}return d<<=6*f,null}if(!a(l,k,h))return d=f=e=0,k=128,h=191,b.prepend(l),g(c);if(k=128,h=191,e+=1,d+=l-128<<6*(f-e),e!==f)return null;b=d;return d=f=e=0,b}}function k(b){b.fatal;this.handler=
function(b,c){if(c===p)return w;if(a(c,0,127))return c;var d,e;a(c,128,2047)?(d=1,e=192):a(c,2048,65535)?(d=2,e=224):a(c,65536,1114111)&&(d=3,e=240);for(b=[(c>>6*d)+e];0<d;)b.push(128|63&c>>6*(d-1)),--d;return b}}function q(a,c){var d=c.fatal;this.handler=function(c,e){if(e===p)return w;if(b(e))return e;c=a[e-128];return null===c?g(d):c}}function E(a,b){b.fatal;this.handler=function(b,c){if(c===p)return w;if(x(c))return c;b=m(c,a);return null===b&&f(c),b+128}}function C(c){var d=c.fatal,e=0,f=0,k=
0;this.handler=function(c,h){if(h===p&&0===e&&0===f&&0===k)return w;h!==p||0===e&&0===f&&0===k||(e=0,f=0,k=0,g(d));var q;if(0!==k){q=null;if(a(h,48,57))if(q=10*(126*(10*(e-129)+(f-48))+(k-129))+h-48,39419<q&&189E3>q||1237575<q)q=null;else if(7457===q)q=59335;else{var E,I=0,m=0,D=n("gb18030");for(E=0;E<D.length;++E){var C=D[E];if(!(C[0]<=q))break;I=C[0];m=C[1]}q=m+q-I}h=[f,k,h];return e=0,f=0,k=0,null===q?(c.prepend(h),g(d)):q}if(0!==f)return a(h,129,254)?(k=h,null):(c.prepend([f,h]),e=0,f=0,g(d));
if(0!==e){if(a(h,48,57))return f=h,null;E=e;I=null;e=0;m=127>h?64:65;return(a(h,64,126)||a(h,128,254))&&(I=190*(E-129)+(h-m)),q=null===I?null:l(I,n("gb18030")),null===q&&b(h)&&c.prepend(h),null===q?g(d):q}return b(h)?h:128===h?8364:a(h,129,254)?(e=h,null):g(d)}}function y(a,b){a.fatal;this.handler=function(a,c){if(c===p)return w;if(x(c))return c;if(58853===c)return f(c);if(b&&8364===c)return 128;a=m(c,n("gb18030"));if(null!==a)return c=z(a/190)+129,a%=190,[c,a+(63>a?64:65)];if(b)return f(c);if(59335===
c)a=7457;else{var d=0,e=0,g=n("gb18030");for(a=0;a<g.length;++a){var k=g[a];if(!(k[1]<=c))break;d=k[1];e=k[0]}a=e+c-d}c=z(a/10/126/10);a-=12600*c;d=z(a/10/126);a-=1260*d;e=z(a/10);return[c+129,d+48,e+129,a-10*e+48]}}function D(c){var d=c.fatal,e=0;this.handler=function(c,f){if(f===p&&0!==e)return e=0,g(d);if(f===p&&0===e)return w;if(0!==e){var k=e,h=null;e=0;var q=127>f?64:98;switch((a(f,64,126)||a(f,161,254))&&(h=157*(k-129)+(f-q)),h){case 1133:return[202,772];case 1135:return[202,780];case 1164:return[234,
772];case 1166:return[234,780]}k=null===h?null:l(h,n("big5"));return null===k&&b(f)&&c.prepend(f),null===k?g(d):k}return b(f)?f:a(f,129,254)?(e=f,null):g(d)}}function K(a){a.fatal;this.handler=function(a,b){if(b===p)return w;if(x(b))return b;var c;a=n("big5");c=9552===b||9566===b||9569===b||9578===b||21313===b||21317===b?a.lastIndexOf(b):m(b,a);if(null===c)return f(b);a=z(c/157)+129;if(161>a)return f(b);b=c%157;return[a,b+(63>b?64:98)]}}function M(c){var d=c.fatal,e=!1,f=0;this.handler=function(c,
k){if(k===p&&0!==f)return f=0,g(d);if(k===p&&0===f)return w;if(142===f&&a(k,161,223))return f=0,65377+k-161;if(143===f&&a(k,161,254))return e=!0,f=k,null;if(0!==f){var h=f;f=0;var q=null;return a(h,161,254)&&a(k,161,254)&&(q=l(94*(h-161)+(k-161),n(e?"jis0212":"jis0208"))),e=!1,a(k,161,254)||c.prepend(k),null===q?g(d):q}return b(k)?k:142===k||143===k||a(k,161,254)?(f=k,null):g(d)}}function O(b){b.fatal;this.handler=function(b,c){if(c===p)return w;if(x(c))return c;if(165===c)return 92;if(8254===c)return 126;
if(a(c,65377,65439))return[142,c-65377+161];8722===c&&(c=65293);b=m(c,n("jis0208"));return null===b?f(c):[z(b/94)+161,b%94+161]}}function Q(b){var c=b.fatal,d=0,e=0,f=!1;this.handler=function(b,k){switch(d){default:case 0:return 27===k?(d=5,null):a(k,0,127)&&14!==k&&15!==k&&27!==k?(f=!1,k):k===p?w:(f=!1,g(c));case 1:return 27===k?(d=5,null):92===k?(f=!1,165):126===k?(f=!1,8254):a(k,0,127)&&14!==k&&15!==k&&27!==k&&92!==k&&126!==k?(f=!1,k):k===p?w:(f=!1,g(c));case 2:return 27===k?(d=5,null):a(k,33,
95)?(f=!1,65377+k-33):k===p?w:(f=!1,g(c));case 3:return 27===k?(d=5,null):a(k,33,126)?(f=!1,e=k,d=4,null):k===p?w:(f=!1,g(c));case 4:return 27===k?(d=5,g(c)):a(k,33,126)?(d=3,b=l(94*(e-33)+k-33,n("jis0208")),null===b?g(c):b):k===p?(d=3,b.prepend(k),g(c)):(d=3,g(c));case 5:return 36===k||40===k?(e=k,d=6,null):(b.prepend(k),f=!1,d=0,g(c));case 6:var h=e;e=0;var q=null;return(40===h&&66===k&&(q=0),40===h&&74===k&&(q=1),40===h&&73===k&&(q=2),36!==h||64!==k&&66!==k||(q=3),null!==q)?(d=d=q,b=f,f=!0,b?g(c):
null):(b.prepend([h,k]),f=!1,d=0,g(c))}}}function R(a){var b=(a.fatal,{ASCII:0,Roman:1,jis0208:2}),c=b.ASCII;this.handler=function(a,d){if(d===p&&c!==b.ASCII)return a.prepend(d),c=b.ASCII,[27,40,66];if(d===p&&c===b.ASCII)return w;if(!(c!==b.ASCII&&c!==b.Roman||14!==d&&15!==d&&27!==d))return f(65533);if(c===b.ASCII&&x(d))return d;if(c===b.Roman&&(x(d)&&92!==d&&126!==d||165==d||8254==d)){if(x(d))return d;if(165===d)return 92;if(8254===d)return 126}if(x(d)&&c!==b.ASCII)return a.prepend(d),c=b.ASCII,
[27,40,66];if((165===d||8254===d)&&c!==b.Roman)return a.prepend(d),c=b.Roman,[27,40,74];8722===d&&(d=65293);var e=m(d,n("jis0208"));return null===e?f(d):c!==b.jis0208?(a.prepend(d),c=b.jis0208,[27,36,66]):[z(e/94)+33,e%94+33]}}function S(c){var d=c.fatal,e=0;this.handler=function(c,f){if(f===p&&0!==e)return e=0,g(d);if(f===p&&0===e)return w;if(0!==e){var k=e,h=null;e=0;var q=127>f?64:65,E=160>k?129:193;(a(f,64,126)||a(f,128,252))&&(h=188*(k-E)+f-q);k=null===h?null:l(h,n("jis0208"));return null===
k&&null!==h&&a(h,8836,10528)?57344+h-8836:(null===k&&b(f)&&c.prepend(f),null===k?g(d):k)}return b(f)||128===f?f:a(f,161,223)?65377+f-161:a(f,129,159)||a(f,224,252)?(e=f,null):g(d)}}function F(b){b.fatal;this.handler=function(b,c){if(c===p)return w;if(x(c)||128===c)return c;if(165===c)return 92;if(8254===c)return 126;if(a(c,65377,65439))return c-65377+161;8722===c&&(c=65293);b=m(c,n("jis0208"));b=null===b||a(b,8272,8835)?null:b;if(null===b)return f(c);c=z(b/188);b%=188;return[c+(31>c?129:193),b+(63>
b?64:65)]}}function t(c){var d=c.fatal,e=0;this.handler=function(c,f){if(f===p&&0!==e)return e=0,g(d);if(f===p&&0===e)return w;if(0!==e){var k=e,h=null;e=0;a(f,65,254)&&(h=190*(k-129)+(f-65));k=null===h?null:l(h,n("euc-kr"));return null===h&&b(f)&&c.prepend(f),null===k?g(d):k}return b(f)?f:a(f,129,254)?(e=f,null):g(d)}}function T(a){a.fatal;this.handler=function(a,b){if(b===p)return w;if(x(b))return b;a=m(b,n("euc-kr"));return null===a?f(b):[z(a/190)+129,a%190+65]}}function N(a,b){var c=a>>8;a&=255;
return b?[c,a]:[a,c]}function J(b,c){var d=c.fatal,e=null,f=null;this.handler=function(c,k){if(k===p&&(null!==e||null!==f))return g(d);if(k===p&&null===e&&null===f)return w;if(null===e)return e=k,null;if(k=b?(e<<8)+k:(k<<8)+e,e=null,null!==f){var h=f;return f=null,a(k,56320,57343)?65536+1024*(h-55296)+(k-56320):(c.prepend(N(k,b)),g(d))}return a(k,55296,56319)?(f=k,null):a(k,56320,57343)?g(d):k}}function H(b,c){c.fatal;this.handler=function(c,d){if(d===p)return w;if(a(d,0,65535))return N(d,b);c=N((d-
65536>>10)+55296,b);d=N((d-65536&1023)+56320,b);return c.concat(d)}}function V(a){a.fatal;this.handler=function(a,c){return c===p?w:b(c)?c:63360+c-128}}function G(b){b.fatal;this.handler=function(b,c){return c===p?w:x(c)?c:a(c,63360,63487)?c-63360+128:f(c)}}var z=Math.floor,x=b,p=-1;d.prototype={endOfStream:function(){return!this.tokens.length},read:function(){return this.tokens.length?this.tokens.pop():p},prepend:function(a){if(Array.isArray(a))for(;a.length;)this.tokens.push(a.pop());else this.tokens.push(a)},
push:function(a){if(Array.isArray(a))for(;a.length;)this.tokens.unshift(a.shift());else this.tokens.unshift(a)}};var w=-1,W=[{encodings:[{labels:["unicode-1-1-utf-8","utf-8","utf8"],name:"UTF-8"}],heading:"The Encoding"},{encodings:[{labels:["866","cp866","csibm866","ibm866"],name:"IBM866"},{labels:"csisolatin2 iso-8859-2 iso-ir-101 iso8859-2 iso88592 iso_8859-2 iso_8859-2:1987 l2 latin2".split(" "),name:"ISO-8859-2"},{labels:"csisolatin3 iso-8859-3 iso-ir-109 iso8859-3 iso88593 iso_8859-3 iso_8859-3:1988 l3 latin3".split(" "),
name:"ISO-8859-3"},{labels:"csisolatin4 iso-8859-4 iso-ir-110 iso8859-4 iso88594 iso_8859-4 iso_8859-4:1988 l4 latin4".split(" "),name:"ISO-8859-4"},{labels:"csisolatincyrillic cyrillic iso-8859-5 iso-ir-144 iso8859-5 iso88595 iso_8859-5 iso_8859-5:1988".split(" "),name:"ISO-8859-5"},{labels:"arabic asmo-708 csiso88596e csiso88596i csisolatinarabic ecma-114 iso-8859-6 iso-8859-6-e iso-8859-6-i iso-ir-127 iso8859-6 iso88596 iso_8859-6 iso_8859-6:1987".split(" "),name:"ISO-8859-6"},{labels:"csisolatingreek ecma-118 elot_928 greek greek8 iso-8859-7 iso-ir-126 iso8859-7 iso88597 iso_8859-7 iso_8859-7:1987 sun_eu_greek".split(" "),
name:"ISO-8859-7"},{labels:"csiso88598e csisolatinhebrew hebrew iso-8859-8 iso-8859-8-e iso-ir-138 iso8859-8 iso88598 iso_8859-8 iso_8859-8:1988 visual".split(" "),name:"ISO-8859-8"},{labels:["csiso88598i","iso-8859-8-i","logical"],name:"ISO-8859-8-I"},{labels:"csisolatin6 iso-8859-10 iso-ir-157 iso8859-10 iso885910 l6 latin6".split(" "),name:"ISO-8859-10"},{labels:["iso-8859-13","iso8859-13","iso885913"],name:"ISO-8859-13"},{labels:["iso-8859-14","iso8859-14","iso885914"],name:"ISO-8859-14"},{labels:"csisolatin9 iso-8859-15 iso8859-15 iso885915 iso_8859-15 l9".split(" "),
name:"ISO-8859-15"},{labels:["iso-8859-16"],name:"ISO-8859-16"},{labels:["cskoi8r","koi","koi8","koi8-r","koi8_r"],name:"KOI8-R"},{labels:["koi8-ru","koi8-u"],name:"KOI8-U"},{labels:["csmacintosh","mac","macintosh","x-mac-roman"],name:"macintosh"},{labels:"dos-874 iso-8859-11 iso8859-11 iso885911 tis-620 windows-874".split(" "),name:"windows-874"},{labels:["cp1250","windows-1250","x-cp1250"],name:"windows-1250"},{labels:["cp1251","windows-1251","x-cp1251"],name:"windows-1251"},{labels:"ansi_x3.4-1968 ascii cp1252 cp819 csisolatin1 ibm819 iso-8859-1 iso-ir-100 iso8859-1 iso88591 iso_8859-1 iso_8859-1:1987 l1 latin1 us-ascii windows-1252 x-cp1252".split(" "),
name:"windows-1252"},{labels:["cp1253","windows-1253","x-cp1253"],name:"windows-1253"},{labels:"cp1254 csisolatin5 iso-8859-9 iso-ir-148 iso8859-9 iso88599 iso_8859-9 iso_8859-9:1989 l5 latin5 windows-1254 x-cp1254".split(" "),name:"windows-1254"},{labels:["cp1255","windows-1255","x-cp1255"],name:"windows-1255"},{labels:["cp1256","windows-1256","x-cp1256"],name:"windows-1256"},{labels:["cp1257","windows-1257","x-cp1257"],name:"windows-1257"},{labels:["cp1258","windows-1258","x-cp1258"],name:"windows-1258"},
{labels:["x-mac-cyrillic","x-mac-ukrainian"],name:"x-mac-cyrillic"}],heading:"Legacy single-byte encodings"},{encodings:[{labels:"chinese csgb2312 csiso58gb231280 gb2312 gb_2312 gb_2312-80 gbk iso-ir-58 x-gbk".split(" "),name:"GBK"},{labels:["gb18030"],name:"gb18030"}],heading:"Legacy multi-byte Chinese (simplified) encodings"},{encodings:[{labels:["big5","big5-hkscs","cn-big5","csbig5","x-x-big5"],name:"Big5"}],heading:"Legacy multi-byte Chinese (traditional) encodings"},{encodings:[{labels:["cseucpkdfmtjapanese",
"euc-jp","x-euc-jp"],name:"EUC-JP"},{labels:["csiso2022jp","iso-2022-jp"],name:"ISO-2022-JP"},{labels:"csshiftjis ms932 ms_kanji shift-jis shift_jis sjis windows-31j x-sjis".split(" "),name:"Shift_JIS"}],heading:"Legacy multi-byte Japanese encodings"},{encodings:[{labels:"cseuckr csksc56011987 euc-kr iso-ir-149 korean ks_c_5601-1987 ks_c_5601-1989 ksc5601 ksc_5601 windows-949".split(" "),name:"EUC-KR"}],heading:"Legacy multi-byte Korean encodings"},{encodings:[{labels:["csiso2022kr","hz-gb-2312",
"iso-2022-cn","iso-2022-cn-ext","iso-2022-kr"],name:"replacement"},{labels:["utf-16be"],name:"UTF-16BE"},{labels:["utf-16","utf-16le"],name:"UTF-16LE"},{labels:["x-user-defined"],name:"x-user-defined"}],heading:"Legacy miscellaneous encodings"}],U={};W.forEach(function(a){a.encodings.forEach(function(a){a.labels.forEach(function(b){U[b]=a})})});var A={},B={},P="utf-8";Object.defineProperty&&(Object.defineProperty(u.prototype,"encoding",{get:function(){return this._encoding.name.toLowerCase()}}),Object.defineProperty(u.prototype,
"fatal",{get:function(){return"fatal"===this._error_mode}}),Object.defineProperty(u.prototype,"ignoreBOM",{get:function(){return this._ignoreBOM}}));u.prototype.decode=function(a,b){a="object"==typeof a&&a instanceof ArrayBuffer?new Uint8Array(a):"object"==typeof a&&"buffer"in a&&a.buffer instanceof ArrayBuffer?new Uint8Array(a.buffer,a.byteOffset,a.byteLength):new Uint8Array(0);b=c(b);this._do_not_flush||(this._decoder=B[this._encoding.name]({fatal:"fatal"===this._error_mode}),this._BOMseen=!1);
this._do_not_flush=!!b.stream;var e;a=new d(a);for(b=[];;){var f=a.read();if(f===p)break;if(e=this._decoder.handler(a,f),e===w)break;null!==e&&(Array.isArray(e)?b.push.apply(b,e):b.push(e))}if(!this._do_not_flush){do{if(e=this._decoder.handler(a,a.read()),e===w)break;null!==e&&(Array.isArray(e)?b.push.apply(b,e):b.push(e))}while(!a.endOfStream());this._decoder=null}-1===["UTF-8","UTF-16LE","UTF-16BE"].indexOf(this._encoding.name)||this._ignoreBOM||this._BOMseen||(0<b.length&&65279===b[0]?(this._BOMseen=
!0,b.shift()):0<b.length&&(this._BOMseen=!0));e="";for(a=0;a<b.length;++a)f=b[a],65535>=f?e+=String.fromCharCode(f):(f-=65536,e+=String.fromCharCode((f>>10)+55296,(1023&f)+56320));return e};Object.defineProperty&&Object.defineProperty(r.prototype,"encoding",{get:function(){return this._encoding.name.toLowerCase()}});r.prototype.encode=function(a,b){a=a?String(a):"";b=c(b);this._do_not_flush||(this._encoder=A[this._encoding.name]({fatal:"fatal"===this._fatal}));this._do_not_flush=!!b.stream;var e;
b=String(a);for(var f=b.length,g=0,k=[];g<f;){var h=b.charCodeAt(g);if(55296>h||57343<h)k.push(h);else if(56320<=h&&57343>=h)k.push(65533);else if(55296<=h&&56319>=h)if(g===f-1)k.push(65533);else{var q=a.charCodeAt(g+1);56320<=q&&57343>=q?(k.push(65536+((1023&h)<<10)+(1023&q)),g+=1):k.push(65533)}g+=1}a=new d(k);for(b=[];;){f=a.read();if(f===p)break;if(e=this._encoder.handler(a,f),e===w)break;Array.isArray(e)?b.push.apply(b,e):b.push(e)}if(!this._do_not_flush){for(;e=this._encoder.handler(a,a.read()),
e!==w;)Array.isArray(e)?b.push.apply(b,e):b.push(e);this._encoder=null}return new Uint8Array(b)};A["UTF-8"]=function(a){return new k(a)};B["UTF-8"]=function(a){return new v(a)};(function(){"encoding-indexes"in e&&W.forEach(function(a){"Legacy single-byte encodings"===a.heading&&a.encodings.forEach(function(a){a=a.name;var b=n(a.toLowerCase());B[a]=function(a){return new q(b,a)};A[a]=function(a){return new E(b,a)}})})})();B.GBK=function(a){return new C(a)};A.GBK=function(a){return new y(a,!0)};A.gb18030=
function(a){return new y(a)};B.gb18030=function(a){return new C(a)};A.Big5=function(a){return new K(a)};B.Big5=function(a){return new D(a)};A["EUC-JP"]=function(a){return new O(a)};B["EUC-JP"]=function(a){return new M(a)};A["ISO-2022-JP"]=function(a){return new R(a)};B["ISO-2022-JP"]=function(a){return new Q(a)};A.Shift_JIS=function(a){return new F(a)};B.Shift_JIS=function(a){return new S(a)};A["EUC-KR"]=function(a){return new T(a)};B["EUC-KR"]=function(a){return new t(a)};A["UTF-16BE"]=function(a){return new H(!0,
a)};B["UTF-16BE"]=function(a){return new J(!0,a)};A["UTF-16LE"]=function(a){return new H(!1,a)};B["UTF-16LE"]=function(a){return new J(!1,a)};A["x-user-defined"]=function(a){return new G(a)};B["x-user-defined"]=function(a){return new V(a)};e.TextEncoder||(e.TextEncoder=r);e.TextDecoder||(e.TextDecoder=u);"undefined"!=typeof module&&module.exports&&(module.exports={TextEncoder:e.TextEncoder,TextDecoder:e.TextDecoder,EncodingIndexes:e["encoding-indexes"]})})(this);
var xapiActivity={id:ANALYTICS_COURSE_ID,definition:{name:ANALYTICS_COURSE_NAME,description:ANALYTICS_COURSE_DESC}},verbMap={experienced:{id:"http://adlnet.gov/expapi/verbs/experienced",display:{"en-US":"experienced"}},attended:{id:"http://adlnet.gov/expapi/verbs/attended",display:{"en-US":"attended"}},attempted:{id:"http://adlnet.gov/expapi/verbs/attempted",display:{"en-US":"attempted"}},completed:{id:"http://adlnet.gov/expapi/verbs/completed",display:{"en-US":"completed"}},passed:{id:"http://adlnet.gov/expapi/verbs/passed",
display:{"en-US":"passed"}},failed:{id:"http://adlnet.gov/expapi/verbs/failed",display:{"en-US":"failed"}},answered:{id:"http://adlnet.gov/expapi/verbs/answered",display:{"en-US":"answered"}},interacted:{id:"http://adlnet.gov/expapi/verbs/interacted",display:{"en-US":"interacted"}},imported:{id:"http://adlnet.gov/expapi/verbs/imported",display:{"en-US":"imported"}},created:{id:"http://adlnet.gov/expapi/verbs/created",display:{"en-US":"created"}},shared:{id:"http://adlnet.gov/expapi/verbs/shared",
display:{"en-US":"shared"}},voided:{id:"http://adlnet.gov/expapi/verbs/voided",display:{"en-US":"voided"}},objectiveCompleted:{id:"http://www.dominknow.com/xapi/verbs/objective_complete",display:{"en-US":"completed the objective"}}};
$(document).ready(function(){$(document).on(DKI.DataStorage.events.beforeReady,function(){if("undefined"!=typeof ANALYTICS_RECORD_STORES&&ANALYTICS_RECORD_STORES&&0<ANALYTICS_RECORD_STORES.length){var e;e=dataStorage.getUserID();e=xAPIFunctions.getActor(e);if(courseStructure&&courseStructure.model_id)switch(courseStructure.model_id){case 5:xapiActivity.definition.type="http://adlnet.gov/expapi/activities/assessment";break;case 7:xapiActivity.definition.type="http://id.tincanapi.com/activitytype/scenario";
break;case 8:xapiActivity.definition.type="http://adlnet.gov/expapi/activities/simulation";break;case 20:xapiActivity.definition.type="https://w3id.org/xapi/acrossx/activities/video";break;case 21:xapiActivity.definition.type="http://activitystrea.ms/schema/1.0/game";break;default:xapiActivity.definition.type="http://adlnet.gov/expapi/activities/course"}tc=new TinCan({url:location.href,recordStores:ANALYTICS_RECORD_STORES,activity:xapiActivity,actor:e});setupAnalyticsTriggers()}setupXAPITriggers()})});
var setupAnalyticsTriggers=function(){var e=!1,a="";contentApi.sendAnalyticsStatement({verb:verbMap.attempted,inProgress:!0});$(dataStorage).on(DKI.DataStorage.events.pageSelected,function(a,c){b(c.page)});$(dataStorage).bind(DKI.DataStorage.events.courseCompleted,function(){e=!0;setTimeout(d,10)});$(dataStorage).bind(DKI.DataStorage.events.assessmentCompleted,function(){e=!0;dataStorage.courseStructure.testonly&&((nextModule=dataStorage.getNextModule(dataStorage.assessment.module))?g(nextModule.loid,
nextModule.name,"module"):g("",""));b()});$(dataStorage).bind(DKI.DataStorage.events.questionScored,function(a,b){a=b.question;var c=b.questionObject;b=b.score;c.questionOptions=a.options;c.id=a.id;c.score=b;c.weight=a.weight;c.question=a;switch(c.type){case 1:xapiFunctions.recordTrueFalse(c);break;case 2:xapiFunctions.recordMultipleChoice(c);break;case 3:xapiFunctions.recordFreeForm(c);break;case 4:xapiFunctions.recordFillBlanks(c);break;case 5:xapiFunctions.recordPulldown(c);break;case 6:xapiFunctions.recordDragDrop(c)}});
var c=function(){for(var a,b,c={i:[],m:[],o:[],s:[],t:[]},d=0;d<dataStorage.courseStructure.modules.length;d++){a=dataStorage.courseStructure.modules[d];dataStorage.courseStructure.modules[d].invalidated&&(c.i[c.i.length]=a.loid);if(a.complete)c.m[c.m.length]=a.loid;else for(var e=0;e<a.objects.length;e++)if(b=a.objects[e],b.complete)c.o[c.o.length]=b.objectid;else for(var g=0;g<b.subeos.length;g++)b.subeos[g].complete&&(c.s[c.s.length]=b.subeos[g].subeoid);if(a.pre||a.post)b={id:a.loid},a.pre&&(b.pre=
a.pre),a.post&&(b.post=a.post),c.t[c.t.length]=b}a={completion:c};a.contentVariables=dataStorage.storedContentVariables;return JSON.stringify(a)},b=function(a){dataStorage.getCourseCompletion(!0);var b=c();a&&g(a.id,a.title,"page");tc.setState("suspend_data",b,{callback:function(){}});d()},d=function(){if(e){var b=dataStorage.lessonStatus,c=!1,d=dataStorage.getCourseScoringDetails();"incomplete"==b?(b="attempted",c=!0):"complete"==b&&(b="completed");if(b!=a){a=b;var g={},n={verb:verbMap[b],inProgress:c};
if("completed"==b||"failed"==b||"passed"==b||!c){g.duration=scormTimeFn.ConvertMilliSecondsIntoSCORM2004Time(scormTimeFn.GetSessionAccumulatedTime());g.completion=!0;if("failed"==b||"passed"==b)g.score={scaled:d.score/100,min:0,max:100,raw:d.score};n.result=g}e=!1;contentApi.sendAnalyticsStatement(n)}}},g=function(a,b,c){tc.setState("bookmark",a,{callback:function(){}});if(c&&("page"==c||"module"==c)){var d="",e=settings.activityRootURL+"page/"+a,g=[];"page"==c?(d="http://activitystrea.ms/schema/1.0/page",
e=settings.activityRootURL+"page/"+a,a=dataStorage.getSubeoFromPage(a),g.push({id:settings.activityRootURL+"object/"+a.objectid}),a=dataStorage.findObject(a.objectid),g.push({id:settings.activityRootURL+"module/"+a.loid})):"module"==c&&(d="http://adlnet.gov/expapi/activities/module",e=settings.activityRootURL+"module/"+a);contentApi.sendAnalyticsStatement({verb:verbMap.experienced,object:{id:e,definition:{name:{"en-US":b},type:d}},context:{contextActivities:{parent:g}}})}}},setupXAPITriggers=function(){function e(a){var b=
dataStorage.findObject(dataStorage.currentPage.objectid);player.inAssessment&&(b=dataStorage.findObject(dataStorage.assessment.currentQuestion.objectid));b=[{id:settings.activityRootURL+"page/"+a.pageid},{id:settings.activityRootURL+"object/"+b.objectid},{id:settings.activityRootURL+"module/"+b.loid}];a.parent_element_id&&b.unshift({id:settings.activityRootURL+"element/"+a.parent_element_id});return{contextActivities:{parent:b}}}var a={id:"http://adlnet.gov/expapi/verbs/interacted",display:{"en-US":"interacted"}},
c={id:"http://adlnet.gov/expapi/verbs/experienced",display:{"en-US":"experienced"}},b={id:"http://activitystrea.ms/schema/1.0/consume",display:{"en-US":"consumed"}},d={id:"http://id.tincanapi.com/verb/viewed",display:{"en-US":"viewed"}},g={id:"http://id.tincanapi.com/verb/selected",display:{"en-US":"selected"}},f={id:"https://w3id.org/xapi/dod-isd/verbs/relocated",display:{"en-US":"relocated"}},h={id:"http://activitystrea.ms/schema/1.0/play",display:{"en-US":"played"}},l={id:"http://id.tincanapi.com/verb/paused",
display:{"en-US":"paused"}},m={id:"http://activitystrea.ms/schema/1.0/start",display:{"en-US":"started"}},n={id:"http://activitystrea.ms/schema/1.0/consume",display:{"en-US":"consumed"}},u={id:"http://activitystrea.ms/schema/1.0/complete",display:{"en-US":"completed"}},r={click:{"en-US":"clicked"},dblClick:{"en-US":"double clicked"},rightClick:{"en-US":"right clicked"},mouseenter:{"en-US":"moused over"},mouseleave:{"en-US":"moused out of"},ELEMENT_DRAG_STARTED:{"en-US":"started dragging"},ELEMENT_DRAG_DROPPED:{"en-US":"dropped"},
ELEMENT_DROP_OVER:{"en-US":"dragged over"},ELEMENT_DROP_OUT:{"en-US":"dragged out of"}},v=function(a){for(var b=0;b<a.objects.length;b++)for(var c=a.objects[b],d=0;d<c.objectives.length;d++){var e=c.objectives[d];contentApi.sendAnalyticsStatement({verb:verbMap.objectiveCompleted,object:{id:settings.activityRootURL+"objective/"+e.id,definition:{type:"http://adlnet.gov/expapi/activities/objective",name:{"en-US":e.title},description:{"en-US":e.description}}},context:{contextActivities:{parent:[{id:settings.activityRootURL+
"module/"+c.loid}]},extensions:{"http://www.dominknow.com/xapi/extensions/learning_object_iri":settings.activityRootURL+"object/"+c.objectid,"http://www.dominknow.com/xapi/extensions/objective_client_id":e.client_id}}})}};$(dataStorage).bind(DKI.DataStorage.events.moduleStarted,function(a,b){a=dataStorage.findModule(b);contentApi.sendAnalyticsStatement({verb:m,object:{id:settings.activityRootURL+"module/"+b,definition:{type:"http://adlnet.gov/expapi/activities/module",name:{"en-US":a.name},description:{"en-US":a.description}}}})});
$(dataStorage).bind(DKI.DataStorage.events.objectStarted,function(a,b){a=dataStorage.findObject(b);contentApi.sendAnalyticsStatement({verb:m,object:{id:settings.activityRootURL+"object/"+b,definition:{type:"http://adlnet.gov/expapi/activities/objective",name:{"en-US":a.title},description:{"en-US":a.description}}},context:{contextActivities:{parent:[{id:settings.activityRootURL+"module/"+a.loid}]}}})});$(dataStorage).bind(DKI.DataStorage.events.moduleCompleted,function(a,b){a=dataStorage.findModule(b);
contentApi.sendAnalyticsStatement({verb:u,object:{id:settings.activityRootURL+"module/"+b,definition:{type:"http://adlnet.gov/expapi/activities/module",name:{"en-US":a.name},description:{"en-US":a.description}}},result:{completion:!0}});dataStorage.moduleHasTest(a)||v(a)});$(dataStorage).bind(DKI.DataStorage.events.objectCompleted,function(a,b){a=dataStorage.findObject(b);contentApi.sendAnalyticsStatement({verb:u,object:{id:settings.activityRootURL+"object/"+b,definition:{type:"http://adlnet.gov/expapi/activities/objective",
name:{"en-US":a.title},description:{"en-US":a.description}}},context:{contextActivities:{parent:[{id:settings.activityRootURL+"module/"+a.loid}]}},result:{completion:!0}})});$(dataStorage).bind(DKI.DataStorage.events.assessmentCompleted,function(a){a=dataStorage.assessment;this.getModuleScoringDetails(a.module).passed&&v(a.module)});playerBehaviour.xapi_includeSearchStatements&&($(document).on(DKI.search.events.show,function(b,c){b=xapiActivity.id+"/search/opened";var d=DKI.clone(a);d.display["en-US"]=
"opened";b={verb:d,object:{id:b,definition:{type:"http://adlnet.gov/expapi/activities/interaction",name:{"en-US":"Search Window"}}},context:{contextActivities:{grouping:{id:xapiActivity.id+"/courseSearch"}}}};c&&""!=c&&(b.context.extensions={"http://dominknow.com/xapi/extensions/searchTerm":c});contentApi.sendAnalyticsStatement(b)}),$(document).on(DKI.search.events.search,function(b,c,d){b=xapiActivity.id+"/search/searched";var e=DKI.clone(a);e.display["en-US"]="searched";for(var g=[],f=0;f<d.length;f++)g.push({ref:d[f].ref,
score:d[f].score,obj:{smSearchType:d[f].obj.smSearchType||"",id:d[f].obj.id||"",meta:d[f].obj.meta||"",title:d[f].obj.title||""}});contentApi.sendAnalyticsStatement({verb:e,object:{id:b,definition:{type:"http://adlnet.gov/expapi/activities/interaction",name:{"en-US":"Search Window"}}},context:{contextActivities:{grouping:{id:xapiActivity.id+"/courseSearch"}},extensions:{"http://dominknow.com/xapi/extensions/searchTerm":c,"http://dominknow.com/xapi/extensions/searchResults":g}}})}),$(document).on(DKI.search.events.hide,
function(b){b=xapiActivity.id+"/search/closed";var c=DKI.clone(a);c.display["en-US"]="closed";contentApi.sendAnalyticsStatement({verb:c,object:{id:b,definition:{type:"http://adlnet.gov/expapi/activities/interaction",name:{"en-US":"Search Window"}}},context:{contextActivities:{grouping:{id:xapiActivity.id+"/courseSearch"}}}})}),$(document).on(DKI.search.events.filterClicked,function(b,c){b=xapiActivity.id+"/search/filter";var d=DKI.clone(a);d.display["en-US"]="filtered";contentApi.sendAnalyticsStatement({verb:d,
object:{id:b,definition:{type:"http://adlnet.gov/expapi/activities/interaction",name:{"en-US":"Search Window"}}},context:{contextActivities:{grouping:{id:xapiActivity.id+"/courseSearch"}},extensions:{"http://dominknow.com/xapi/extensions/selectedFilter":c}}})}),$(document).on(DKI.search.events.loadedProperties,function(b,c,d){b=xapiActivity.id+"/search/properties";var e=DKI.clone(a);e.display["en-US"]="loaded properties";c={verb:e,object:{id:b,definition:{type:"http://adlnet.gov/expapi/activities/interaction",
name:{"en-US":"Search Window"}}},context:{contextActivities:{grouping:{id:xapiActivity.id+"/courseSearch"}},extensions:{"http://dominknow.com/xapi/extensions/searchType":d,"http://dominknow.com/xapi/extensions/searchItem":DKI.search.Window.parseToBasic(c)}}};contentApi.sendAnalyticsStatement(c)}));playerBehaviour.xapi_includePlayerControlStatements&&($(player.navigation).on(DKI.PlayerNavigation.events.forward,function(a){contentApi.sendAnalyticsStatement({verb:{id:"http://adlnet.gov/expapi/verbs/interacted",
display:r.click},object:{id:xapiActivity.id+"/navigation/forward",definition:{type:"http://adlnet.gov/expapi/activities/interaction",name:{"en-US":"Forward Button"}}}})}),$(player.navigation).on(DKI.PlayerNavigation.events.back,function(a){contentApi.sendAnalyticsStatement({verb:{id:"http://adlnet.gov/expapi/verbs/interacted",display:r.click},object:{id:xapiActivity.id+"/navigation/back",definition:{type:"http://adlnet.gov/expapi/activities/interaction",name:{"en-US":"Back Button"}}}})}),$(player).on(player.events.playerTranscriptShown,
function(){contentApi.sendAnalyticsStatement({verb:d,object:{id:xapiActivity.id+"/player/transcript/"+dataStorage.currentPage.page.id,definition:{type:"http://adlnet.gov/expapi/activities/interaction",name:{"en-US":"Player Transcript"}}}})}),$(player.navigation).on(DKI.PlayerNavigation.events.reload,function(){var a=xapiActivity.id+"/navigation/reload",b=DKI.clone(c);b.display["en-US"]="Reloaded Page";contentApi.sendAnalyticsStatement({verb:b,object:{id:a+dataStorage.currentPage.page.id,definition:{name:{"en-US":dataStorage.currentPage.page.title}}}})}),
$(document).on(contentApi.events.jumpToPage,function(a,b,c){c&&(a=xapiActivity.id+"/"+b,c={type:"http://adlnet.gov/expapi/activities/link",name:{"en-US":c.title}},b=DKI.clone(f),b.display["en-US"]="Jumped To Page",contentApi.sendAnalyticsStatement({verb:b,object:{id:a,definition:c}}))}));playerBehaviour.xapi_includeOutlineStatements&&($(document).on(DKI.outline.events.pageSelected,function(b,c){b=dataStorage.findPage(c);c=xapiActivity.id+"/outline/page/"+c;b={type:"http://adlnet.gov/expapi/activities/interaction",
name:{"en-US":b.title}};var d=DKI.clone(a);d.display["en-US"]="Outline Page Selected";contentApi.sendAnalyticsStatement({verb:d,object:{id:c,definition:b}})}),$(document).on(DKI.outline.events.objectSelected,function(b,c){b=$(c).data("objectid");c=dataStorage.findObject(b);b=xapiActivity.id+"/outline/object/"+b;c={type:"http://adlnet.gov/expapi/activities/interaction",name:{"en-US":c.name}};var d=DKI.clone(a);d.display["en-US"]="Outline Object Selected";contentApi.sendAnalyticsStatement({verb:d,object:{id:b,
definition:c}})}));if(theme.events&&playerBehaviour.xapi_includePlayerControlStatements){if(theme.events.themeTranscriptShown)$(theme).on(theme.events.themeTranscriptShown,function(){var a=xapiActivity.id+"/theme/transcript/";dataStorage&&dataStorage.currentPage&&dataStorage.currentPage.page.id&&(a+=dataStorage.currentPage.page.id);contentApi.sendAnalyticsStatement({verb:d,object:{id:a,definition:{type:"http://adlnet.gov/expapi/activities/interaction",name:{"en-US":"Theme Transcript"}}}})});if(theme.events.menuOpened)$(theme).on(theme.events.menuOpened,
function(){contentApi.sendAnalyticsStatement({verb:d,object:{id:xapiActivity.id+"/theme/menu",definition:{type:"http://adlnet.gov/expapi/activities/interaction",name:{"en-US":"Theme Menu"}}}})});if(theme.events.outlineOpened)$(theme).on(theme.events.outlineOpened,function(){contentApi.sendAnalyticsStatement({verb:d,object:{id:xapiActivity.id+"/theme/outline",definition:{type:"http://adlnet.gov/expapi/activities/interaction",name:{"en-US":"Theme Outline"}}}})})}playerBehaviour.xapi_includeResourceStatements&&
($(document).on(DKI.resourceBrowser.events.resourceOpened,function(a,b){a=xapiActivity.id+"/resource/"+b.id;b={type:"http://adlnet.gov/expapi/activities/interaction",name:{"en-US":b.title}};var c=DKI.clone(d);contentApi.sendAnalyticsStatement({verb:c,object:{id:a,definition:b}})}),$(document).on(DKI.resourceBrowser.events.resourceDownloaded,function(a,b){a=xapiActivity.id+"/resource/download/"+b.id;b={type:"http://adlnet.gov/expapi/activities/interaction",name:{"en-US":b.title}};var c=DKI.clone(d);
c.display["en-US"]="Downloaded";contentApi.sendAnalyticsStatement({verb:c,object:{id:a,definition:b}})}));playerBehaviour.xapi_includeGlossaryStatements&&($(player).on(DKI.glossary.events.definitionShown,function(a,b){contentApi.sendAnalyticsStatement({verb:d,object:{id:xapiActivity.id+"/glossary/definition/"+b.glossaryid,definition:{type:"http://adlnet.gov/expapi/activities/interaction",name:{"en-US":b.term}}}})}),$(player).on(DKI.glossary.events.popupShown,function(a,b){contentApi.sendAnalyticsStatement({verb:d,
object:{id:xapiActivity.id+"/glossary/popup/"+b.glossaryid,definition:{type:"http://adlnet.gov/expapi/activities/interaction",name:{"en-US":b.term}}}})}));playerBehaviour.xapi_includeCitationStatements&&($(document).on(DKI.Reference.playerReferenceUIInterface.events.referenceShown,function(a,b){contentApi.sendAnalyticsStatement({verb:d,object:{id:xapiActivity.id+"/citation/show/"+b.id,definition:{type:"http://adlnet.gov/expapi/activities/interaction",name:{"en-US":b.label}}}})}),$(document).on(DKI.Reference.playerReferenceUIInterface.events.referenceHovered,
function(a,b){contentApi.sendAnalyticsStatement({verb:d,object:{id:xapiActivity.id+"/citation/hover/"+b.id,definition:{type:"http://adlnet.gov/expapi/activities/interaction",name:{"en-US":b.label}}}})}),$(document).on(DKI.Reference.playerReferenceUIInterface.events.bibliographyShown,function(){contentApi.sendAnalyticsStatement({verb:d,object:{id:xapiActivity.id+"/bibliography",definition:{type:"http://adlnet.gov/expapi/activities/interaction",name:{"en-US":"Bibliography"}}}})}));if(playerBehaviour.xapi_includeDragDropStatements)$(document).on(DKI.ContentPage.events.elementDragStarted+
" "+DKI.ContentPage.events.elementDragDropped+" "+DKI.ContentPage.events.elementDropOut+" "+DKI.ContentPage.events.elementDropOver+" ",function(a){var b=dataStorage.getElement($(a.target).data("id")),c=b.title,d=b.description,g=settings.activityRootURL+"element/"+b.elementid;b.upload_id&&""!=b.upload_id&&(g=settings.activityRootURL+"asset/"+b.upload_id,c=b.asset_title,d=b.asset_description);a=r[a.type];var f={type:"http://adlnet.gov/expapi/activities/interaction"};""!=c&&(f.name={"en-US":c});""!=
d&&(f.description={"en-US":d});contentApi.sendAnalyticsStatement({verb:{id:"http://adlnet.gov/expapi/verbs/interacted",display:a},object:{id:g,definition:f,objectType:"Activity"},context:e(b)})});if(playerBehaviour.xapi_includeActionStatements)$(document).on(DKI.ContentPage.events.actionFired,function(a,b){if(b.action.elementId&&r[b.action.trigger]){a=dataStorage.getElement(b.action.elementId);var c=a.title,d=a.description,g=settings.activityRootURL+"element/"+a.elementid;a.upload_id&&""!=a.upload_id&&
(g=settings.activityRootURL+"asset/"+a.upload_id,c=a.asset_title,d=a.asset_description);b=r[b.action.trigger];var f={type:"http://adlnet.gov/expapi/activities/interaction"};""!=c&&(f.name={"en-US":c});""!=d&&(f.description={"en-US":d});contentApi.sendAnalyticsStatement({verb:{id:"http://adlnet.gov/expapi/verbs/interacted",display:b},object:{id:g,definition:f,objectType:"Activity"},context:e(a)})}});playerBehaviour.xapi_includeMediaStatements&&($(document).on(DKI.ContentPage.events.media.started,function(a,
b){a=dataStorage.getElement(b.elementId);if("videoembed"==a.elementtype)var c=settings.activityRootURL+"embed/"+a.id,d=a.title,g=a.description;else c=settings.activityRootURL+"asset/"+a.upload_id,d=a.asset_title,g=a.asset_description;var f={type:"http://adlnet.gov/expapi/activities/media"};""!=d&&(f.name={"en-US":d});""!=g&&(f.description={"en-US":g});"videoembed"==a.elementtype&&(f.extensions={"http://id.tincanapi.com/extension/irl":b.url});contentApi.sendAnalyticsStatement({verb:DKI.clone(m),object:{id:c,
definition:f,objectType:"Activity"},context:e(a)})}),$(document).on(DKI.ContentPage.events.media.paused,function(a,b){a=dataStorage.getElement(b.elementId);var c,d;if("videoembed"==a.elementtype){var g=settings.activityRootURL+"embed/"+a.id;c=a.title;d=a.description}else g=settings.activityRootURL+"asset/"+a.upload_id,c=a.asset_title,d=a.asset_description;var f={type:"http://adlnet.gov/expapi/activities/media"};""!=c&&(f.name={"en-US":c});""!=d&&(f.description={"en-US":d});"videoembed"==a.elementtype&&
(f.extensions={"http://id.tincanapi.com/extension/irl":b.url});contentApi.sendAnalyticsStatement({verb:DKI.clone(l),object:{id:g,definition:f,objectType:"Activity"},context:e(a)})}),$(document).on(DKI.ContentPage.events.media.played,function(a,b){a=dataStorage.getElement(b.elementId);var c,d;if("videoembed"==a.elementtype){var g=settings.activityRootURL+"embed/"+a.id;c=a.title;d=a.description}else g=settings.activityRootURL+"asset/"+a.upload_id,c=a.asset_title,d=a.asset_description;var f={type:"http://adlnet.gov/expapi/activities/media"};
""!=c&&(f.name={"en-US":c});""!=d&&(f.description={"en-US":d});"videoembed"==a.elementtype&&(f.extensions={"http://id.tincanapi.com/extension/irl":b.url});contentApi.sendAnalyticsStatement({verb:DKI.clone(h),object:{id:g,definition:f,objectType:"Activity"},context:e(a)})}),$(document).on(DKI.ContentPage.events.media.ended,function(a,b){a=dataStorage.getElement(b.elementId);var c,d;if("videoembed"==a.elementtype){var f=settings.activityRootURL+"embed/"+a.id;c=a.title;d=a.description}else f=settings.activityRootURL+
"asset/"+a.upload_id,c=a.asset_title,d=a.asset_description;var g={type:"http://adlnet.gov/expapi/activities/media"};""!=c&&(g.name={"en-US":c});""!=d&&(g.description={"en-US":d});"videoembed"==a.elementtype&&(g.extensions={"http://id.tincanapi.com/extension/irl":b.url});contentApi.sendAnalyticsStatement({verb:DKI.clone(n),object:{id:f,definition:g,objectType:"Activity"},context:e(a)})}));playerBehaviour.xapi_includeElementContentStatements&&($(document).on(DKI.ContentPage.events.captureElementInteracted,
function(b,c){b=c.el;var d=DKI.clone(a);switch(c.event){case "start":d=DKI.clone(m);d.display["en-US"]="Started";break;case "play":d=DKI.clone(h);d.display["en-US"]="Played";break;case "pause":d=DKI.clone(l);d.display["en-US"]="Paused";break;case "restart":d=DKI.clone(m);d.display["en-US"]="Restarted";break;case "stepChanged":d=DKI.clone(a);d.display["en-US"]="Step Changed";break;case "ended":d=DKI.clone(n),d.display["en-US"]="Ended"}if(d){c=b.title;var g=b.description,f=settings.activityRootURL+
"element/"+b.elementid,r={type:"http://adlnet.gov/expapi/activities/simulation"};""!=c&&(r.name={"en-US":c});""!=g&&(r.description={"en-US":g});contentApi.sendAnalyticsStatement({verb:d,object:{id:f,definition:r,objectType:"Activity"},extensions:{"http://dominknow.com/elementTypes":b.elementtype},context:e(b)})}}),$(document).on(DKI.ContentPage.events.elementContentChanged,function(b,c){b=c.element;var f=DKI.clone(a);switch(b.elementtype){case "tabset":f=DKI.clone(a);f.display["en-US"]="Tab clicked";
break;case "flipCard":f=DKI.clone(d);f.display["en-US"]="Side viewed";break;case "timeline":f=DKI.clone(d);f.display["en-US"]="Timeline node viewed";break;case "contentCarousel":f=DKI.clone(d);f.display["en-US"]="Content viewed";break;case "radioGroup":f=DKI.clone(g);f.display["en-US"]="Radio button selected";break;case "input":case "textbox":f=DKI.clone(a);f.display["en-US"]="Text typed";break;case "selection":f=DKI.clone(g);f.display["en-US"]="Menu item selected";break;case "slider":f=DKI.clone(a);
f.display["en-US"]="Slider handle slid";break;case "toggle":f=DKI.clone(a),f.display["en-US"]="Toggle changed"}if(f&&!c.setAutomatically){c=b.title;var h=b.description,l=settings.activityRootURL+"element/"+b.elementid,m={type:"http://adlnet.gov/expapi/activities/interaction"};""!=c&&(m.name={"en-US":c});""!=h&&(m.description={"en-US":h});contentApi.sendAnalyticsStatement({verb:f,object:{id:l,definition:m,objectType:"Activity"},extensions:{"http://dominknow.com/elementTypes":b.elementtype},context:e(b)})}}),
$(document).on(DKI.ContentPage.events.elementAllContentViewed,function(a,c){a=c.element;var d=DKI.clone(b);switch(a.elementtype){case "tabset":d=DKI.clone(b);d.display["en-US"]="All tabs seen";break;case "flipCard":d=DKI.clone(b);d.display["en-US"]="All sides seen";break;case "timeline":d=DKI.clone(b);d.display["en-US"]="All nodes viewed";break;case "contentCarousel":d=DKI.clone(b),d.display["en-US"]="All content viewed"}if(d&&!c.setAutomatically){c=a.title;var f=a.description,g=settings.activityRootURL+
"element/"+a.elementid,h={type:"http://adlnet.gov/expapi/activities/interaction"};""!=c&&(h.name={"en-US":c});""!=f&&(h.description={"en-US":f});contentApi.sendAnalyticsStatement({verb:d,object:{id:g,definition:h,objectType:"Activity"},extensions:{"http://dominknow.com/elementTypes":a.elementtype},context:e(a)})}}),$(document).on(DKI.ContentPage.events.markerTriggered,function(a,c){a=c.element;c=DKI.clone(b);var d=a.title,f=a.description,g=settings.activityRootURL+"element/"+a.elementid,h={type:"http://adlnet.gov/expapi/activities/interaction"};
c.display["en-US"]="Marker triggered";""!=d&&(h.name={"en-US":d});""!=f&&(h.description={"en-US":f});contentApi.sendAnalyticsStatement({verb:c,object:{id:g,definition:h,objectType:"Activity"},extensions:{"http://dominknow.com/elementTypes":a.elementtype},context:e(a)})}),$(document).on(DKI.ContentPage.events.inlineQuestionSubmitted,function(a,b){if("ATTEMPT"!=b.status){var c=b.element;a=xapiFunctions.buildGenericInteractionStatement({activityId:settings.activityRootURL+"element/"+c.elementid,extensions:{"http://dominknow.com/elementTypes":c.elementtype},
body:c.description,question:{title:c.title},context:e(c)});if(function(){if(2==c.elements.length&&1==c.parameters.config.maxSelections){var a=!1;$.each(c.elements,function(){a=this.meta.toLowerCase()===DKI.strings.runtime.trueOptionLabel.toLowerCase()||this.meta.toLowerCase()===DKI.strings.runtime.falseOptionLabel.toLowerCase()?!0:!1});return a}}())a.object.definition.correctResponsesPattern=["true"==b.result.correct[0].long.toString().toLowerCase()?"true":"false"],a.object.definition.interactionType=
"true-false",a.result={success:100==b.result.score,response:b.result.selected.length?"true"==b.result.selected[0].long.toString().toLowerCase()?"true":"false":"",score:{scaled:b.result.score/100}};else{var d=[],f=[],g=[];$.each(c.elements,function(){g.push({id:this.id.toString(),description:{"en-US":this.meta}});this.parameters.config.correct&&d.push(this.id)});$.each(b.result.selected,function(){f.push(c.elements[parseInt(this.short)-1].id)});a.object.definition.correctResponsesPattern=[d.join("[,]")];
a.object.definition.choices=g;a.object.definition.interactionType="choice";a.result={success:100==b.result.score,response:f.join("[,]"),score:{scaled:b.result.score/100}}}xapiFunctions.buildQuestionInteractionStatement(a).send()}}),$(document).on(DKI.ContentPage.events.flashCardSubmitted,function(a,b){a=b.outline;var c=xapiFunctions.buildGenericInteractionStatement({activityId:settings.activityRootURL+"element/"+a.elementid,extensions:{"http://dominknow.com/elementTypes":a.elementtype},body:a.description,
question:{title:a.title},context:e(a)});c.object.id=settings.activityRootURL+"element/"+a.elementid;c.object.definition.name["en-US"]=a.title;c.object.definition.description["en-US"]=a.description;c.object.definition.correctResponsesPattern=[b.correctResponse.join("[,]")];c.object.definition.interactionType="fill-in";c.result={success:1==b.score,response:b.response,score:{scaled:b.score}};c=xapiFunctions.buildQuestionInteractionStatement(c);c.getStatement().context.contextActivities.parent.unshift({id:settings.activityRootURL+
"element/"+a.parent_element_id});c.send()}));playerBehaviour.xapi_includeScenarioStatements&&($(document).on(DKI.ContentPage.events.scenarioOptionSelected,function(a,b){a=b.scene;var c=xapiFunctions.buildGenericInteractionStatement({activityId:settings.activityRootURL+"element/"+a.elementid,extensions:{"http://dominknow.com/elementTypes":a.elementtype},body:a.description,question:{title:a.title},context:e(a)});c.object.id=settings.activityRootURL+"element/"+a.elementid;c.object.definition.name["en-US"]=
a.title;c.object.definition.description["en-US"]=a.description;c.object.definition.interactionType="choice";c.result={response:b.selectedOption.meta};c=xapiFunctions.buildQuestionInteractionStatement(c);a.parent_element_id&&(c.getStatement().context.contextActivities.parent[0]={id:settings.activityRootURL+"element/"+b.scenario.id});c.send()}),$(document).on(DKI.ContentPage.events.scenarioEnded,function(a,b){a=b.scene;var c=DKI.clone(n);c.display["en-US"]="Ended";c={verb:c,object:{id:settings.activityRootURL+
"element/"+a.elementid,definition:{name:{"en-US":a.title},description:{"en-US":a.description}},objectType:"Activity"},context:e(a),result:{score:{scaled:a.parameters.config.weight}}};c.context.contextActivities.parent.unshift({id:settings.activityRootURL+"element/"+a.parent_element_id});c.context.extensions={"http://dominknow.com/elementTypes":a.elementtype,"http://dominknow.com/elementTypes/scenario/path":b.path};contentApi.sendAnalyticsStatement(c)}))},xapiFunctions=function(){var e=function(a,
b){b={verb:verbMap.answered,object:{id:a.activityId?a.activityId:settings.activityRootURL+"question/"+a.id,objectType:"Activity",definition:{name:{"en-US":a.question.title},description:{"en-US":a.body},type:"http://adlnet.gov/expapi/activities/cmi.interaction"}}};player.inAssessment&&(b.object.definition.extensions={"http://dominknow.com/testMode":dataStorage.assessment.prepost,"http://dominknow.com/attempt":dataStorage.assessment.module[dataStorage.assessment.prepost].attempts});if(a.context)b.context=
a.context;else{var d=dataStorage.findObject(a.question.objectid);""==a.question.objectid&&(d=dataStorage.getSubeoFromPage(a.question.page_id),d=dataStorage.findObject(d.objectid));var e=dataStorage.findModule(d.loid);b.context={contextActivities:{parent:[{id:settings.activityRootURL+"object/"+d.objectid,definition:{type:"http://adlnet.gov/expapi/activities/objective",name:{"en-US":d.title},description:{"en-US":d.description}}},{id:settings.activityRootURL+"module/"+d.loid,definition:{type:"http://adlnet.gov/expapi/activities/module",
name:{"en-US":e.name},description:{"en-US":e.description}}}]}}}a.latency&&(b.result={duration:scormTimeFn.ConvertMilliSecondsIntoSCORM2004Time(a.latency)});a.extensions&&(b.extensions=a.extensions);return b},a=function(a){return function(b){return{send:function(d){return b?d?contentApi.sendXAPIStatement(a):contentApi.sendAnalyticsStatement(a):!1},getStatement:function(){return a}}}(null!==a.object.id)};return{buildGenericInteractionStatement:e,recordTrueFalse:function(c){var b=e(c);b.object.definition.correctResponsesPattern=
[c.questionOptions[0].parameters.correct.toString()];b.object.definition.interactionType="true-false";b.result={success:100==c.score,response:1==c.options[0]?"true":"false",score:{scaled:c.score/100}};a(b).send()},recordMultipleChoice:function(c){for(var b=[],d=[],g=[],f=0;f<c.options.length;f++)g.push({id:c.questionOptions[f].element_id.toString(),description:{"en-US":c.options[f].text}}),1==c.options[f].checked&&b.push(c.questionOptions[f].element_id.toString()),c.questionOptions[f].parameters.correct&&
d.push(c.questionOptions[f].element_id.toString());f=e(c);f.object.definition.correctResponsesPattern=[d.join("[,]")];f.object.definition.choices=g;f.object.definition.interactionType="choice";f.result={success:100==c.score,response:b.join("[,]"),score:{scaled:c.score/100}};a(f).send()},recordFillBlanks:function(c){for(var b=0;b<c.options.length;b++){for(var d=0,g=dataStorage.getElement(c.questionOptions[b].element_id),f=0;f<c.questionOptions[b].parameters.correctValues.length;f++){var h=$.trim(c.options[b].toString().toLowerCase()),
l=$.trim(c.questionOptions[b].parameters.correctValues[f].toString().toLowerCase());$.isNumeric(h)&&(h=parseFloat(h),l=parseFloat(l.replace(/\,|\s/g,"")));if(l===h){d=1;break}}f=e(c);f.object.id=settings.activityRootURL+"element/"+c.questionOptions[b].element_id;f.object.definition.name["en-US"]=g.title;f.object.definition.description["en-US"]=g.description;f.object.definition.correctResponsesPattern=[c.questionOptions[b].parameters.correctValues.join("[,]")];f.object.definition.interactionType="fill-in";
f.result={success:1==d,response:c.options[b],score:{scaled:d}};f=a(f);f.getStatement().context.contextActivities.parent.unshift({id:settings.activityRootURL+"question/"+c.id});f.send()}},recordPulldown:function(c){for(var b=0;b<c.options.length;b++){var d=[],g=0,f=[],h=dataStorage.getElement(c.questionOptions[b].element_id),l="";f[0]=c.questionOptions[b].parameters.correctValue;for(var f=f.concat(c.questionOptions[b].parameters.incorrectValues),m=0;m<f.length;m++)d.push({id:(m+1).toString(),description:{"en-US":f[m].toString().trim()}}),
c.options[b].toString().toLowerCase().trim()==f[m].toString().toLowerCase().trim()&&(0==m&&(g=1),l=(m+1).toString());f=e(c);f.object.id=settings.activityRootURL+"element/"+c.questionOptions[b].element_id;f.object.definition.name["en-US"]=h.title;f.object.definition.description["en-US"]=h.description;f.object.definition.correctResponsesPattern=["1"];f.object.definition.choices=d;f.object.definition.interactionType="choice";f.result={success:1==g,response:l,score:{scaled:g}};f=a(f);f.getStatement().context.contextActivities.parent.unshift({id:settings.activityRootURL+
"question/"+c.id});f.send()}},recordFreeForm:function(c){var b=e(c);b.object.definition.interactionType="long-fill-in";b.result={success:100==c.score,response:c.options[0],score:{scaled:c.score/100}};a(b).send()},recordDragDrop:function(c){var b=[],d={},g=[],f=[],h=c.question.page||dataStorage.findPage(c.question.page_id);$.each(h.groups,function(){$.each(this.elements,function(){if(this.droppable){var a=dataStorage.getElementByDragDropId(this.dragdrop_id);d[this.dragdrop_id]={id:a.id.toString(),
description:{"en-US":a.title}}}})});for(h=0;h<c.options.length;h++){var l=dataStorage.getElement(c.questionOptions[h].element_id);b.push({id:c.questionOptions[h].element_id.toString(),description:{"en-US":l.title}});c.options[h].target.id&&(l=dataStorage.getElementByDragDropId(c.options[h].target.id),f.push(c.questionOptions[h].element_id+"[.]"+l.id))}$.each(d,function(){g.push(this)});h=e(c);h.object.definition.interactionType="matching";h.object.definition.source=b;h.object.definition.target=g;
h.result={success:100==c.score,response:f.join("[,]"),score:{scaled:c.score/100}};a(h).send()},buildQuestionInteractionStatement:a}}(),scormTimeFn=function(){var e=0,a=new Date,c=null;return{GetSessionAccumulatedTime:function(){c=new Date;null!=c&&null!=a&&(e+=c.getTime()-a.getTime());null!=a&&(a=new Date);c=null;return e},ConvertMilliSecondsIntoSCORM2004Time:function(a){var c="",e,f,h,l,m,n;a=Math.floor(a/10);n=Math.floor(a/315576E4);a-=315576E4*n;m=Math.floor(a/26298E4);a-=26298E4*m;l=Math.floor(a/
864E4);a-=864E4*l;h=Math.floor(a/36E4);a-=36E4*h;f=Math.floor(a/6E3);a-=6E3*f;e=Math.floor(a/100);a-=100*e;0<n&&(c+=n+"Y");0<m&&(c+=m+"M");0<l&&(c+=l+"D");0<a+e+f+h&&(c+="T",0<h&&(c+=h+"H"),0<f&&(c+=f+"M"),0<a+e&&(c+=e,0<a&&(c+="."+a),c+="S"));""==c&&(c="T0S");return"P"+c}}}();
xAPIFunctions={getActor:function(e){playerBehaviour.anonymizeAnalyticsUser||"N/A"==e?(e=Cookies.get("dki_xapiActor"),e||(e="actor_"+Math.random().toString(36).substring(6),Cookies.set("dki_xapiActor",e)),e={objectType:"Agent",account:{homePage:"http://www.dominknow.com",name:e}}):e=DKI.utility.isValidEmail(e)?{objectType:"Agent",mbox:e}:{objectType:"Agent",account:{homePage:window.location.protocol+"//"+document.domain,name:e}};return e}};